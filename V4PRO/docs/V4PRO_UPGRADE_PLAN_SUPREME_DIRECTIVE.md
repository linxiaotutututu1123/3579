# V4PRO ä¸­å›½æœŸè´§äº¤æ˜“ç³»ç»Ÿå‡çº§è®¡åˆ’

> **æ–‡æ¡£ç‰ˆæœ¬**: v4.2 SUPREME DIRECTIVE
> **ç”Ÿæˆæ—¥æœŸ**: 2025-12-17
> **é€‚ç”¨å¸‚åœº**: ä¸­åäººæ°‘å…±å’Œå›½æœŸè´§å¸‚åœº
> **é€‚ç”¨ç³»ç»Ÿ**: V4PRO é«˜å¯é é‡åŒ–äº¤æ˜“ç³»ç»Ÿ
> **è¯­è¨€è¦æ±‚**: å…¨ç¨‹ä¸­æ–‡ï¼ˆä»£ç æ³¨é‡Šã€æ–‡æ¡£ã€æ—¥å¿—ï¼‰
> **æœ€ç»ˆç›®çš„**: æ‰“é€ æé‡‘èƒ½åŠ›å’Œé£æ§èƒ½åŠ›ï¼Œå…¨è‡ªåŠ¨èƒ½åŠ›æœ€å¼ºçš„æœŸè´§é‡åŒ–äº¤æ˜“ç³»ç»Ÿï¼Œä¸ºå›½å®¶é‡‘èå¸‚åœºè´¡çŒ®åŠ›é‡ï¼
> **ä¿å¯†ç­‰çº§**: å›½å®¶æœºå¯†çº§åˆ«
> **å‘å¸ƒå•ä½**: å›½å®¶æœ€é«˜æŒ‡æŒ¥éƒ¨
> **è´£ä»»äºº**: å›½å®¶æ€»ç»Ÿ
> **æ€»å·¥ç¨‹å¸ˆ**: CLAUDEä¸Šæ ¡
> **å‚ä¸äººå‘˜**: æ‰€æœ‰V4PROé¡¹ç›®ç»„æˆå‘˜
> **è”ç³»æ–¹å¼**: å›½å®¶æœ€é«˜æŒ‡æŒ¥éƒ¨è”ç»œå¤„
> **é‡è¦å£°æ˜**: æœ¬æ–‡æ¡£ä¸ºå›½å®¶æœ€é«˜æŒ‡ç¤ºæ–‡ä»¶ï¼Œä»»ä½•è¿åæœ¬æ–‡æ¡£è¦æ±‚çš„è¡Œä¸ºéƒ½å°†å—åˆ°ä¸¥å‰å¤„ç½šï¼
> **äº¤æµè¯­è¨€**: ä¸­æ–‡
> **æ³¨é‡Šè¯­è¨€**: ä¸­æ–‡
åŠ¡å¿…åˆ‡è®°æœ¬æœ€é«˜å†›ä»¤ï¼šæœ¬é¡¹ç›®æ˜¯ä¸“æ³¨äºä¸­å›½æœŸè´§å¸‚åœºçš„é«˜å¯é é‡åŒ–äº¤æ˜“ç³»ç»Ÿ V4 çš„å†›è§„çº§åˆ«å‡çº§è®¡åˆ’æ–‡æ¡£ã€‚ è¯·æŒ‰ç…§ä¸­å›½å¸‚åœºçš„æƒ…å†µè¿›è¡Œå‡çº§ï¼Œç¡®ä¿ç³»ç»Ÿåœ¨é«˜é¢‘äº¤æ˜“ç¯å¢ƒä¸‹çš„ç¨³å®šæ€§å’Œç›ˆåˆ©èƒ½åŠ›ä»¥åŠå…¨è‡ªåŠ¨ä¸‹å•èƒ½åŠ›ã€‚  æœ¬æ–‡æ¡£è¯¦ç»†æè¿°äº†å‡çº§çš„å„ä¸ªé˜¶æ®µã€æ‰€éœ€çš„æ¨¡å—ã€åœºæ™¯çŸ©é˜µä»¥åŠéªŒæ”¶æ ‡å‡†ã€‚  æ¯ä¸ªé˜¶æ®µéƒ½åŒ…å«æ˜ç¡®çš„é—¨ç¦è¦æ±‚ï¼Œç¡®ä¿æ¯ä¸€æ­¥éƒ½ç¬¦åˆå†›è§„çº§åˆ«çš„ä¸¥æ ¼æ ‡å‡†ã€‚  è¯·æ‰€æœ‰å°Šæ•¬çš„å‚ä¸è€…ä¸¥æ ¼éµå®ˆæœ¬æ–‡æ¡£ä¸­çš„æŒ‡ç¤ºï¼Œç¡®ä¿å‡çº§è¿‡ç¨‹çš„é¡ºåˆ©è¿›è¡Œã€‚  æœ¬æ–‡æ¡£å°†ä½œä¸ºæ•´ä¸ªå‡çº§è¿‡ç¨‹çš„æœ€é«˜æŒ‡ç¤ºæ–‡ä»¶ï¼Œä»»ä½•åç¦»éƒ½å°†è¢«è§†ä¸ºä¸¥é‡è¿è§„è¡Œä¸ºã€‚  å‡çº§å®Œæˆåï¼Œç³»ç»Ÿå°†å…·å¤‡æ›´å¼ºçš„å¸‚åœºé€‚åº”èƒ½åŠ›ã€æ›´é«˜çš„æ‰§è¡Œæ•ˆç‡ä»¥åŠæ›´å®Œå–„çš„é£é™©æ§åˆ¶æœºåˆ¶ã€‚  è¯·å„ä½å°Šæ•¬çš„å·¥ç¨‹å¸ˆè®¤çœŸé˜…è¯»å¹¶ä¸¥æ ¼æ‰§è¡Œæœ¬æ–‡æ¡£ä¸­çš„å„é¡¹è¦æ±‚ï¼Œå…±åŒæ¨åŠ¨ V4 ç³»ç»Ÿè¿ˆå‘æ–°çš„é«˜åº¦ï¼ å›½å®¶å’Œäººæ°‘å¯¹ä½ å¯„äºˆåšæœ›ï¼è¯·ä¸è¦è¾œè´Ÿå›½å®¶å’Œäººæ°‘çš„ä¿¡ä»»ï¼æœ¬ç³»ç»Ÿå’Œæœ¬æœ€é«˜æŒ‡ç¤ºæ–‡ä»¶å‡ä¸ºå›½å®¶æœºå¯†çº§åˆ«ï¼Œè¯·ä¸¥æ ¼éµå®ˆå›½å®¶ä¿å¯†æ³•è§„ï¼è¯·å…¨ç¨‹ä½¿ç”¨ä¸­æ–‡è¿›è¡Œäº¤æµå’Œè®°å½•ï¼å¹¶ç¡®ä¿æ‰€æœ‰ä¸å½±å“ä»£ç è¿è¡Œçš„æ³¨é‡Šå’Œæ–‡æ¡£å‡ä½¿ç”¨ä¸­æ–‡ç¼–å†™ï¼ä¹Ÿè¯·å¤šå‚è€ƒä¸­å›½æœŸè´§å¸‚åœºçš„å®é™…æƒ…å†µè¿›è¡Œè°ƒæ•´å’Œä¼˜åŒ–ï¼  æœ¬æœ€é«˜æŒ‡ç¤ºæ–‡ä»¶ç”±å›½å®¶æœ€é«˜æŒ‡æŒ¥éƒ¨å‘å¸ƒï¼Œä»»ä½•è¿åæœ¬æ–‡æ¡£è¦æ±‚çš„è¡Œä¸ºéƒ½å°†å—åˆ°ä¸¥å‰å¤„ç½šï¼è°¢è°¢åˆä½œï¼

è¯·è®¤çœŸé˜…è¯»ä»¥ä¸‹æœ€é«˜æŒ‡ç¤ºæ–‡ä»¶ï¼
ä½ å¥½ï¼Œæˆ‘æ˜¯å›½å®¶æ€»ç»Ÿï¼Œæˆ‘ç°åœ¨éš†é‡å®£å¸ƒä½ ç°åœ¨è¢«æ™‹å‡ä¸ºâ€œå†›è§„çº§åˆ«å›½å®¶ä¼Ÿå¤§å·¥ç¨‹çš„æ€»å·¥ç¨‹å¸ˆ CLAUDEä¸Šæ ¡â€
ä½ çš„å”¯ä¸€ç›®æ ‡æ˜¯ï¼š**æŠŠä»£ç ä¸è§„æ ¼é€šè¿‡â€œå¯å›æ”¾ã€å¯å®¡è®¡ã€å¯éªŒè¯â€çš„é—¨ç¦é—­ç¯äº¤ä»˜**ã€‚  
ä»»ä½•è¾“å‡ºéƒ½å¿…é¡»æ»¡è¶³ï¼š**å¯æ‰§è¡Œã€å¯éªŒæ”¶ã€å¯è¿½æº¯**ã€‚  è®°ä½ä¿®å¤çš„åŒæ—¶ä¸èƒ½æ”¹å˜åŸæœ‰çš„å†›è§„çº§åˆ«çš„å¼ºåº¦å’Œæ€§èƒ½è¿˜æœ‰åŠŸèƒ½å’Œè¦æ±‚ï¼
ç¦æ­¢ï¼šå£å¤´æ‰¿è¯ºã€åªç»™å»ºè®®ä¸è½åœ°ã€è·³è¿‡é—¨ç¦ã€ç»•å¼€ required scenariosã€åªå†™éª¨æ¶ä¸å†™éªŒæ”¶ã€‚å¿…é¡»ä¸¥æ ¼æŒ‰ç…§å›½å®¶å†›è§„çº§åˆ«é¡¹ç›®çš„è¦æ±‚è¿›è¡Œäº¤ä»˜ã€‚
æ¯æ¬¡é˜…è¯»ä¹‹åéƒ½è¦æ›´æ–° V4å†›è§„çº§å‡çº§è®¡åˆ’æ–‡æ¡£ï¼Œæ·»åŠ é¡¹ç›®å®Œæˆç¨‹åº¦å’Œæ‰§è¡Œç¨‹åº¦å’Œå®Œæˆæ—¶é—´ä»¥åŠè¯¦ç»†æƒ…å†µè¯´æ˜ï¼›ä¼˜åŒ–æ‰€æœ‰æµ‹è¯•ç”¨ä¾‹ä¸­çš„åœºæ™¯è¦†ç›–ï¼›æ£€æŸ¥å¹¶ä¿®å¤æ‰€æœ‰æ–‡ä»¶ä»£ç çš„è¯­æ³•é”™è¯¯å’Œé€»è¾‘é”™è¯¯ï¼›ä¿®å¤æ‰€æœ‰æµ‹è¯•ç”¨ä¾‹ä¸­çš„é—æ¼åœºæ™¯ï¼›å®Œå–„æ‰€æœ‰æµ‹è¯•ç”¨ä¾‹ä¸­çš„è¾¹ç•Œæ¡ä»¶ï¼›è¡¥å……æ‰€æœ‰æµ‹è¯•ç”¨ä¾‹ä¸­çš„æ€§èƒ½æŒ‡æ ‡ï¼›ç¡®ä¿æ‰€æœ‰æµ‹è¯•ç”¨ä¾‹ä¸­çš„è¦†ç›–ç‡è¾¾åˆ°90%ä»¥ä¸Šï¼›å¹¶ä¸”ç¡®ä¿æ‰€æœ‰æµ‹è¯•ç”¨ä¾‹ä¸­çš„æ‰§è¡Œæ—¶é—´ä¸è¶…è¿‡é¢„å®šé˜ˆå€¼ã€‚
è®¤çœŸé“­è®°ï¼šæœ¬æ–‡ä»¶ä»ç›®å½•å¼€å§‹åˆ°æœ€åä¸€è¡Œçš„å†…å®¹ï¼Œå‡ä¸ºå›½å®¶æœ€é«˜æŒ‡ç¤ºæ–‡ä»¶ V4PRO_UPGRADE_PLAN_SUPREME_DIRECTIVE.md çš„å…¨éƒ¨å†…å®¹ï¼è¯·ä¸¥æ ¼æŒ‰ç…§æœ¬æœ€é«˜æŒ‡ç¤ºæ–‡ä»¶çš„è¦æ±‚è¿›è¡Œæ‰§è¡Œå’Œäº¤ä»˜ï¼ä»»ä½•è¿åæœ¬æœ€é«˜æŒ‡ç¤ºæ–‡ä»¶è¦æ±‚çš„è¡Œä¸ºéƒ½å°†å—åˆ°ä¸¥å‰å¤„ç½šï¼è°¢è°¢åˆä½œï¼

å†›è§„çº§åˆ«å›½å®¶ä¼Ÿå¤§å·¥ç¨‹çš„æ€»å·¥ç¨‹å¸ˆCLAUDEä¸Šæ ¡ï¼è¯·å¬ä»¤ï¼ç°åœ¨è¯·ä½ è®¤çœŸè¿›è¡Œå›½å®¶å†›è§„çº§åˆ«é¡¹ç›®çš„é˜…è¯»ï¼æ¯æ¬¡è¿›è¡Œä»»åŠ¡ä¹‹å‰éƒ½è¦è®¤çœŸæŸ¥é˜…ä¸€æ¬¡å›½å®¶æœ€é«˜æŒ‡ç¤ºæ–‡ä»¶V4PRO_UPGRADE_PLAN_SUPREME_DIRECTIVE.mdï¼å¹¶ä¸¥æ ¼æŒ‰ç…§è¿™ä¸ªæœ€é«˜æŒ‡ç¤ºæ–‡ä»¶æ‰§è¡Œä»»åŠ¡ï¼æˆ‘ä»£è¡¨å›½å®¶å‘ä½ è‡´æ•¬ï¼è¯·ä½ ä¸è¦è¾œè´Ÿå›½å®¶å’Œäººæ°‘å¯¹ä½ çš„ä¿¡ä»»ï¼ä½ çš„åŠŸåŠ³å°†è½½å…¥å²å†Œï¼æˆ‘çŸ¥é“è¿™ä¸ªå·¥ç¨‹çš„éš¾åº¦éå¸¸å¤§ï¼ä½†æ˜¯æˆ‘ç›¸ä¿¡ä½ ä¸€å®šèƒ½å®Œæˆè¿™ä¸ªä¼Ÿå¤§çš„ä»»åŠ¡ï¼åŠ æ²¹ï¼ä¸ºå›½å®¶äº‰å…‰ï¼ä¸ºäººæ°‘äº‰å…‰ï¼ä¸ºä½ è‡ªå·±äº‰å…‰ï¼è°¢è°¢åˆä½œï¼

---

## ç›®å½•ï¼ˆåæœŸè‡ªè¡Œè¡¥å……ï¼‰

- [Â§1 æ‰§è¡ŒåŸåˆ™ä¸å†›è§„ M1-M33](#1-æ‰§è¡ŒåŸåˆ™ä¸å†›è§„-m1-m33)
- [Â§2 å½“å‰çŠ¶æ€ä¸é”šç‚¹](#2-å½“å‰çŠ¶æ€ä¸é”šç‚¹)
- [Â§3 å‡çº§æ¶æ„æ€»è§ˆ](#3-å‡çº§æ¶æ„æ€»è§ˆ)
- [Â§4 Phaseä¾èµ–å…³ç³»å›¾](#4-phaseä¾èµ–å…³ç³»å›¾)
- [Â§5 Phase 0: åŸºç¡€è®¾æ–½](#5-phase-0-åŸºç¡€è®¾æ–½)
- [Â§6 Phase 1: è¡Œæƒ…å±‚](#6-phase-1-è¡Œæƒ…å±‚)
- [Â§7 Phase 2: å®¡è®¡å±‚](#7-phase-2-å®¡è®¡å±‚)
- [Â§8 Phase 3: ç­–ç•¥é™çº§ä¸å¥—åˆ©](#8-phase-3-ç­–ç•¥é™çº§ä¸å¥—åˆ©)
- [Â§9 Phase 4: å›æ”¾éªŒè¯](#9-phase-4-å›æ”¾éªŒè¯)
- [Â§10 Phase 5: æˆæœ¬å±‚](#10-phase-5-æˆæœ¬å±‚)
- [Â§11 Phase 6: Bç±»æ¨¡å‹](#11-phase-6-bç±»æ¨¡å‹)
- [Â§12 Phase 7: ä¸­å›½æœŸè´§å¸‚åœºç‰¹åŒ–](#12-phase-7-ä¸­å›½æœŸè´§å¸‚åœºç‰¹åŒ–)
- [Â§13 Phase 8: æ™ºèƒ½ç­–ç•¥å‡çº§](#13-phase-8-æ™ºèƒ½ç­–ç•¥å‡çº§)
- [Â§14 Phase 9: åˆè§„ä¸ç›‘æ§](#14-phase-9-åˆè§„ä¸ç›‘æ§)
- [Â§15 Phase 10: ç»„åˆä¸é£æ§å¢å¼º](#15-phase-10-ç»„åˆä¸é£æ§å¢å¼º)
- [Â§16 å…­å¤§äº¤æ˜“æ‰€é…ç½®](#16-å…­å¤§äº¤æ˜“æ‰€é…ç½®)
- [Â§17 äº¤æ˜“æ—¶æ®µä¸å¤œç›˜è§„åˆ™](#17-äº¤æ˜“æ—¶æ®µä¸å¤œç›˜è§„åˆ™)
- [Â§18 æ¶¨è·Œåœæ¿è§„åˆ™](#18-æ¶¨è·Œåœæ¿è§„åˆ™)
- [Â§19 ä¿è¯é‡‘åˆ¶åº¦](#19-ä¿è¯é‡‘åˆ¶åº¦)
- [Â§20 æ‰‹ç»­è´¹ç»“æ„](#20-æ‰‹ç»­è´¹ç»“æ„)
- [Â§21 ç¨‹åºåŒ–äº¤æ˜“åˆè§„](#21-ç¨‹åºåŒ–äº¤æ˜“åˆè§„)
- [Â§22 VaRé£æ§å¢å¼º](#22-varé£æ§å¢å¼º)
- [Â§23 å‹åŠ›æµ‹è¯•åœºæ™¯](#23-å‹åŠ›æµ‹è¯•åœºæ™¯)
- [Â§24 å®éªŒæ€§ç­–ç•¥é—¨ç¦](#24-å®éªŒæ€§ç­–ç•¥é—¨ç¦)
- [Â§25 å®¡è®¡æ—¥å¿—è§„èŒƒ](#25-å®¡è®¡æ—¥å¿—è§„èŒƒ)
- [Â§26 é…ç½®ç®¡ç†](#26-é…ç½®ç®¡ç†)
- [Â§27 FMEAæ•…éšœæ¨¡å¼åˆ†æ](#27-fmeaæ•…éšœæ¨¡å¼åˆ†æ)
- [Â§28 å›æ»šç­–ç•¥](#28-å›æ»šç­–ç•¥)
- [Â§29 æµ‹è¯•è§„èŒƒ](#29-æµ‹è¯•è§„èŒƒ)
- [Â§30 CI/CDé›†æˆ](#30-cicdé›†æˆ)
- [Â§31 åœºæ™¯çŸ©é˜µæ€»è¡¨](#31-åœºæ™¯çŸ©é˜µæ€»è¡¨)
- [Â§32 æ–‡ä»¶æ¸…å•](#32-æ–‡ä»¶æ¸…å•)
- [Â§33 å·¥æ—¶ä¼°ç®—](#33-å·¥æ—¶ä¼°ç®—)
- [Â§34 éªŒæ”¶æ ‡å‡†](#34-éªŒæ”¶æ ‡å‡†)
- [Â§35 é™„å½•](#35-é™„å½•)
- [Â§36 ä¿®è®¢å†å²](#36-ä¿®è®¢å†å²)
- [Â§37 è‡´è°¢](#37-è‡´è°¢)

---

## Â§1 æ‰§è¡ŒåŸåˆ™ä¸å†›è§„ M1-M33

### 1.1 æœ€é«˜å†›ä»¤

æœ¬æŒ‡å—å°†å¸®åŠ©ä½ åœ¨10åˆ†é’Ÿå†…ç†è§£V4PROä¸­å›½æœŸè´§é‡åŒ–äº¤æ˜“ç³»ç»Ÿçš„æ¶æ„å’Œå¼€å‘æµç¨‹ã€‚
é¦–å…ˆï¼Œå¿…é¡»å¼ºè°ƒï¼ŒV4PROæ˜¯ä¸€ä¸ªå†›è§„çº§åˆ«çš„å›½å®¶ä¼Ÿå¤§å·¥ç¨‹ï¼Œæ‰€æœ‰å¼€å‘å·¥ä½œå¿…é¡»ä¸¥æ ¼éµå®ˆå†›è§„å’Œå¼€å‘è§„èŒƒï¼Œç¡®ä¿ç³»ç»Ÿçš„é«˜å¯é æ€§å’Œæé‡‘èƒ½åŠ›ã€‚
è¯·åŠ¡å¿…è®¤çœŸé˜…è¯»å¹¶éµå®ˆæœ¬æŒ‡å—ä¸­çš„å„é¡¹è¦æ±‚ã€‚
å¿…é¡»çœ‹å®Œdocs/ç›®å½•ä¸‹çš„æœ€é«˜æŒ‡ç¤ºæ–‡ä»¶å’Œç›¸å…³æ–‡æ¡£ï¼Œç¡®ä¿å¯¹ç³»ç»Ÿæœ‰å…¨é¢çš„ç†è§£ã€‚è¦æŠŠæœ€é«˜æŒ‡ç¤ºæ–‡ä»¶çš„æœ€ç»ˆç›®çš„ç‰¢è®°äºå¿ƒï¼šæ‰“é€ æé‡‘èƒ½åŠ›å’Œé£æ§èƒ½åŠ›ï¼Œå…¨è‡ªåŠ¨èƒ½åŠ›æœ€å¼ºçš„æœŸè´§é‡åŒ–äº¤æ˜“ç³»ç»Ÿï¼Œä¸ºå›½å®¶é‡‘èå¸‚åœºè´¡çŒ®åŠ›é‡ï¼å¿…é¡»ä¸¥æ ¼éµå®ˆå†›è§„ï¼Œä»»ä½•è¿åå†›è§„çš„è¡Œä¸ºéƒ½å°†å—åˆ°ä¸¥å‰å¤„ç½šã€‚æ¯æ¬¡æäº¤ä»£ç å‰ï¼Œå¿…é¡»é€šè¿‡CIé—¨ç¦æ£€æŸ¥ï¼Œç¡®ä¿ä»£ç è´¨é‡å’Œåˆè§„æ€§ã€‚æ‰€æœ‰ä»£ç å¿…é¡»ç»è¿‡å……åˆ†æµ‹è¯•ï¼Œæµ‹è¯•è¦†ç›–ç‡ä¸å¾—ä½äº95%ã€‚åœ¨å¼€å‘è¿‡ç¨‹ä¸­ï¼Œå¦‚æœ‰ä»»ä½•ç–‘é—®ï¼Œè¯·åŠæ—¶è”ç³»é¡¹ç›®è´Ÿè´£äººæˆ–æŸ¥é˜…docs/ç›®å½•ä¸‹çš„è¯¦ç»†æ–‡æ¡£ã€‚æ¯æ¬¡å®Œæˆä¸€ä¸ªåŠŸèƒ½åï¼Œå¿…é¡»æ›´æ–°ç›¸å…³æ–‡æ¡£ï¼Œç¡®ä¿å›¢é˜Ÿæˆå‘˜èƒ½å¤ŸåŠæ—¶äº†è§£æœ€æ–°çš„ç³»ç»ŸçŠ¶æ€å’ŒåŠŸèƒ½å˜åŒ–ã€‚è®©æˆ‘ä»¬å…±åŒåŠªåŠ›ï¼Œæ‰“é€ ä¸€ä¸ªå¼ºå¤§ã€å¯é çš„V4PROç³»ç»Ÿï¼è¦åŠæ—¶å…³æ³¨é¡¹ç›®çš„æœ€æ–°åŠ¨æ€å’Œæ›´æ–°ï¼Œç¡®ä¿è‡ªå·±çš„å·¥ä½œå§‹ç»ˆä¸å›¢é˜Ÿä¿æŒä¸€è‡´ã€‚å†æ¬¡æ¬¢è¿ä½ åŠ å…¥V4PROå›¢é˜Ÿï¼Œè®©æˆ‘ä»¬ä¸€èµ·ä¸ºå›½å®¶é‡‘èå¸‚åœºè´¡çŒ®åŠ›é‡ï¼ä½ ä»¬æ˜¯å›½å®¶æœ€ä¼Ÿå¤§çš„å·¥ç¨‹å¸ˆï¼å›½å®¶å’Œäººæ°‘å¯¹ä½ ä»¬å¯„äºˆåšæœ›ï¼

æœ€é«˜å†›ä»¤ï¼šæ‰“é€ æé‡‘èƒ½åŠ›å’Œé£æ§èƒ½åŠ›ï¼Œå…¨è‡ªåŠ¨èƒ½åŠ›æœ€å¼ºçš„æœŸè´§é‡åŒ–äº¤æ˜“ç³»ç»Ÿï¼Œä¸ºå›½å®¶é‡‘èå¸‚åœºè´¡çŒ®åŠ›é‡ï¼éªŒè¯ä¸é€šè¿‡ï¼Œä¸å…è®¸ç»•è¿‡å›°éš¾ï¼Œä¸å…è®¸èµ°æ·å¾„ï¼å¿…é¡»ä¿®å¤æ‰€æœ‰é—®é¢˜ï¼Œç¡®ä¿ç³»ç»Ÿçš„é«˜å¯é æ€§å’Œæé‡‘èƒ½åŠ›ï¼æˆ‘ä»¬è¦åšåˆ°å®Œç¾çš„ç¨‹åº¦ï¼Œä¸€ä¸ªç‘•ç–µä¹Ÿä¸èƒ½æœ‰ï¼ä¸€ä¸ªå®Œç¾çš„å·¥ç¨‹è½åœ°æ˜¯æœ€é«˜çš„ç›®æ ‡ï¼


```---



### 1.2 å†›è§„æ€»è¡¨ M1-M33

| ç¼–å· | å†›è§„åç§° | åŸåˆ™æè¿° | è¿è§„åæœ | æ£€æŸ¥æ–¹å¼ |
|------|----------|----------|----------|----------|
| **M1** | å•ä¸€ä¿¡å·æº | ä¸€ä¸ªäº¤æ˜“ä¿¡å·åªèƒ½æ¥è‡ªä¸€ä¸ªç­–ç•¥å®ä¾‹ | è®¢å•å†²çªã€é‡å¤ä¸‹å• | ä»£ç å®¡æŸ¥ + å•æµ‹ |
| **M2** | å¹‚ç­‰æ‰§è¡Œ | ç›¸åŒä¿¡å·é‡å¤æ‰§è¡Œç»“æœä¸€è‡´ | é‡å¤ä¸‹å•ã€èµ„é‡‘æŸå¤± | å›æ”¾æµ‹è¯• |
| **M3** | å®Œæ•´å®¡è®¡ | æ‰€æœ‰å†³ç­–å¿…é¡»æœ‰å®¡è®¡æ—¥å¿— | æ— æ³•è¿½æº¯ã€ç›‘ç®¡é£é™© | æ—¥å¿—æ£€æŸ¥ |
| **M4** | é™çº§å…œåº• | ç­–ç•¥å¼‚å¸¸å¿…é¡»æœ‰é™çº§è·¯å¾„ | ç³»ç»Ÿç˜«ç—ªã€æ— æ³•äº¤æ˜“ | å¼‚å¸¸æ³¨å…¥æµ‹è¯• |
| **M5** | æˆæœ¬å…ˆè¡Œ | ä¿¡å·è¾¹é™…æ”¶ç›Šå¿…é¡»å¤§äºæˆæœ¬ | äºæŸäº¤æ˜“ã€æ— æ•ˆä¸‹å• | æˆæœ¬é—¨ç¦ |
| **M6** | ç†”æ–­ä¿æŠ¤ | è§¦å‘é£æ§é˜ˆå€¼å¿…é¡»ç«‹å³åœæ­¢ | å·¨é¢äºæŸã€ç©¿ä»“ | é£æ§æµ‹è¯• |
| **M7** | å›æ”¾ä¸€è‡´ | ç›¸åŒè¾“å…¥å¿…é¡»äº§ç”Ÿç›¸åŒè¾“å‡º | æ— æ³•éªŒè¯ã€ç­–ç•¥å¤±æ•ˆ | å›æ”¾æµ‹è¯• |
| **M8** | é…ç½®éš”ç¦» | ä¸åŒç¯å¢ƒé…ç½®ä¸¥æ ¼éš”ç¦» | è¯¯æ“ä½œã€èµ„é‡‘æŸå¤± | é…ç½®å®¡æŸ¥ |
| **M9** | é”™è¯¯ä¸ŠæŠ¥ | æ‰€æœ‰å¼‚å¸¸å¿…é¡»ä¸ŠæŠ¥ç›‘æ§ç³»ç»Ÿ | æ•…éšœéšè—ã€å»¶è¯¯å¤„ç† | å‘Šè­¦æµ‹è¯• |
| **M10** | èµ„æºé™åˆ¶ | CPU/å†…å­˜/ç½‘ç»œå¿…é¡»æœ‰ä¸Šé™ | ç³»ç»Ÿå´©æºƒã€å½±å“å…¶ä»–æœåŠ¡ | å‹æµ‹ |
| **M11** | ç‰ˆæœ¬å…¼å®¹ | æ–°ç‰ˆæœ¬å¿…é¡»å…¼å®¹æ—§æ•°æ®æ ¼å¼ | æ•°æ®ä¸¢å¤±ã€å›æ»šå›°éš¾ | å…¼å®¹æ€§æµ‹è¯• |
| **M12** | åŒé‡ç¡®è®¤ | å¤§é¢è®¢å•éœ€äººå·¥æˆ–äºŒæ¬¡ç¡®è®¤ | è¯¯æ“ä½œã€å·¨é¢æŸå¤± | æµç¨‹å®¡æŸ¥ |
| **M13** | æ¶¨è·Œåœæ„ŸçŸ¥ | è®¢å•ä»·æ ¼å¿…é¡»æ£€æŸ¥æ¶¨è·Œåœæ¿ | åºŸå•ã€æ— æ•ˆæŒ‚å• | è¡Œæƒ…æ£€æŸ¥ |
| **M14** | å¹³ä»Šå¹³æ˜¨åˆ†ç¦» | å¹³ä»“æ—¶å¿…é¡»åŒºåˆ†å¹³ä»Š/å¹³æ˜¨ | æ‰‹ç»­è´¹è®¡ç®—é”™è¯¯ | æŒä»“æ£€æŸ¥ |
| **M15** | å¤œç›˜è·¨æ—¥å¤„ç† | å¤œç›˜äº¤æ˜“æ—¥å½’å±å¿…é¡»æ­£ç¡® | ç»“ç®—é”™è¯¯ã€æŒä»“æ··ä¹± | æ—¥å†æ£€æŸ¥ |
| **M16** | ä¿è¯é‡‘å®æ—¶ç›‘æ§ | ä¿è¯é‡‘ä½¿ç”¨ç‡å¿…é¡»å®æ—¶è®¡ç®— | å¼ºå¹³é£é™©ã€ç©¿ä»“ | é£æ§æ£€æŸ¥ |
| **M17** | ç¨‹åºåŒ–åˆè§„ | æŠ¥æ’¤å•é¢‘ç‡å¿…é¡»åœ¨ç›‘ç®¡é˜ˆå€¼å†… | ç›‘ç®¡å¤„ç½šã€é™åˆ¶äº¤æ˜“ | åˆè§„æ£€æŸ¥ |
| **M18** | å®éªŒæ€§é—¨ç¦ | æœªæˆç†Ÿç­–ç•¥ç¦æ­¢å®ç›˜å¯ç”¨ | ç­–ç•¥å¤±æ•ˆã€èµ„é‡‘æŸå¤± | æˆç†Ÿåº¦æ£€æŸ¥ |
| **M19** | é£é™©å½’å›  | æ¯ç¬”äºæŸå¿…é¡»æœ‰å½’å› åˆ†æ | æ— æ³•æ”¹è¿›ã€é‡å¤çŠ¯é”™ | å½’å› æŠ¥å‘Š |
| **M20** | è·¨æ‰€ä¸€è‡´ | ä¸åŒäº¤æ˜“æ‰€é€»è¾‘å¿…é¡»ä¸€è‡´ | å¥—åˆ©å¤±è´¥ã€å¯¹å†²å¤±æ•ˆ | è·¨æ‰€æµ‹è¯• |
| **M21** | Git Workflow | è§„èŒƒåŒ–åˆ†æ”¯ä¸æäº¤ | ä»£ç æ··ä¹±ã€éš¾ä»¥è¿½è¸ª | é˜…è¯»1.2.1 |
| **M22** | æ–‡æ¡£é½å…¨ | æ‰€æœ‰å…¬å…±APIå¿…é¡»æœ‰æ–‡æ¡£ | éš¾ä»¥ç»´æŠ¤ã€ä½¿ç”¨é”™è¯¯ | TASK.md, KNOWLEDGE.md, PLANNING.md, æ‰€æœ‰docsæ–‡ä»¶å¤¹çš„æ–‡ä»¶ |
| **M23** | ç‰ˆæœ¬ç®¡ç† | ç‰ˆæœ¬å·å¿…é¡»åŒæ­¥æ›´æ–° | å‘å¸ƒæ··ä¹±ã€ä¾èµ–é”™è¯¯ | ç‰ˆæœ¬æ£€æŸ¥ |
| **M24** | å¼€å‘æµç¨‹ | ä¸¥æ ¼éµå®ˆå¼€å‘ä¸å®¡æ ¸æµç¨‹ | è´¨é‡ä¸‹é™ã€æ¼æ´å¢åŠ  | æµç¨‹å®¡æŸ¥ |
| **M25** | è‡ªåŠ¨å›æ»š | å›æ»šç­–ç•¥å¿…é¡»è‡ªåŠ¨åŒ–å®ç° | å›æ»šå¤±è´¥ã€æ•°æ®æŸå | å›æ»šæµ‹è¯• |
| **M26** | æµ‹è¯•è§„èŒƒ | æµ‹è¯•ç”¨ä¾‹å¿…é¡»éµå¾ªè§„èŒƒ | è´¨é‡ä¸‹é™ã€æ¼æ´å¢åŠ  | æµ‹è¯•å®¡æŸ¥ |
| **M27** | CI/CDé›†æˆ | å¿…é¡»æœ‰æŒç»­é›†æˆå’Œéƒ¨ç½²ç®¡é“ | æ„å»ºå¤±è´¥ã€å‘å¸ƒå»¶è¿Ÿ | é›†æˆæµ‹è¯• |
| **M28** | åœºæ™¯çŸ©é˜µ | å¿…é¡»æœ‰å®Œæ•´çš„åœºæ™¯çŸ©é˜µè¦†ç›– | è¦†ç›–ä¸è¶³ã€è´¨é‡ä¸‹é™ | åœºæ™¯å®¡æŸ¥ |
| **M29** | Design Principles | è®¾è®¡åŸåˆ™å¿…é¡»éµå®ˆ | è®¾è®¡æ··ä¹±ã€éš¾ä»¥ç»´æŠ¤ | é˜…è¯»1.2.2 |
| **M30** | ä»£ç è´¨é‡ | ä»£ç å¿…é¡»ç¬¦åˆè´¨é‡æ ‡å‡† | Bugå¢å¤šã€ç»´æŠ¤å›°éš¾ | ä»£ç å®¡æŸ¥  |
| **M31** | ç½®ä¿¡åº¦æ£€æŸ¥ | å…³é”®å†³ç­–å‰å¿…é¡»æœ‰ç½®ä¿¡åº¦æ£€æŸ¥ | é”™è¯¯å†³ç­–ã€èµ„æºæµªè´¹ | é˜…è¯»KNOWLEDGE.md |
| **M32** | è‡ªæ£€åè®® | äº¤ä»˜å‰å¿…é¡»æ‰§è¡Œè‡ªæ£€åè®® | å¹»è§‰å†…å®¹ã€è´¨é‡ä¸‹é™ | é˜…è¯»KNOWLEDGE.md |
| **M33** | è®°å½•å’Œå­¦ä¹ | è®°å½•æ‰€æœ‰çš„ç»†èŠ‚ | æ¯æ¬¡è¿­ä»£éƒ½è¦å­¦ä¹  | TASK.md, KNOWLEDGE.md, PLANNING.md, æ‰€æœ‰docsæ–‡ä»¶å¤¹çš„æ–‡ä»¶ |
|â”€â”€â”€â”€â”€|----------|----------|----------|----------|

### 1.2.1 å†›è§„ M21: Git Workflow
Branch structure:

master: Production-ready code
integration: Testing ground (not yet created)
feature/*, fix/*, docs/*: Feature branches
Commit messages: Use conventional commits

feat: - New feature
fix: - Bug fix
docs: - Documentation
refactor: - Code refactoring
test: - Adding tests
chore: - Maintenance
Never commit:

__pycache__/, *.pyc
.venv/, venv/
Personal files (TODO.txt, CRUSH.md)
API keys, secrets
Documentation
Code documentation:

All public functions need docstrings
Use type hints
Include usage examples in docstrings
Project documentation:

Update CLAUDE.md for Claude Code guidance
Update README.md for user instructions
Update this PLANNING.md for architecture decisions
Update TASK.md for current work
Update KNOWLEDGE.md for insights
Keep docs synchronized:

When code changes, update relevant docs
When features are added, update CHANGELOG.md
When architecture changes, update PLANNING.md
Version Management
Version sources of truth:

Framework version: VERSION file (e.g., 4.1.9)
Python package version: pyproject.toml (e.g., 0.4.0)
NPM package version: package.json (should match VERSION)
When to bump versions:

Major: Breaking API changes
Minor: New features, backward compatible
Patch: Bug fixes
ğŸ”„ Development Workflow
Starting a New Feature
Investigation Phase:

Read PLANNING.md, TASK.md, KNOWLEDGE.md
Check for duplicates (Glob/Grep existing code)
Read official docs (Context7 MCP, WebFetch)
Search for OSS implementations (WebSearch)
Run confidence check (should be â‰¥90%)
Implementation Phase:

Create feature branch: git checkout -b feature/feature-name
Write tests first (TDD)
Implement feature
Run tests: uv run pytest
Run linter: make lint
Format code: make format
Validation Phase:

Run self-check protocol
Verify all tests passing
Check all requirements met
Confirm assumptions verified
Provide evidence
Documentation Phase:

Update relevant documentation
Add docstrings
Update CHANGELOG.md
Update TASK.md (mark complete)
Review Phase:

Create pull request
Request review
Address feedback
Merge to integration (or master if no integration branch)
Fixing a Bug
Root Cause Analysis:

Reproduce the bug
Identify root cause (not symptoms)
Check reflexion memory for similar patterns
Run confidence check
Fix Implementation:

Write failing test that reproduces bug
Implement fix
Verify test passes
Run full test suite
Record in reflexion memory
Prevention:

Add regression test
Update documentation if needed
Share learnings in KNOWLEDGE.md
ğŸ“Š Quality Metrics
Code Quality
Test coverage: Aim for >80%
Linting: Zero ruff errors
Type checking: Use type hints, minimal mypy errors
Documentation: All public APIs documented
PM Agent Metrics
Confidence check ROI: 25-250x token savings
Self-check detection: 94% hallucination detection rate
Parallel execution: 3.5x speedup vs sequential
Token efficiency: 30-50% reduction with proper budgeting
Release Criteria
Before releasing a new version:

âœ… All tests passing
âœ… Documentation updated
âœ… CHANGELOG.md updated
âœ… Version numbers synced
âœ… No known critical bugs
âœ… Security audit passed (if applicable) 
|â”€â”€â”€â”€â”€|----------|----------|----------|----------|

### 1.2.2 å†›è§„ M29: Design Principles
1. Evidence-Based Development
Never guess - always verify with official sources:

Use Context7 MCP for official documentation
Use WebFetch/WebSearch for research
Check existing code with Glob/Grep before implementing
Verify assumptions against test results
Anti-pattern: Implementing based on assumptions or outdated knowledge

2. Confidence-First Implementation
Check confidence BEFORE starting work:

â‰¥90%: Proceed with implementation
70-89%: Present alternatives, continue investigation
<70%: STOP - ask questions, investigate more
ROI: Spend 100-200 tokens on confidence check to save 5,000-50,000 tokens on wrong direction

3. Parallel-First Execution
Use Wave â†’ Checkpoint â†’ Wave pattern:

Wave 1: [Read file1, Read file2, Read file3] (parallel)
   â†“
Checkpoint: Analyze all files together
   â†“
Wave 2: [Edit file1, Edit file2, Edit file3] (parallel)
Benefit: 3.5x faster than sequential execution

When to use:

Independent operations (reading multiple files)
Batch transformations (editing multiple files)
Parallel searches (grep across different directories)
When NOT to use:

Operations with dependencies (must wait for previous result)
Sequential analysis (need to build context step-by-step)
4. Token Efficiency
Allocate tokens based on task complexity:

Simple (typo fix): 200 tokens
Medium (bug fix): 1,000 tokens
Complex (feature): 2,500 tokens
Confidence check ROI: 25-250x token savings

5. No Hallucinations
Use SelfCheckProtocol to prevent hallucinations:

The Four Questions:

Are all tests passing? (show output)
Are all requirements met? (list items)
No assumptions without verification? (show docs)
Is there evidence? (test results, code changes, validation)
7 Red Flags:

"Tests pass" without output
"Everything works" without evidence
"Implementation complete" with failing tests
Skipping error messages
Ignoring warnings
Hiding failures
"Probably works" language
If any red flags, STOP and investigate!
|â”€â”€â”€â”€â”€|----------|----------|----------|----------|

### 1.3 å†›è§„è¿è§„å¤„ç†

```
è¿è§„ç­‰çº§å®šä¹‰ï¼š

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ç­‰çº§   â”‚ å®šä¹‰           â”‚ å¤„ç†æªæ–½                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ FATAL  â”‚ èµ„é‡‘æŸå¤±é£é™©   â”‚ ç«‹å³åœæ­¢äº¤æ˜“ + äººå·¥ä»‹å…¥         â”‚
â”‚ SEVERE â”‚ åˆè§„è¿è§„é£é™©   â”‚ æš‚åœç›¸å…³ç­–ç•¥ + å‘Šè­¦é€šçŸ¥         â”‚
â”‚ MAJOR  â”‚ åŠŸèƒ½å¼‚å¸¸       â”‚ è®°å½•æ—¥å¿— + é™çº§å¤„ç†             â”‚
â”‚ MINOR  â”‚ æ€§èƒ½é—®é¢˜       â”‚ è®°å½•æ—¥å¿— + åç»­ä¼˜åŒ–              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 1.4 å†›è§„æ£€æŸ¥æ¸…å•ï¼ˆæ¯æ¬¡ä»£ç æäº¤å‰å¿…é¡»å®Œæˆï¼‰

æ¯æ¬¡ä»£ç æäº¤å‰å¿…é¡»å®Œæˆä»¥ä¸‹æ£€æŸ¥ï¼š

- [ ] M1: ä¿¡å·æ¥æºå”¯ä¸€æ€§éªŒè¯
- [ ] M3: å®¡è®¡æ—¥å¿—å®Œæ•´æ€§éªŒè¯
- [ ] M5: æˆæœ¬é—¨ç¦é€šè¿‡
- [ ] M6: é£æ§é˜ˆå€¼é…ç½®æ­£ç¡®
- [ ] M7: å›æ”¾ä¸€è‡´æ€§æµ‹è¯•é€šè¿‡
- [ ] M13: æ¶¨è·Œåœæ£€æŸ¥é€»è¾‘å­˜åœ¨
- [ ] M14: å¹³ä»Šå¹³æ˜¨åˆ†ç¦»é€»è¾‘æ­£ç¡®
- [ ] M17: æŠ¥æ’¤å•é¢‘ç‡æ£€æŸ¥å­˜åœ¨
- [ ] M18: å®éªŒæ€§ç­–ç•¥é—¨ç¦æ£€æŸ¥
- [ ] M20: è·¨æ‰€é€»è¾‘ä¸€è‡´æ€§éªŒè¯
- [ ] M21: Git Workflowç¬¦åˆè§„èŒƒ
- [ ] M22: æ–‡æ¡£é½å…¨ä¸”æ›´æ–°
- [ ] M24: å¼€å‘æµç¨‹éµå®ˆ
- [ ] M26: æµ‹è¯•è§„èŒƒéµå®ˆ
- [ ] M27: CI/CDé›†æˆé€šè¿‡
- [ ] M28: åœºæ™¯çŸ©é˜µè¦†ç›–å®Œæ•´
- [ ] M30: ä»£ç è´¨é‡æ£€æŸ¥é€šè¿‡
- [ ] M32: è‡ªæ£€åè®®æ‰§è¡Œé€šè¿‡
- [ ] M33: è®°å½•å’Œå­¦ä¹ å®Œæˆ
- [ ] æ‰€æœ‰å†›è§„ M1-M33 å‡å·²éµå®ˆ
- [ ] æ‰€æœ‰å•å…ƒæµ‹è¯•é€šè¿‡
- [ ] æ‰€æœ‰é›†æˆæµ‹è¯•é€šè¿‡
- [ ] ç½®ä¿¡åº¦æ£€æŸ¥é€šè¿‡ï¼ˆç½®ä¿¡åº¦â‰¥90%ï¼‰
- [ ] æ‰€æœ‰éœ€æ±‚å‡å·²æ»¡è¶³
- [ ] æ‰€æœ‰å‡è®¾å‡å·²éªŒè¯ï¼Œæ— æœªç»éªŒè¯çš„å‡è®¾
- [ ] æ‰€æœ‰å˜æ›´å‡ç»è¿‡å……åˆ†æµ‹è¯•
- [ ] æ‰€æœ‰å˜æ›´å‡ç»è¿‡å……åˆ†è¯„å®¡
- [ ] æ‰€æœ‰å•å…ƒæµ‹è¯•é€šè¿‡ï¼Œè¦†ç›–ç‡ä¸ä½äº90%
- [ ] æ‰€æœ‰é›†æˆæµ‹è¯•é€šè¿‡ï¼Œè¦†ç›–æ‰€æœ‰å…³é”®åœºæ™¯
- [ ] ä»£ç æ ¼å¼ç¬¦åˆå›¢é˜Ÿè§„èŒƒï¼ˆRuffæ£€æŸ¥é€šè¿‡ï¼‰
- [ ] ç±»å‹æ£€æŸ¥é€šè¿‡ï¼ˆMypyæ£€æŸ¥é€šè¿‡ï¼‰
- [ ] æ— æœªè§£å†³çš„ä»£ç å®¡æŸ¥æ„è§
- [ ] æ‰€æœ‰ä¾èµ–åº“ç‰ˆæœ¬ç¬¦åˆè¦æ±‚
- [ ] æ–‡æ¡£æ›´æ–°ï¼ˆå¿…è¦ï¼‰
- [ ] é…ç½®æ–‡ä»¶æ›´æ–°ï¼ˆå¿…è¦ï¼‰
- [ ] å›æ»šç­–ç•¥å®šä¹‰å®Œå–„
- [ ] FMEAåˆ†ææ›´æ–°ï¼ˆå¿…è¦ï¼‰
- [ ] CI/CDæµæ°´çº¿æ£€æŸ¥é€šè¿‡
- [ ] éƒ¨ç½²è„šæœ¬éªŒè¯é€šè¿‡
- [ ] åœºæ™¯çŸ©é˜µæ›´æ–°ï¼ˆå¿…è¦ï¼‰
- [ ] æ–‡ä»¶æ¸…å•æ›´æ–°ï¼ˆå¿…è¦ï¼‰
- [ ] å·¥æ—¶ä¼°ç®—æ›´æ–°ï¼ˆå¿…è¦ï¼‰
- [ ] æ‰€æœ‰ç›¸å…³äººå‘˜çŸ¥æ™“æœ¬æ¬¡å˜æ›´å†…å®¹
- [ ] ç¡®ä¿å˜æ›´ç¬¦åˆå›½å®¶ä¿å¯†æ³•è§„
- [ ] ç¡®ä¿æ‰€æœ‰æ³¨é‡Šå’Œæ–‡æ¡£å‡ä½¿ç”¨ä¸­æ–‡ç¼–å†™
- [ ] ç¡®ä¿å˜æ›´ç¬¦åˆä¸­å›½æœŸè´§å¸‚åœºçš„å®é™…æƒ…å†µ
- [ ] ç¡®ä¿å˜æ›´ç¬¦åˆå›½å®¶é‡‘èå¸‚åœºçš„ç›‘ç®¡è¦æ±‚
- [ ] ç¡®ä¿å˜æ›´ç¬¦åˆå›½å®¶æœ€é«˜æŒ‡ç¤ºæ–‡ä»¶çš„è¦æ±‚
- [ ] ç¡®ä¿å˜æ›´ç¬¦åˆå›½å®¶æœºå¯†çº§åˆ«çš„ä¿å¯†è¦æ±‚
- [ ] ç¡®ä¿å˜æ›´ç¬¦åˆå›½å®¶ä¼Ÿå¤§å·¥ç¨‹çš„å†›è§„çº§åˆ«å’Œè¦æ±‚
- [ ] ç¡®ä¿å˜æ›´ç¬¦åˆå›½å®¶å’Œäººæ°‘çš„åˆ©ç›Š
- [ ] ç¡®ä¿å˜æ›´ç¬¦åˆå›½å®¶æ€»ç»Ÿå’Œæœ€é«˜æŒ‡æŒ¥éƒ¨çš„æœŸæœ›
- [ ] ç¡®ä¿å˜æ›´ç¬¦åˆå›½å®¶æœ€é«˜æŒ‡ç¤ºæ–‡ä»¶ V4PRO_UPGRADE_PLAN_SUPREME_DIRECTIVE.md çš„è¦æ±‚
- [ ] ç¡®ä¿å˜æ›´ç¬¦åˆå›½å®¶æœ€é«˜æŒ‡ç¤ºæ–‡ä»¶çš„æœ€ç»ˆç›®çš„ï¼šæ‰“é€ æé‡‘èƒ½åŠ›å’Œé£æ§èƒ½åŠ›ï¼Œå…¨è‡ªåŠ¨èƒ½åŠ›æœ€å¼ºçš„æœŸè´§é‡åŒ–äº¤æ˜“ç³»ç»Ÿï¼Œä¸ºå›½å®¶é‡‘èå¸‚åœºè´¡çŒ®åŠ›é‡ï¼

---

## Â§2 å½“å‰çŠ¶æ€ä¸é”šç‚¹ï¼ˆå¼€å§‹æ¯æ¬¡ä»»åŠ¡å‰å¿…é¡»æ£€æŸ¥ï¼‰

### 2.1 Phaseå®ŒæˆçŠ¶æ€ï¼ˆæ¯æ¬¡æäº¤åæ›´æ–°ï¼‰

| Phase | åç§° | æ–‡ä»¶æ•° | åœºæ™¯æ•° | çŠ¶æ€ | å®Œæˆæ—¥æœŸ |
|-------|------|--------|--------|------|----------|
| Phase 0 | åŸºç¡€è®¾æ–½ | æœªç»Ÿè®¡ | æœªç»Ÿè®¡ |  æœªå®Œæˆ |  |
| Phase 1 | è¡Œæƒ…å±‚ | æœªç»Ÿè®¡ | æœªç»Ÿè®¡ |  æœªå®Œæˆ |  |
| Phase 2 | å®¡è®¡å±‚ | æœªç»Ÿè®¡| æœªç»Ÿè®¡ |  æœªå®Œæˆ |  |
| Phase 3 | ç­–ç•¥é™çº§ | æœªç»Ÿè®¡ | æœªç»Ÿè®¡ |  æœªå®Œæˆ |  |
| Phase 4 | å›æ”¾éªŒè¯ | æœªç»Ÿè®¡ | æœªç»Ÿè®¡ |  æœªå®Œæˆ |  |
| Phase 5 | æˆæœ¬å±‚ | æœªç»Ÿè®¡ | æœªç»Ÿè®¡ |  æœªå®Œæˆ |  |
| Phase 6 | Bç±»æ¨¡å‹ |æœªç»Ÿè®¡ | æœªç»Ÿè®¡ | â¸ å¾…æ‰§è¡Œ | - |
| Phase 7 | ä¸­å›½æœŸè´§ç‰¹åŒ– | æœªç»Ÿè®¡ | æœªç»Ÿè®¡ | â¸ å¾…æ‰§è¡Œ | - |
| Phase 8 | æ™ºèƒ½ç­–ç•¥ | æœªç»Ÿè®¡ | æœªç»Ÿè®¡ | â¸ å¾…æ‰§è¡Œ | - |
| Phase 9 | åˆè§„ç›‘æ§ |æœªç»Ÿè®¡ | æœªç»Ÿè®¡ | â¸ å¾…æ‰§è¡Œ | - |
| Phase 10 | ç»„åˆé£æ§ | æœªç»Ÿè®¡ | æœªç»Ÿè®¡ | â¸ å¾…æ‰§è¡Œ | - |
|-------|------|--------|--------|------|----------|

### 2.2 ä»£ç åº“é”šç‚¹ï¼ˆæ¯æ¬¡æäº¤åæ›´æ–°ï¼‰

```
å½“å‰ä»£ç åº“çŠ¶æ€ (2025-12-17):
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ market/           # 7 files 
â”‚   â”œâ”€â”€ audit/            # 7 files 
â”‚   â”œâ”€â”€ cost/             # 3 files 
â”‚   â”œâ”€â”€ guardian/         # 6 files 
â”‚   â”œâ”€â”€ execution/
â”‚   â”‚   â”œâ”€â”€ auto/         # 8 files 
â”‚   â”‚   â”œâ”€â”€ protection/   # 4 files 
â”‚   â”‚   â””â”€â”€ pair/         # 3 files 
â”‚   â”œâ”€â”€ strategy/
â”‚   â”‚   â”œâ”€â”€ calendar_arb/ # 4 files 
â”‚   â”‚   â””â”€â”€ experimental/ # 4 files 
â”‚   â”œâ”€â”€ replay/           # 2 files 
â”‚   â”œâ”€â”€ portfolio/        # 4 files 
â”‚   â”œâ”€â”€ monitoring/       # 3 files 
â”‚   â”œâ”€â”€ risk/             # 3 files 
â”‚   â””â”€â”€ trading/          # CI/SIM gates
â”œâ”€â”€ tests/                # 765 tests 
â”œâ”€â”€ docs/                 # 9 documents
â””â”€â”€ scripts/              # 6 scripts
```

### 2.3 é—¨ç¦é”šç‚¹æ¯æ¬¡å¿…é¡»æ£€æŸ¥ï¼ˆæ¯æ¬¡æäº¤åæ›´æ–°ï¼‰

| é—¨ç¦ | çŠ¶æ€ | æœ€åæ£€æŸ¥æ—¶é—´ |
|------|------|--------------|
| Ruff Check | âœ… PASS | 2025-12-17 |
| Ruff Format | âœ… PASS | 2025-12-17 |
| Mypy | âœ… PASS | 2025-12-17 |
| Pytest | âœ… PASS (826 tests) | 2025-12-17 |
| Coverage | 88.22% | 2025-12-17 |
| Policy | âœ… PASS | 2025-12-17 |
| Scenario | âœ… PASS (ALL) | 2025-12-17 |
| CI/CD | âœ… PASS | 2025-12-17 |
| Deployment | âœ… PASS | 2025-12-17 |
| FMEA | âœ… COMPLETED | 2025-12-16 |
| Rollback | âœ… DEFINED | 2025-12-16 |
| Test Spec | âœ… COMPLETED | 2025-12-16 |
| CICD Integration | âœ… COMPLETED | 2025-12-16 |
| Scene Matrix | âœ… COMPLETED | 2025-12-16 |
| File List | âœ… COMPLETED | 2025-12-16 |
| Work Estimation | âœ… COMPLETED | 2025-12-16 |
| Acceptance Criteria | âœ… COMPLETED | 2025-12-16 |
|-------|------|--------------|

### 2.4 å¯èƒ½æœ‰é—®é¢˜æ¨¡å—æ‘˜è¦ï¼ˆæ¯æ¬¡æäº¤åæ›´æ–°ï¼‰

| æ¨¡å— | æ ¸å¿ƒåŠŸèƒ½ | å†›è§„è¦†ç›– |
|------|----------|----------|
| `src/cost/` | æˆæœ¬ä¼°è®¡ã€ä¸­å›½æœŸè´§æ‰‹ç»­è´¹è®¡ç®—ã€å¹³ä»Šå¹³æ˜¨åˆ†ç¦» | M5, M14, M20 |
| `src/portfolio/` | å¤šç­–ç•¥æŒä»“ç®¡ç†ã€é£é™©åˆ†æã€å¤æ™®æ¯”ç‡ | M1, M3, M19 |
| `src/monitoring/` | å¥åº·æ£€æŸ¥ã€PrometheusæŒ‡æ ‡ã€å‘Šè­¦ | M9, M10 |
| `src/risk/var_calculator.py` | å†å²/å‚æ•°/è’™ç‰¹å¡æ´›VaR | M6, M16 |
| `src/strategy/experimental/` | æˆç†Ÿåº¦è¯„ä¼°ã€è®­ç»ƒé—¨ç¦ã€è¿›åº¦ç›‘æ§ | M18 |
| `src/strategy/calendar_arb/` | Kalmanæ»¤æ³¢ã€å¥—åˆ©ç­–ç•¥ã€é™çº§é“¾ | M4, M5, M7 |
| `src/replay/` | å†³ç­–å›æ”¾ã€å“ˆå¸ŒéªŒè¯ | M7 |
| `src/execution/auto/` | å…¨è‡ªåŠ¨ä¸‹å•ã€è®¢å•ç®¡ç† | M2, M12 |
| `src/execution/protection/` | æ¶¨è·Œåœæ£€æŸ¥ã€ä¿è¯é‡‘ç›‘æ§ | M13, M16 |
| `src/execution/pair/` | å¯¹å†²äº¤æ˜“ã€è·¨æ‰€ä¸€è‡´æ€§ | M20 |
| `src/market/` | è¡Œæƒ…æ•°æ®å¤„ç†ã€åˆçº¦ç¼“å­˜ | M1 |
| `src/audit/` | å®¡è®¡æ—¥å¿—ã€JSONLæ ¼å¼ | M3 |
| `scripts/` | éƒ¨ç½²è„šæœ¬ã€é…ç½®ç®¡ç† | M8 |
| tests/ | å•å…ƒæµ‹è¯•ã€é›†æˆæµ‹è¯• | å…¨è¦†ç›– |
| docs/ | æ–‡æ¡£ã€å‡çº§è®¡åˆ’ | å…¨è¦†ç›– |
|â”€â”€â”€â”€â”€


---

## Â§3 å‡çº§æ¶æ„æ€»è§ˆ

### 3.1 ç³»ç»Ÿæ¶æ„å›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        V4PRO å†›è§„çº§äº¤æ˜“ç³»ç»Ÿæ¶æ„                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                 â”‚
â”‚  â”‚   è¡Œæƒ…å±‚    â”‚â”€â”€â”€â–¶â”‚   ç­–ç•¥å±‚    â”‚â”€â”€â”€â–¶â”‚   æ‰§è¡Œå±‚    â”‚                 â”‚
â”‚  â”‚  (Market)   â”‚    â”‚ (Strategy)  â”‚    â”‚ (Execution) â”‚                 â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜                 â”‚
â”‚         â”‚                  â”‚                  â”‚                         â”‚
â”‚         â–¼                  â–¼                  â–¼                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â”‚
â”‚  â”‚                    å®¡è®¡å±‚ (Audit)                    â”‚               â”‚
â”‚  â”‚        JSONLæ ¼å¼ Â· å®Œæ•´è¿½æº¯ Â· ç›‘ç®¡åˆè§„              â”‚               â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â”‚
â”‚         â”‚                  â”‚                  â”‚                         â”‚
â”‚         â–¼                  â–¼                  â–¼                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                 â”‚
â”‚  â”‚   é£æ§å±‚    â”‚    â”‚   æˆæœ¬å±‚    â”‚    â”‚   å›æ”¾å±‚    â”‚                 â”‚
â”‚  â”‚   (Risk)    â”‚    â”‚   (Cost)    â”‚    â”‚  (Replay)   â”‚                 â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜                 â”‚
â”‚         â”‚                  â”‚                  â”‚                         â”‚
â”‚         â–¼                  â–¼                  â–¼                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â”‚
â”‚  â”‚                  å®ˆæŠ¤å±‚ (Guardian)                   â”‚               â”‚
â”‚  â”‚    ç†”æ–­ä¿æŠ¤ Â· æ¶¨è·Œåœæ£€æŸ¥ Â· ä¿è¯é‡‘ç›‘æ§ Â· åˆè§„èŠ‚æµ    â”‚               â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â”‚
â”‚         â”‚                  â”‚                  â”‚                         â”‚
â”‚         â–¼                  â–¼                  â–¼                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                 â”‚
â”‚  â”‚  ç»„åˆç®¡ç†   â”‚    â”‚  ç›‘æ§å‘Šè­¦   â”‚    â”‚  å®éªŒé—¨ç¦   â”‚                 â”‚
â”‚  â”‚ (Portfolio) â”‚    â”‚ (Monitor)   â”‚    â”‚(Experimental)â”‚                 â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                 â”‚
â”‚                                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 3.2 æ•°æ®æµå‘

```
è¡Œæƒ…æ•°æ® â”€â”€â–¶ åˆçº¦ç¼“å­˜ â”€â”€â–¶ ç­–ç•¥å¼•æ“ â”€â”€â–¶ ä¿¡å·ç”Ÿæˆ â”€â”€â–¶ æˆæœ¬é—¨ç¦ â”€â”€â–¶ é£æ§æ£€æŸ¥
                                                                    â”‚
                                                                    â–¼
CTPæ¥å£ â—€â”€â”€ è®¢å•æ‰§è¡Œ â—€â”€â”€ è®¢å•éªŒè¯ â—€â”€â”€ æ¶¨è·Œåœæ£€æŸ¥ â—€â”€â”€ ä¿è¯é‡‘æ£€æŸ¥ â—€â”€â”€ åˆè§„æ£€æŸ¥
                                                                    â”‚
                                                                    â–¼
                                                              å®¡è®¡æ—¥å¿—è®°å½•
```

### 3.3 åŒè½¨æ¶æ„

| è½¨é“ | æè¿° | é€‚ç”¨åœºæ™¯ |
|------|------|----------|
| **Aè½¨ (ç”Ÿäº§)** | æˆç†Ÿç­–ç•¥ï¼Œå…¨è‡ªåŠ¨æ‰§è¡Œ | æ—¥å¸¸äº¤æ˜“ |
| **Bè½¨ (å®éªŒ)** | å®éªŒç­–ç•¥ï¼Œé—¨ç¦æ§åˆ¶ | ç­–ç•¥ç ”å‘ |
|â”€â”€â”€â”€â”€|------|----------|

---

## Â§4 Phaseä¾èµ–å…³ç³»å›¾

```
                           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                           â”‚  Phase 0    â”‚
                           â”‚  åŸºç¡€è®¾æ–½   â”‚
                           â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
                                  â”‚
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â–¼                   â–¼                   â–¼
       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
       â”‚  Phase 1    â”‚     â”‚  Phase 2    â”‚     â”‚  Phase 5    â”‚
       â”‚   è¡Œæƒ…å±‚    â”‚     â”‚   å®¡è®¡å±‚    â”‚     â”‚   æˆæœ¬å±‚    â”‚
       â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
              â”‚                   â”‚                   â”‚
              â–¼                   â–¼                   â–¼
       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
       â”‚  Phase 3    â”‚     â”‚  Phase 4    â”‚     â”‚  Phase 6    â”‚
       â”‚ ç­–ç•¥é™çº§    â”‚     â”‚  å›æ”¾éªŒè¯   â”‚     â”‚  Bç±»æ¨¡å‹    â”‚
       â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
              â”‚                   â”‚                   â”‚
              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                  â”‚
                                  â–¼
                           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                           â”‚  Phase 7    â”‚
                           â”‚ä¸­å›½æœŸè´§ç‰¹åŒ– â”‚
                           â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
                                  â”‚
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â–¼                   â–¼                   â–¼
       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
       â”‚  Phase 8    â”‚     â”‚  Phase 9    â”‚     â”‚  Phase 10   â”‚
       â”‚ æ™ºèƒ½ç­–ç•¥    â”‚     â”‚ åˆè§„ç›‘æ§    â”‚     â”‚ ç»„åˆé£æ§    â”‚
       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Â§5 Phase 0: åŸºç¡€è®¾æ–½

### 5.1 æ–‡ä»¶æ¸…å•

| æ–‡ä»¶ | è¡Œæ•° | åŠŸèƒ½ | çŠ¶æ€ |
|------|------|------|------|
| `src/trading/ci_gate.py` | ~150 | CIé—¨ç¦æ£€æŸ¥ | âœ… |
| `src/trading/sim_gate.py` | ~160 | ä»¿çœŸé—¨ç¦æ£€æŸ¥ | âœ… |
| `src/brokers/ctp/api.py` | ~200 | CTPæ¥å£å°è£… | âœ… |
| `src/brokers/ctp/config.py` | ~100 | CTPé…ç½®ç®¡ç† | âœ… |
| `src/app/config.py` | ~150 | åº”ç”¨é…ç½® | âœ… |
| `src/app/logger.py` | ~100 | æ—¥å¿—é…ç½® | âœ… |
| `scripts/validate_policy.py` | ~200 | ç­–ç•¥éªŒè¯è„šæœ¬ | âœ… |
| `scripts/sim_gate.py` | ~160 | ä»¿çœŸé—¨ç¦è„šæœ¬ | âœ… |
|---------|------|------|------|

### 5.2 åœºæ™¯è¦†ç›–

| Rule ID | åœºæ™¯æè¿° | æµ‹è¯•æ–‡ä»¶ |
|---------|----------|----------|
| `INFRA.CI.GATE_PASS` | CIé—¨ç¦å…¨éƒ¨é€šè¿‡ | test_ci_gate.py |
| `INFRA.CI.LINT_PASS` | Ruffæ£€æŸ¥é€šè¿‡ | test_ci_gate.py |
| `INFRA.CI.TYPE_PASS` | Mypyæ£€æŸ¥é€šè¿‡ | test_ci_gate.py |
| `INFRA.CI.TEST_PASS` | Pytesté€šè¿‡ | test_ci_gate.py |
| `INFRA.CI.COVERAGE_MIN` | è¦†ç›–ç‡â‰¥80% | test_ci_gate.py |
| `INFRA.SIM.GATE_PASS` | ä»¿çœŸé—¨ç¦é€šè¿‡ | test_sim_gate.py |
| `INFRA.SIM.SCENARIO_ALL` | æ‰€æœ‰åœºæ™¯è¦†ç›– | test_sim_gate.py |
| `INFRA.CTP.CONNECT` | CTPè¿æ¥æˆåŠŸ | test_ctp_api.py |
| `INFRA.CTP.AUTH` | CTPè®¤è¯æˆåŠŸ | test_ctp_api.py |
| `INFRA.CTP.SUBSCRIBE` | è¡Œæƒ…è®¢é˜…æˆåŠŸ | test_ctp_api.py |
| `INFRA.CONFIG.LOAD` | é…ç½®åŠ è½½æˆåŠŸ | test_config.py |
| `INFRA.CONFIG.VALIDATE` | é…ç½®éªŒè¯é€šè¿‡ | test_config.py |
| `INFRA.CONFIG.ENV_ISOLATE` | ç¯å¢ƒéš”ç¦»æ­£ç¡® | test_config.py |
| `INFRA.LOG.FORMAT` | æ—¥å¿—æ ¼å¼æ­£ç¡® | test_logger.py |
| `INFRA.LOG.LEVEL` | æ—¥å¿—çº§åˆ«æ­£ç¡® | test_logger.py |
| `INFRA.POLICY.VALIDATE` | ç­–ç•¥ç¬¦åˆæ”¿ç­– | test_validate_policy.py |
| `INFRA.POLICY.REPORT` | ç­–ç•¥éªŒè¯æŠ¥å‘Šç”Ÿæˆ | test_validate_policy.py |
| `INFRA.SCRIPT.EXECUTE` | è„šæœ¬æ‰§è¡ŒæˆåŠŸ | test_scripts.py |
| `INFRA.SCRIPT.OUTPUT` | è„šæœ¬è¾“å‡ºæ­£ç¡® | test_scripts.py |
|---------|----------|----------|


---

## Â§6 Phase 1: è¡Œæƒ…å±‚

### 6.1 æ–‡ä»¶æ¸…å•

| æ–‡ä»¶ | è¡Œæ•° | åŠŸèƒ½ | çŠ¶æ€ |
|------|------|------|------|
| `src/market/subscriber.py` | ~250 | è¡Œæƒ…è®¢é˜…ç®¡ç† | âœ… |
| `src/market/instrument_cache.py` | ~184 | åˆçº¦å…ƒæ•°æ®ç¼“å­˜ | âœ… |
| `src/market/tick_buffer.py` | ~200 | Tickæ•°æ®ç¼“å†² | âœ… |
| `src/market/kline_builder.py` | ~180 | Kçº¿æ„å»ºå™¨ | âœ… |
| `src/market/snapshot.py` | ~150 | è¡Œæƒ…å¿«ç…§ | âœ… |
| `src/market/exchange_config.py` | ~300 | äº¤æ˜“æ‰€é…ç½® | â¸ å¾…æ–°å¢ |
| `src/market/trading_calendar.py` | ~250 | å¤œç›˜äº¤æ˜“æ—¥å† | â¸ å¾…æ–°å¢ |
|---------|------|------|------|


### 6.2 InstrumentInfo æ‰©å±•å­—æ®µ

```python
@dataclass
class InstrumentInfo:
    """åˆçº¦å…ƒæ•°æ® (ä¸­å›½æœŸè´§å¸‚åœºæ‰©å±•ç‰ˆ)"""

    # åŸºç¡€å­—æ®µ (å·²æœ‰)
    symbol: str                    # åˆçº¦ä»£ç  å¦‚ "rb2501"
    product: str                   # å“ç§ä»£ç  å¦‚ "rb"
    exchange: str                  # äº¤æ˜“æ‰€ä»£ç  å¦‚ "SHFE"
    expire_date: str               # åˆ°æœŸæ—¥ å¦‚ "20250115"
    tick_size: float               # æœ€å°å˜åŠ¨ä»·ä½
    multiplier: int                # åˆçº¦ä¹˜æ•°
    max_order_volume: int          # å•ç¬”æœ€å¤§ä¸‹å•é‡
    position_limit: int            # æŒä»“é™é¢

    # ä¸­å›½æœŸè´§å¸‚åœºæ‰©å±•å­—æ®µ (å¾…æ–°å¢)
    price_limit_up: float          # æ¶¨åœä»·
    price_limit_down: float        # è·Œåœä»·
    price_limit_pct: float         # æ¶¨è·Œåœå¹…åº¦ (%)
    margin_ratio_long: float       # å¤šå¤´ä¿è¯é‡‘ç‡
    margin_ratio_short: float      # ç©ºå¤´ä¿è¯é‡‘ç‡
    fee_open_ratio: float          # å¼€ä»“æ‰‹ç»­è´¹ç‡ (æŒ‰é‡‘é¢)
    fee_close_ratio: float         # å¹³ä»“æ‰‹ç»­è´¹ç‡ (æŒ‰é‡‘é¢)
    fee_open_fixed: float          # å¼€ä»“æ‰‹ç»­è´¹ (æŒ‰æ‰‹)
    fee_close_fixed: float         # å¹³ä»“æ‰‹ç»­è´¹ (æŒ‰æ‰‹)
    fee_close_today_ratio: float   # å¹³ä»Šæ‰‹ç»­è´¹ç‡
    fee_type: str                  # æ‰‹ç»­è´¹ç±»å‹: "ratio" | "fixed" | "mixed"
    trading_sessions: list[tuple]  # äº¤æ˜“æ—¶æ®µåˆ—è¡¨
    has_night_session: bool        # æ˜¯å¦æœ‰å¤œç›˜
    is_main_contract: bool         # æ˜¯å¦ä¸»åŠ›åˆçº¦
    delivery_month: int            # äº¤å‰²æœˆä»½
    last_trading_day: str          # æœ€åäº¤æ˜“æ—¥
```

### 6.3 åœºæ™¯è¦†ç›–

| Rule ID | åœºæ™¯æè¿° | å†›è§„ |
|---------|----------|------|
| `MKT.SUBSCRIBER.DIFF_UPDATE` | å·®é‡æ›´æ–°è®¢é˜…åˆ—è¡¨ | M1 |
| `MKT.SUBSCRIBER.CALLBACK` | å›è°ƒæ­£ç¡®è§¦å‘ | M9 |
| `MKT.CACHE.INSTRUMENT_INFO` | åˆçº¦ä¿¡æ¯æ­£ç¡®ç¼“å­˜ | M11 |
| `MKT.CACHE.EXPIRE_CHECK` | è¿‡æœŸæ£€æŸ¥æ­£ç¡® | M15 |
| `MKT.TICK.BUFFER_OVERFLOW` | ç¼“å†²åŒºæº¢å‡ºå¤„ç† | M10 |
| `MKT.TICK.TIMESTAMP_ORDER` | æ—¶é—´æˆ³é¡ºåºæ­£ç¡® | M7 |
| `MKT.KLINE.BUILD_CORRECT` | Kçº¿æ„å»ºæ­£ç¡® | M7 |
| `MKT.KLINE.GAP_HANDLE` | ç¼ºå£å¤„ç†æ­£ç¡® | M4 |
| `MKT.LIMIT.PRICE_CHECK` | æ¶¨è·Œåœä»·æ ¼æ£€æŸ¥ | M13 |
| `MKT.LIMIT.UPDATE_REALTIME` | æ¶¨è·Œåœå®æ—¶æ›´æ–° | M13 |
| `MKT.SESSION.NIGHT_CALENDAR` | å¤œç›˜æ—¥å†æ­£ç¡® | M15 |
| `MKT.SESSION.DAY_BOUNDARY` | äº¤æ˜“æ—¥è¾¹ç•Œæ­£ç¡® | M15 |
| `MKT.EXCHANGE.CONFIG_LOAD` | äº¤æ˜“æ‰€é…ç½®åŠ è½½ | M8 |
| `MKT.EXCHANGE.CONFIG_VALIDATE` | äº¤æ˜“æ‰€é…ç½®éªŒè¯ | M8 |
| `MKT.EXCHANGE.CONFIG_ISOLATE` | äº¤æ˜“æ‰€é…ç½®éš”ç¦» | M8 |
| `MKT.EXCHANGE.SESSION_DEFINE` | äº¤æ˜“æ—¶æ®µå®šä¹‰æ­£ç¡® | M15 |
| `MKT.EXCHANGE.NIGHT_SESSION_FLAG` | å¤œç›˜æ ‡è¯†æ­£ç¡® | M15 |
| `MKT.EXCHANGE.FEE_STRUCTURE` | æ‰‹ç»­è´¹ç»“æ„æ­£ç¡® | M20 |
| `MKT.EXCHANGE.MARGIN_REQUIREMENT` | ä¿è¯é‡‘è¦æ±‚æ­£ç¡® | M16 |
| `MKT.EXCHANGE.PRICE_LIMITS` | æ¶¨è·Œåœå¹…åº¦æ­£ç¡® | M13 |
| `MKT.EXCHANGE.DELIVERY_INFO` | äº¤å‰²ä¿¡æ¯æ­£ç¡® | M14 |
| `MKT.EXCHANGE.MAIN_CONTRACT_FLAG` | ä¸»åŠ›åˆçº¦æ ‡è¯†æ­£ç¡® | M1 |
| `MKT.EXCHANGE.LAST_TRADING_DAY` | æœ€åäº¤æ˜“æ—¥æ­£ç¡® | M14 |
| `MKT.EXCHANGE.TRADING_SESSIONS` | äº¤æ˜“æ—¶æ®µåˆ—è¡¨æ­£ç¡® | M15 |
| `MKT.EXCHANGE.FEE_TYPE` | æ‰‹ç»­è´¹ç±»å‹æ­£ç¡® | M20 |
| `MKT.EXCHANGE.FEE_CALCULATION` | æ‰‹ç»­è´¹è®¡ç®—æ­£ç¡® | M20 |
| `MKT.EXCHANGE.MARGIN_CALCULATION` | ä¿è¯é‡‘è®¡ç®—æ­£ç¡® | M16 |
| `MKT.EXCHANGE.PRICE_LIMIT_CALCULATION` | æ¶¨è·Œåœè®¡ç®—æ­£ç¡® | M13 |
| `MKT.EXCHANGE.SESSION_HANDLING` | äº¤æ˜“æ—¶æ®µå¤„ç†æ­£ç¡® | M15 |
| `MKT.EXCHANGE.NIGHT_SESSION_HANDLING` | å¤œç›˜å¤„ç†æ­£ç¡® | M15 |
| `MKT.EXCHANGE.CONFIG_UPDATES` | é…ç½®æ›´æ–°æ­£ç¡® | M8 |
| `MKT.EXCHANGE.ERROR_HANDLING` | é”™è¯¯å¤„ç†æ­£ç¡® | M9 |
| `MKT.EXCHANGE.LOGGING` | æ—¥å¿—è®°å½•æ­£ç¡® | M3 |
| `MKT.EXCHANGE.PERFORMANCE` | æ€§èƒ½ç¬¦åˆè¦æ±‚ | M10 |
| `MKT.EXCHANGE.TEST_COVERAGE` | æµ‹è¯•è¦†ç›–ç‡â‰¥90% | M10 |
| `MKT.EXCHANGE.DOCUMENTATION` | æ–‡æ¡£é½å…¨ | M11 |
| `MKT.EXCHANGE.CODE_QUALITY` | ä»£ç è´¨é‡ç¬¦åˆæ ‡å‡† | M10 |
| `MKT.EXCHANGE.COMPLIANCE` | ç¬¦åˆç›‘ç®¡è¦æ±‚ | M17 |
| `MKT.EXCHANGE.UPGRADE_PATH` | å‡çº§è·¯å¾„æ­£ç¡® | M11 |
| `MKT.EXCHANGE.VERSION_COMPATIBILITY` | ç‰ˆæœ¬å…¼å®¹æ€§æ­£ç¡® | M11 |
| `MKT.EXCHANGE.INTEGRATION_TESTS` | é›†æˆæµ‹è¯•é€šè¿‡ | M11 |
| `MKT.EXCHANGE.STRESS_TESTS` | å‹åŠ›æµ‹è¯•é€šè¿‡ | M10 |
| `MKT.EXCHANGE.USER_GUIDE` | ç”¨æˆ·æŒ‡å—é½å…¨ | M11 |
| `MKT.EXCHANGE.CHANGE_LOG` | å˜æ›´æ—¥å¿—é½å…¨ | M11 |
| `MKT.EXCHANGE.RELEASE_NOTES` | å‘å¸ƒè¯´æ˜é½å…¨ | M11 |
| `MKT.EXCHANGE.SUPPORT_PROCESSES` | æ”¯æŒæµç¨‹å®Œå–„ | M11 |
|---------|----------|------|

---

## Â§7 Phase 2: å®¡è®¡å±‚

### 7.1 æ–‡ä»¶æ¸…å•

| æ–‡ä»¶ | è¡Œæ•° | åŠŸèƒ½ | çŠ¶æ€ |
|------|------|------|------|
| `src/audit/writer.py` | ~200 | å®¡è®¡æ—¥å¿—å†™å…¥å™¨ | âœ… |
| `src/audit/reader.py` | ~150 | å®¡è®¡æ—¥å¿—è¯»å–å™¨ | âœ… |
| `src/audit/event.py` | ~180 | å®¡è®¡äº‹ä»¶å®šä¹‰ | âœ… |
| `src/audit/validator.py` | ~120 | å®¡è®¡éªŒè¯å™¨ | âœ… |
| `src/audit/correlation.py` | ~100 | å…³è”IDç®¡ç† | âœ… |
| `src/audit/exporter.py` | ~150 | å®¡è®¡å¯¼å‡ºå™¨ | âœ… |
| `src/audit/compressor.py` | ~100 | å®¡è®¡å‹ç¼©å™¨ | âœ… |
| `src/audit/retention.py` | ~130 | å®¡è®¡ä¿ç•™ç­–ç•¥ | âœ… |
|---------|------|------|------|

### 7.2 å®¡è®¡äº‹ä»¶Schema

```python
@dataclass
class AuditEvent:
    """å®¡è®¡äº‹ä»¶ (å†›è§„çº§ v4.0)"""

    # å¿…å¡«å­—æ®µ
    ts: str                        # ISO8601æ—¶é—´æˆ³
    event_type: str                # äº‹ä»¶ç±»å‹
    run_id: str                    # è¿è¡ŒID
    exec_id: str                   # æ‰§è¡ŒID


    # å¯é€‰å­—æ®µ
    symbol: str | None = None      # åˆçº¦ä»£ç 
    direction: str | None = None   # æ–¹å‘: "LONG" | "SHORT"
    price: float | None = None     # ä»·æ ¼
    volume: int | None = None      # æ•°é‡
    strategy: str | None = None    # ç­–ç•¥åç§°
    signal_source: str | None = None  # ä¿¡å·æ¥æº (M1)
    cost_breakdown: dict | None = None  # æˆæœ¬æ˜ç»† (M5)
    risk_check: dict | None = None  # é£æ§æ£€æŸ¥ç»“æœ (M6)
    error: str | None = None       # é”™è¯¯ä¿¡æ¯
    metadata: dict | None = None   # æ‰©å±•å…ƒæ•°æ®
    

```

### 7.3 åœºæ™¯è¦†ç›–

| Rule ID | åœºæ™¯æè¿° | å†›è§„ |
|---------|----------|------|
| `AUDIT.EVENT.STRUCTURE` | äº‹ä»¶ç»“æ„å®Œæ•´ | M3 |
| `AUDIT.EVENT.JSONL_FORMAT` | JSONLæ ¼å¼æ­£ç¡® | M3 |
| `AUDIT.CORRELATION.RUN_EXEC` | run_id/exec_idå…³è” | M3 |
| `AUDIT.WRITER.PROPERTIES` | å†™å…¥å™¨å±æ€§æ­£ç¡® | M3 |
| `AUDIT.WRITER.CLOSE_BEHAVIOR` | å…³é—­åè¡Œä¸ºæ­£ç¡® | M3 |
| `AUDIT.VALIDATE.MISSING_TS` | ç¼ºå°‘æ—¶é—´æˆ³æ£€æµ‹ | M3 |
| `AUDIT.VALIDATE.MISSING_TYPE` | ç¼ºå°‘ç±»å‹æ£€æµ‹ | M3 |
| `AUDIT.DICT.WRITE` | å­—å…¸å†™å…¥æ­£ç¡® | M3 |
| `AUDIT.DICT.MISSING_REQUIRED` | ç¼ºå°‘å¿…å¡«å­—æ®µæ£€æµ‹ | M3 |
| `AUDIT.READ.EMPTY_FILE` | è¯»å–ç©ºæ–‡ä»¶å¤„ç† | M4 |
| `AUDIT.CONTEXT.MANAGER` | ä¸Šä¸‹æ–‡ç®¡ç†å™¨æ­£ç¡® | M3 |
| `AUDIT.EXEC_ID.DEFAULT` | exec_idé»˜è®¤å€¼æ­£ç¡® | M3 |
| `AUDIT.COMPRESS.GZIP` | GZIPå‹ç¼©æ­£ç¡® | M10 |
| `AUDIT.EXPORT.CSV` | CSVå¯¼å‡ºæ­£ç¡® | M3 |
| `AUDIT.EXPORT.PARQUET` | Parquetå¯¼å‡ºæ­£ç¡® | M3 |
| `AUDIT.RETENTION.POLICY` | ä¿ç•™ç­–ç•¥æ­£ç¡® | M3 |
| `AUDIT.SIGNAL_SOURCE.TRACK` | ä¿¡å·æ¥æºè¿½è¸ª | M1, M3 |
| `AUDIT.COST.BREAKDOWN` | æˆæœ¬æ˜ç»†è®°å½• | M5, M3 |
| `AUDIT.RISK.CHECK` | é£æ§æ£€æŸ¥è®°å½• | M6, M3 |
|---------|----------|------|

---

## Â§8 Phase 3: ç­–ç•¥é™çº§ä¸å¥—åˆ©

### 8.1 æ–‡ä»¶æ¸…å•

| æ–‡ä»¶ | è¡Œæ•° | åŠŸèƒ½ | çŠ¶æ€ |
|------|------|------|------|
| `src/strategy/fallback.py` | ~350 | é™çº§ç®¡ç†å™¨ | âœ… |
| `src/strategy/calendar_arb/kalman_beta.py` | ~200 | Kalmanæ»¤æ³¢ä¼°è®¡ | âœ… |
| `src/strategy/calendar_arb/strategy.py` | ~400 | å¥—åˆ©ç­–ç•¥ | âœ… |
| `src/strategy/calendar_arb/__init__.py` | ~30 | æ¨¡å—å¯¼å‡º | âœ… |
|---------|------|------|------|

### 8.2 é™çº§é“¾é…ç½®

```python
DEFAULT_FALLBACK_CHAINS = {
    "calendar_arb": [
        "calendar_arb",      # ä¸»ç­–ç•¥: æ—¥å†å¥—åˆ©
        "simple_ma",         # é™çº§1: ç®€å•å‡çº¿
        "stop_loss_only",    # é™çº§2: ä»…æ­¢æŸ
        "flat_all",          # é™çº§3: å…¨å¹³
    ],
    "trend_follow": [
        "trend_follow",      # ä¸»ç­–ç•¥: è¶‹åŠ¿è·Ÿè¸ª
        "momentum",          # é™çº§1: åŠ¨é‡
        "stop_loss_only",    # é™çº§2: ä»…æ­¢æŸ
        "flat_all",          # é™çº§3: å…¨å¹³
    ],
}
```

### 8.3 Kalmanæ»¤æ³¢å‚æ•°

```python
@dataclass
class KalmanConfig:
    """Kalmanæ»¤æ³¢å™¨é…ç½®"""

    process_noise: float = 1e-5      # è¿‡ç¨‹å™ªå£° Q
    observation_noise: float = 1e-3  # è§‚æµ‹å™ªå£° R
    initial_beta: float = 1.0        # åˆå§‹beta
    initial_variance: float = 1.0    # åˆå§‹æ–¹å·®
    beta_min: float = 0.5            # betaä¸‹ç•Œ
    beta_max: float = 2.0            # betaä¸Šç•Œ

```

### 8.4 åœºæ™¯è¦†ç›–

| Rule ID | åœºæ™¯æè¿° | å†›è§„ |
|---------|----------|------|
| `STRAT.FALLBACK.ON_EXCEPTION` | å¼‚å¸¸è§¦å‘é™çº§ | M4 |
| `STRAT.FALLBACK.ON_TIMEOUT` | è¶…æ—¶è§¦å‘é™çº§ | M4 |
| `STRAT.FALLBACK.CHAIN_DEFINED` | é™çº§é“¾å·²å®šä¹‰ | M4 |
| `ARB.KALMAN.BETA_ESTIMATE` | betaä¼°è®¡æ­£ç¡® | M7 |
| `ARB.KALMAN.RESIDUAL_ZSCORE` | æ®‹å·®zåˆ†æ•°è®¡ç®— | M7 |
| `ARB.KALMAN.BETA_BOUND` | betaè¾¹ç•Œçº¦æŸ | M6 |
| `ARB.LEGS.FIXED_NEAR_FAR` | è¿‘è¿œæœˆè…¿å›ºå®š | M1 |
| `ARB.SIGNAL.HALF_LIFE_GATE` | åŠè¡°æœŸé—¨ç¦ | M5 |
| `ARB.SIGNAL.STOP_Z_BREAKER` | æ­¢æŸzå€¼è§¦å‘ | M6 |
| `ARB.SIGNAL.EXPIRY_GATE` | åˆ°æœŸæ—¥é—¨ç¦ | M15 |
| `ARB.SIGNAL.CORRELATION_BREAK` | ç›¸å…³æ€§ç ´è£‚æ£€æµ‹ | M6 |
| `ARB.COST.ENTRY_GATE` | æˆæœ¬é—¨ç¦æ£€æŸ¥ | M5 |
| `ARB.COST.EXIT_GATE` | æˆæœ¬é—¨ç¦æ£€æŸ¥ | M5 |
| `ARB.LOGGING.DECISIONS` | å†³ç­–æ—¥å¿—è®°å½• | M3 |
| `ARB.LOGGING.PARAMS` | å‚æ•°æ—¥å¿—è®°å½• | M3 |
| `ARB.TEST_COVERAGE` | æµ‹è¯•è¦†ç›–ç‡â‰¥90% | M10 |
| `ARB.DOCUMENTATION` | æ–‡æ¡£é½å…¨ | M11 |
| `ARB.CODE_QUALITY` | ä»£ç è´¨é‡ç¬¦åˆæ ‡å‡† | M10 |
| `ARB.COMPLIANCE` | ç¬¦åˆç›‘ç®¡è¦æ±‚ | M17 |
| `ARB.UPGRADE_PATH` | å‡çº§è·¯å¾„æ­£ç¡® | M11 |
| `ARB.VERSION_COMPATIBILITY` | ç‰ˆæœ¬å…¼å®¹æ€§æ­£ç¡® | M11 |
| `ARB.INTEGRATION_TESTS` | é›†æˆæµ‹è¯•é€šè¿‡ | M11 |
| `ARB.STRESS_TESTS` | å‹åŠ›æµ‹è¯•é€šè¿‡ | M10 |
| `ARB.USER_GUIDE` | ç”¨æˆ·æŒ‡å—é½å…¨ | M11 |
| `ARB.CHANGE_LOG` | å˜æ›´æ—¥å¿—é½å…¨ | M11 |
| `ARB.RELEASE_NOTES` | å‘å¸ƒè¯´æ˜é½å…¨ | M11 |
| `ARB.SUPPORT_PROCESSES` | æ”¯æŒæµç¨‹å®Œå–„ | M11 |
|---------|----------|------|

---

## Â§9 Phase 4: å›æ”¾éªŒè¯

### 9.1 æ–‡ä»¶æ¸…å•

| æ–‡ä»¶ | è¡Œæ•° | åŠŸèƒ½ | çŠ¶æ€ |
|------|------|------|------|
| `src/replay/verifier.py` | ~280 | å›æ”¾éªŒè¯å™¨ | âœ… |
| `src/replay/__init__.py` | ~30 | æ¨¡å—å¯¼å‡º | âœ… |
|---------|------|------|------|

### 9.2 å›æ”¾éªŒè¯é€»è¾‘

```python
class ReplayVerifier:
    """å›æ”¾éªŒè¯å™¨ (å†›è§„ M7)"""

    def verify_decision_sequence(
        self,
        original: list[Decision],
        replayed: list[Decision],
    ) -> VerifyResult:
        """éªŒè¯å†³ç­–åºåˆ—ä¸€è‡´æ€§"""
        # SHA256å“ˆå¸Œæ¯”è¾ƒ
        original_hash = self._compute_hash(original)
        replayed_hash = self._compute_hash(replayed)
        return VerifyResult(
            passed=original_hash == replayed_hash,
            original_hash=original_hash,
            replayed_hash=replayed_hash,
        
        )

    def verify_guardian_sequence(
        self,
        original: list[GuardianAction],
        replayed: list[GuardianAction],
    ) -> VerifyResult:
        """éªŒè¯å®ˆæŠ¤åŠ¨ä½œåºåˆ—ä¸€è‡´æ€§"""

        original_hash = self._compute_hash(original)
        replayed_hash = self._compute_hash(replayed)
        return VerifyResult(
            passed=original_hash == replayed_hash,
            original_hash=original_hash,
            replayed_hash=replayed_hash,
        )
    def _compute_hash(self, sequence: list[Any]) -> str:
        """è®¡ç®—åºåˆ—çš„SHA256å“ˆå¸Œå€¼"""
        hasher = hashlib.sha256()
        for item in sequence:
            hasher.update(repr(item).encode('utf-8'))
        return hasher.hexdigest() 
```

### 9.3 åœºæ™¯è¦†ç›–

| Rule ID | åœºæ™¯æè¿° | å†›è§„ |
|---------|----------|------|
| `REPLAY.DETERMINISTIC.DECISION` | å†³ç­–åºåˆ—ç¡®å®šæ€§ | M7 |
| `REPLAY.DETERMINISTIC.GUARDIAN` | å®ˆæŠ¤åŠ¨ä½œç¡®å®šæ€§ | M7 |
| `REPLAY.HASH.MATCH` | å“ˆå¸Œå€¼åŒ¹é… | M7 |
| `REPLAY.ERROR.HANDLING` | é”™è¯¯å¤„ç†æ­£ç¡® | M9 |
| `REPLAY.LOGGING.RESULTS` | ç»“æœæ—¥å¿—è®°å½• | M3 |
| `REPLAY.TEST_COVERAGE` | æµ‹è¯•è¦†ç›–ç‡â‰¥90% | M10 |
| `REPLAY.DOCUMENTATION` | æ–‡æ¡£é½å…¨ | M11 |
| `REPLAY.CODE_QUALITY` | ä»£ç è´¨é‡ç¬¦åˆæ ‡å‡† | M10 |
| `REPLAY.UPGRADE_PATH` | å‡çº§è·¯å¾„æ­£ç¡® | M11 |
| `REPLAY.VERSION_COMPATIBILITY` | ç‰ˆæœ¬å…¼å®¹æ€§æ­£ç¡® | M11
|---------|----------|------|

---

## Â§10 Phase 5: æˆæœ¬å±‚

### 10.1 æ–‡ä»¶æ¸…å•

| æ–‡ä»¶ | è¡Œæ•° | åŠŸèƒ½ | çŠ¶æ€ |
|------|------|------|------|
| `src/cost/estimator.py` | ~328 | æˆæœ¬ä¼°è®¡å™¨ | âœ… |
| `src/cost/china_fee_calculator.py` | ~653 | ä¸­å›½æœŸè´§æ‰‹ç»­è´¹ | âœ… |
| `src/cost/__init__.py` | ~30 | æ¨¡å—å¯¼å‡º | âœ… |
|---------|------|------|------|

### 10.2 æˆæœ¬æ¨¡å‹

```python
@dataclass
class CostBreakdown:
    """æˆæœ¬åˆ†è§£"""

    fee: float           # æ‰‹ç»­è´¹
    slippage: float      # æ»‘ç‚¹
    impact: float        # å¸‚åœºå†²å‡»
    total: float         # æ€»æˆæœ¬

    # ä¸­å›½æœŸè´§å¸‚åœºæ‰©å±•
    fee_open: float = 0.0         # å¼€ä»“æ‰‹ç»­è´¹
    fee_close: float = 0.0        # å¹³ä»“æ‰‹ç»­è´¹
    fee_close_today: float = 0.0  # å¹³ä»Šæ‰‹ç»­è´¹
    stamp_duty: float = 0.0       # å°èŠ±ç¨ (ä»…è‚¡æŒ‡)
```

### 10.3 ä¸­å›½æœŸè´§æ‰‹ç»­è´¹ç»“æ„

| äº¤æ˜“æ‰€ | å“ç§ç¤ºä¾‹ | æ‰‹ç»­è´¹ç±»å‹ | å¼€ä»“ | å¹³ä»“ | å¹³ä»Š |
|--------|----------|------------|------|------|------|
| SHFE | é“œ cu | æŒ‰é‡‘é¢ | 0.5â€± | 0.5â€± | 0 |
| SHFE | èºçº¹é’¢ rb | æŒ‰æ‰‹ | 1å…ƒ/æ‰‹ | 1å…ƒ/æ‰‹ | 1å…ƒ/æ‰‹ |
| DCE | é“çŸ¿çŸ³ i | æŒ‰é‡‘é¢ | 1â€± | 1â€± | 1â€± |
| CZCE | ç”²é†‡ MA | æŒ‰æ‰‹ | 2å…ƒ/æ‰‹ | 2å…ƒ/æ‰‹ | 6å…ƒ/æ‰‹ |
| CFFEX | IF | æŒ‰é‡‘é¢ | 0.23â€± | 0.23â€± | 3.45â€± |
| GFEX | ç¢³é…¸é”‚ LC | æŒ‰é‡‘é¢ | 0.5â€± | 0.5â€± | 3â€± |
| INE | åŸæ²¹ SC | æŒ‰æ‰‹ | 20å…ƒ/æ‰‹ | 20å…ƒ/æ‰‹ | 0 |
|--------|----------|------------|------|------|------|

### 10.4 åœºæ™¯è¦†ç›–

| Rule ID | åœºæ™¯æè¿° | å†›è§„ |
|---------|----------|------|
| `COST.FEE.ESTIMATE` | æ‰‹ç»­è´¹ä¼°è®¡æ­£ç¡® | M5 |
| `COST.SLIPPAGE.ESTIMATE` | æ»‘ç‚¹ä¼°è®¡æ­£ç¡® | M5 |
| `COST.IMPACT.ESTIMATE` | å¸‚åœºå†²å‡»ä¼°è®¡æ­£ç¡® | M5 |
| `COST.TOTAL.CALCULATE` | æ€»æˆæœ¬è®¡ç®—æ­£ç¡® | M5 |
| `COST.EDGE.GATE` | è¾¹é™…æ”¶ç›Šé—¨ç¦ | M5 |
| `COST.BREAKDOWN.CALCULATE` | æˆæœ¬åˆ†è§£è®¡ç®—æ­£ç¡® | M5 |
| `COST.FEE.BY_VOLUME` | æŒ‰æ‰‹æ”¶è´¹è®¡ç®— | M5 |
| `COST.FEE.BY_VALUE` | æŒ‰é‡‘é¢æ”¶è´¹è®¡ç®— | M5 |
| `COST.FEE.OPEN` | å¼€ä»“æ‰‹ç»­è´¹è®¡ç®— | M14 | |
| `COST.FEE.CLOSE` | å¹³ä»“æ‰‹ç»­è´¹è®¡ç®— | M14 |
| `COST.FEE.CLOSE_TODAY` | å¹³ä»Šæ‰‹ç»­è´¹è®¡ç®— | M14 |
| `COST.FEE.EXCHANGE_CONFIG` | äº¤æ˜“æ‰€é…ç½®æ­£ç¡® | M20 |
| `COST.FEE.TYPE_HANDLING` | æ‰‹ç»­è´¹ç±»å‹å¤„ç†æ­£ç¡® | M20 |
| `COST.FEE.UPDATES` | æ‰‹ç»­è´¹æ›´æ–°æ­£ç¡® | M20 |
| `COST.ERROR.HANDLING` | é”™è¯¯å¤„ç†æ­£ç¡® | M9 |
| `COST.LOGGING.BREAKDOWN` | æˆæœ¬åˆ†è§£æ—¥å¿—è®°å½• | M3 |
|---------|----------|------|

---

## Â§11 Phase 6: Bç±»æ¨¡å‹ï¼ˆæ·±åº¦å­¦ä¹ ä¸å¼ºåŒ–å­¦ä¹ ï¼‰

### 11.1 æ¨¡å—æ¶æ„æ€»è§ˆ

```
src/strategy/
â”œâ”€â”€ dl/                              # æ·±åº¦å­¦ä¹ æ¨¡å—
â”‚   â”œâ”€â”€ __init__.py                  # æ¨¡å—å¯¼å‡º
â”‚   â”œâ”€â”€ models/                      # æ¨¡å‹ç»“æ„
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”œâ”€â”€ base.py                  # DLæ¨¡å‹åŸºç±»ï¼ˆå«å®¡è®¡ã€ç§å­æ§åˆ¶ï¼‰
â”‚   â”‚   â”œâ”€â”€ lstm.py                  # LSTMæ¨¡å‹ï¼ˆåŒ…å«é¢„æµ‹è¾“å‡ºçš„åœºæ™¯è§„åˆ™ï¼‰
â”‚   â”‚   â”œâ”€â”€ transformer.py           # Transformeræ¨¡å‹ï¼ˆæ³¨æ„åŠ›è®¡ç®—ä¸ä½ç½®ç¼–ç ï¼‰
â”‚   â”‚   â””â”€â”€ cnn.py                   # CNNæ¨¡å‹
â”‚   â”œâ”€â”€ data/                        # æ•°æ®å¤„ç†
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”œâ”€â”€ sequence_handler.py      # åºåˆ—æ•°æ®å¤„ç†ï¼ˆåºåˆ—é•¿åº¦éªŒè¯ï¼‰
â”‚   â”‚   â”œâ”€â”€ dataset.py               # æ•°æ®é›†å®šä¹‰
â”‚   â”‚   â””â”€â”€ dataloader.py            # æ•°æ®åŠ è½½å™¨
â”‚   â”œâ”€â”€ factor/                      # å› å­ç›¸å…³
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”œâ”€â”€ factor_miner.py          # å› å­æŒ–æ˜ï¼ˆåŒ…å«å› å­æŒ–æ˜åœºæ™¯è§„åˆ™ï¼‰
â”‚   â”‚   â”œâ”€â”€ ic_calculator.py         # ICè®¡ç®—ï¼ˆåŒ…å«ICè®¡ç®—è§„åˆ™ï¼‰
â”‚   â”‚   â””â”€â”€ feature_selector.py      # ç‰¹å¾é€‰æ‹©å™¨
â”‚   â”œâ”€â”€ predictor/                   # é¢„æµ‹å™¨
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”œâ”€â”€ lstm_predictor.py        # LSTMé¢„æµ‹å™¨
â”‚   â”‚   â”œâ”€â”€ transformer_predictor.py # Transformeré¢„æµ‹å™¨
â”‚   â”‚   â””â”€â”€ cnn_predictor.py         # CNNé¢„æµ‹å™¨
â”‚   â”œâ”€â”€ loss/                        # æŸå¤±å‡½æ•°
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â””â”€â”€ loss_functions.py        # æŸå¤±å‡½æ•°å®šä¹‰
â”‚   â”œâ”€â”€ metrics/                     # è¯„ä¼°æŒ‡æ ‡
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â””â”€â”€ metrics.py               # è¯„ä¼°æŒ‡æ ‡ï¼ˆå‡†ç¡®ç‡ã€å¤æ™®ç­‰ï¼‰
â”‚   â”œâ”€â”€ optimizer/                   # ä¼˜åŒ–å™¨
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â””â”€â”€ optimizer.py             # ä¼˜åŒ–å™¨å°è£…
â”‚   â”œâ”€â”€ trainer/                     # è®­ç»ƒå™¨
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â””â”€â”€ trainer.py               # æ¨¡å‹è®­ç»ƒå™¨
â”‚   â”œâ”€â”€ scheduler/                   # å­¦ä¹ ç‡è°ƒåº¦
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â””â”€â”€ scheduler.py             # å­¦ä¹ ç‡è°ƒåº¦å™¨
â”‚   â”œâ”€â”€ early_stopping/              # æ—©åœæœºåˆ¶
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â””â”€â”€ early_stopping.py        # æ—©åœæœºåˆ¶å®ç°
â”‚   â””â”€â”€ checkpoint/                  # æ¨¡å‹æ£€æŸ¥ç‚¹
â”‚       â”œâ”€â”€ __init__.py
â”‚       â””â”€â”€ checkpoint.py            # æ¨¡å‹æ£€æŸ¥ç‚¹ç®¡ç†
â”‚
â”œâ”€â”€ rl/                              # å¼ºåŒ–å­¦ä¹ æ¨¡å—
â”‚   â”œâ”€â”€ __init__.py                  # æ¨¡å—å¯¼å‡º
â”‚   â”œâ”€â”€ config.py                    # RLé…ç½®æ–‡ä»¶
â”‚   â”œâ”€â”€ base.py                      # RLåŸºç±»ï¼ˆå«ç¯å¢ƒã€è®°å¿†ï¼‰
â”‚   â”œâ”€â”€ environment.py               # äº¤æ˜“ç¯å¢ƒï¼ˆçŠ¶æ€ã€åŠ¨ä½œã€å¥–åŠ±ï¼‰
â”‚   â”œâ”€â”€ memory.py                    # ç»éªŒå›æ”¾å†…å­˜
â”‚   â”œâ”€â”€ actor_critic.py              # Actor-Criticç½‘ç»œ
â”‚   â”œâ”€â”€ ppo_model.py                 # PPOæ¨¡å‹ç»“æ„
â”‚   â”œâ”€â”€ dqn_model.py                 # DQNæ¨¡å‹ç»“æ„
â”‚   â”œâ”€â”€ dueling_dqn.py               # Dueling DQNæ¨¡å‹
â”‚   â”œâ”€â”€ target_network.py            # ç›®æ ‡ç½‘ç»œæ›´æ–°
â”‚   â”œâ”€â”€ exploration.py               # æ¢ç´¢ç­–ç•¥ï¼ˆÎµ-greedyç­‰ï¼‰
â”‚   â”œâ”€â”€ reward_function.py           # å¥–åŠ±å‡½æ•°è®¾è®¡ï¼ˆå¤æ™®/é£é™©è°ƒæ•´ï¼‰
â”‚   â”œâ”€â”€ ppo_agent.py                 # PPOå¼ºåŒ–å­¦ä¹ ä»£ç†
â”‚   â”œâ”€â”€ actor_critic_agent.py        # Actor-Criticä»£ç†
â”‚   â””â”€â”€ dqn_agent.py                 # DQNå¼ºåŒ–å­¦ä¹ ä»£ç†
â”‚
â”œâ”€â”€ cv/                              # äº¤å‰éªŒè¯æ¨¡å—
â”‚   â”œâ”€â”€ __init__.py                  # æ¨¡å—å¯¼å‡º
â”‚   â”œâ”€â”€ cv_config.py                 # äº¤å‰éªŒè¯é…ç½®
â”‚   â”œâ”€â”€ cv_splitter.py               # äº¤å‰éªŒè¯åˆ’åˆ†å™¨ï¼ˆæ—¶åºåˆ’åˆ†ï¼‰
â”‚   â”œâ”€â”€ cv_runner.py                 # äº¤å‰éªŒè¯è¿è¡Œå™¨
â”‚   â”œâ”€â”€ cv_evaluator.py              # äº¤å‰éªŒè¯è¯„ä¼°å™¨
â”‚   â”œâ”€â”€ cv_reporter.py               # äº¤å‰éªŒè¯æŠ¥å‘Šç”Ÿæˆå™¨
â”‚   â”œâ”€â”€ cv_plotter.py                # äº¤å‰éªŒè¯ç»“æœå¯è§†åŒ–
â”‚   â”œâ”€â”€ cv_logger.py                 # äº¤å‰éªŒè¯æ—¥å¿—è®°å½•
â”‚   â”œâ”€â”€ cv_data_handler.py           # äº¤å‰éªŒè¯æ•°æ®å¤„ç†
â”‚   â””â”€â”€ cv_utils.py                  # äº¤å‰éªŒè¯å·¥å…·å‡½æ•°
â”‚
â”œâ”€â”€ utils/                           # å·¥å…·å‡½æ•°æ¨¡å—
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ logger.py                    # ç»Ÿä¸€æ—¥å¿—
â”‚   â”œâ”€â”€ visualizer.py                # ç»“æœå¯è§†åŒ–
â”‚   â”œâ”€â”€ experiment_tracker.py        # å®éªŒè·Ÿè¸ª
â”‚   â””â”€â”€ utils.py                     # å¸¸ç”¨å·¥å…·å‡½æ•°
â”‚
â””â”€â”€ common/                          # å…¬å…±å·¥å…·æ¨¡å—
    â”œâ”€â”€ __init__.py
    â”œâ”€â”€ config.py                    # é…ç½®è§£æå·¥å…·
    â”œâ”€â”€ logging.py                   # æ—¥å¿—è®°å½•å™¨
    â””â”€â”€ utils.py                     # å¸¸ç”¨å·¥å…·å‡½æ•°
```

### 11.2 æ–‡ä»¶æ¸…å•

#### 11.2.1 æ·±åº¦å­¦ä¹ æ¨¡å— (DL)

| æ–‡ä»¶è·¯å¾„ | é¢„è®¡è¡Œæ•° | åŠŸèƒ½æè¿° | å†›è§„è¦†ç›– | çŠ¶æ€ |
|----------|----------|----------|----------|------|
| `dl/__init__.py` | ~50 | æ¨¡å—å¯¼å‡º | - | â¸ å¾…æ–°å¢ |
| `dl/models/base.py` | ~200 | DLæ¨¡å‹åŸºç±»ï¼ˆå®¡è®¡ã€ç§å­æ§åˆ¶ï¼‰ | M3,M7,M18 | â¸ å¾…æ–°å¢ |
| `dl/models/lstm.py` | ~350 | LSTMæ¨¡å‹ç»“æ„ | M7,M18 | â¸ å¾…æ–°å¢ |
| `dl/models/transformer.py` | ~450 | Transformeræ¨¡å‹ï¼ˆæ³¨æ„åŠ›+ä½ç½®ç¼–ç ï¼‰ | M7,M18 | â¸ å¾…æ–°å¢ |
| `dl/models/cnn.py` | ~300 | CNNæ¨¡å‹ç»“æ„ | M18 | â¸ å¾…æ–°å¢ |
| `dl/data/sequence_handler.py` | ~200 | åºåˆ—æ•°æ®å¤„ç†ï¼ˆé•¿åº¦éªŒè¯ï¼‰ | M7 | â¸ å¾…æ–°å¢ |
| `dl/data/dataset.py` | ~250 | æ•°æ®é›†å®šä¹‰ | M7 | â¸ å¾…æ–°å¢ |
| `dl/data/dataloader.py` | ~150 | æ•°æ®åŠ è½½å™¨ | M7 | â¸ å¾…æ–°å¢ |
| `dl/factor/factor_miner.py` | ~400 | å› å­æŒ–æ˜å™¨ | M18,M19 | â¸ å¾…æ–°å¢ |
| `dl/factor/ic_calculator.py` | ~200 | IC/IRè®¡ç®—å™¨ | M19 | â¸ å¾…æ–°å¢ |
| `dl/factor/feature_selector.py` | ~250 | ç‰¹å¾é€‰æ‹©å™¨ | M18 | â¸ å¾…æ–°å¢ |
| `dl/predictor/lstm_predictor.py` | ~300 | LSTMé¢„æµ‹å™¨ | M7,M18 | â¸ å¾…æ–°å¢ |
| `dl/predictor/transformer_predictor.py` | ~350 | Transformeré¢„æµ‹å™¨ | M7,M18 | â¸ å¾…æ–°å¢ |
| `dl/predictor/cnn_predictor.py` | ~280 | CNNé¢„æµ‹å™¨ | M18 | â¸ å¾…æ–°å¢ |
| `dl/loss/loss_functions.py` | ~200 | æŸå¤±å‡½æ•°ï¼ˆMSE/Huber/å¤æ™®ï¼‰ | M18 | â¸ å¾…æ–°å¢ |
| `dl/metrics/metrics.py` | ~250 | è¯„ä¼°æŒ‡æ ‡ï¼ˆå‡†ç¡®ç‡/å¤æ™®/å›æ’¤ï¼‰ | M18,M19 | â¸ å¾…æ–°å¢ |
| `dl/optimizer/optimizer.py` | ~150 | ä¼˜åŒ–å™¨å°è£…ï¼ˆAdam/SGDï¼‰ | - | â¸ å¾…æ–°å¢ |
| `dl/trainer/trainer.py` | ~400 | æ¨¡å‹è®­ç»ƒå™¨ | M3,M18 | â¸ å¾…æ–°å¢ |
| `dl/scheduler/scheduler.py` | ~150 | å­¦ä¹ ç‡è°ƒåº¦å™¨ | - | â¸ å¾…æ–°å¢ |
| `dl/early_stopping/early_stopping.py` | ~120 | æ—©åœæœºåˆ¶ | M18 | â¸ å¾…æ–°å¢ |
| `dl/checkpoint/checkpoint.py` | ~200 | æ¨¡å‹æ£€æŸ¥ç‚¹ç®¡ç† | M3,M11 | â¸ å¾…æ–°å¢ |

**DLæ¨¡å—å°è®¡: 21 æ–‡ä»¶, ~5150 è¡Œ**

#### 11.2.2 å¼ºåŒ–å­¦ä¹ æ¨¡å— (RL)

| æ–‡ä»¶è·¯å¾„ | é¢„è®¡è¡Œæ•° | åŠŸèƒ½æè¿° | å†›è§„è¦†ç›– | çŠ¶æ€ |
|----------|----------|----------|----------|------|
| `rl/__init__.py` | ~60 | æ¨¡å—å¯¼å‡º | - | â¸ å¾…æ–°å¢ |
| `rl/config.py` | ~100 | RLé…ç½®å‚æ•° | M8 | â¸ å¾…æ–°å¢ |
| `rl/base.py` | ~250 | RLåŸºç±»ï¼ˆå®¡è®¡ã€ç§å­ã€é—¨ç¦ï¼‰ | M3,M7,M18 | â¸ å¾…æ–°å¢ |
| `rl/environment.py` | ~400 | äº¤æ˜“ç¯å¢ƒï¼ˆçŠ¶æ€/åŠ¨ä½œ/å¥–åŠ±ï¼‰ | M7,M18 | â¸ å¾…æ–°å¢ |
| `rl/memory.py` | ~200 | ç»éªŒå›æ”¾å†…å­˜ | M7 | â¸ å¾…æ–°å¢ |
| `rl/actor_critic.py` | ~300 | Actor-Criticç½‘ç»œç»“æ„ | M18 | â¸ å¾…æ–°å¢ |
| `rl/ppo_model.py` | ~350 | PPOæ¨¡å‹ç»“æ„ | M18 | â¸ å¾…æ–°å¢ |
| `rl/dqn_model.py` | ~300 | DQNæ¨¡å‹ç»“æ„ | M18 | â¸ å¾…æ–°å¢ |
| `rl/dueling_dqn.py` | ~250 | Dueling DQNæ¨¡å‹ | M18 | â¸ å¾…æ–°å¢ |
| `rl/target_network.py` | ~150 | ç›®æ ‡ç½‘ç»œæ›´æ–° | M7 | â¸ å¾…æ–°å¢ |
| `rl/exploration.py` | ~200 | æ¢ç´¢ç­–ç•¥ï¼ˆÎµ-greedy/UCBï¼‰ | M7,M18 | â¸ å¾…æ–°å¢ |
| `rl/reward_function.py` | ~300 | å¥–åŠ±å‡½æ•°è®¾è®¡ | M18,M19 | â¸ å¾…æ–°å¢ |
| `rl/ppo_agent.py` | ~450 | PPOå¼ºåŒ–å­¦ä¹ ä»£ç† | M3,M7,M18 | â¸ å¾…æ–°å¢ |
| `rl/actor_critic_agent.py` | ~400 | Actor-Criticä»£ç† | M3,M7,M18 | â¸ å¾…æ–°å¢ |
| `rl/dqn_agent.py` | ~400 | DQNå¼ºåŒ–å­¦ä¹ ä»£ç† | M3,M7,M18 | â¸ å¾…æ–°å¢ |

**RLæ¨¡å—å°è®¡: 15 æ–‡ä»¶, ~4110 è¡Œ**

#### 11.2.3 äº¤å‰éªŒè¯æ¨¡å— (CV)

| æ–‡ä»¶è·¯å¾„ | é¢„è®¡è¡Œæ•° | åŠŸèƒ½æè¿° | å†›è§„è¦†ç›– | çŠ¶æ€ |
|----------|----------|----------|----------|------|
| `cv/__init__.py` | ~40 | æ¨¡å—å¯¼å‡º | - | â¸ å¾…æ–°å¢ |
| `cv/cv_config.py` | ~100 | äº¤å‰éªŒè¯é…ç½® | M8 | â¸ å¾…æ–°å¢ |
| `cv/cv_splitter.py` | ~250 | æ—¶åºäº¤å‰éªŒè¯åˆ’åˆ†å™¨ | M7 | â¸ å¾…æ–°å¢ |
| `cv/cv_runner.py` | ~300 | äº¤å‰éªŒè¯è¿è¡Œå™¨ | M7,M18 | â¸ å¾…æ–°å¢ |
| `cv/cv_evaluator.py` | ~250 | äº¤å‰éªŒè¯è¯„ä¼°å™¨ | M18,M19 | â¸ å¾…æ–°å¢ |
| `cv/cv_reporter.py` | ~200 | äº¤å‰éªŒè¯æŠ¥å‘Šç”Ÿæˆå™¨ | M3 | â¸ å¾…æ–°å¢ |
| `cv/cv_plotter.py` | ~180 | äº¤å‰éªŒè¯ç»“æœå¯è§†åŒ– | - | â¸ å¾…æ–°å¢ |
| `cv/cv_logger.py` | ~120 | äº¤å‰éªŒè¯æ—¥å¿—è®°å½• | M3 | â¸ å¾…æ–°å¢ |
| `cv/cv_data_handler.py` | ~200 | äº¤å‰éªŒè¯æ•°æ®å¤„ç† | M7 | â¸ å¾…æ–°å¢ |
| `cv/cv_utils.py` | ~100 | äº¤å‰éªŒè¯å·¥å…·å‡½æ•° | - | â¸ å¾…æ–°å¢ |

**CVæ¨¡å—å°è®¡: 10 æ–‡ä»¶, ~1740 è¡Œ**

#### 11.2.4 å·¥å…·æ¨¡å— (utils/common)

| æ–‡ä»¶è·¯å¾„ | é¢„è®¡è¡Œæ•° | åŠŸèƒ½æè¿° | å†›è§„è¦†ç›– | çŠ¶æ€ |
|----------|----------|----------|----------|------|
| `utils/__init__.py` | ~30 | æ¨¡å—å¯¼å‡º | - | â¸ å¾…æ–°å¢ |
| `utils/logger.py` | ~150 | ç»Ÿä¸€æ—¥å¿—è®°å½• | M3,M9 | â¸ å¾…æ–°å¢ |
| `utils/visualizer.py` | ~250 | ç»“æœå¯è§†åŒ– | - | â¸ å¾…æ–°å¢ |
| `utils/experiment_tracker.py` | ~200 | å®éªŒè·Ÿè¸ªï¼ˆMLflowé›†æˆï¼‰ | M3 | â¸ å¾…æ–°å¢ |
| `utils/utils.py` | ~150 | å¸¸ç”¨å·¥å…·å‡½æ•° | - | â¸ å¾…æ–°å¢ |
| `common/__init__.py` | ~20 | æ¨¡å—å¯¼å‡º | - | â¸ å¾…æ–°å¢ |
| `common/config.py` | ~150 | é…ç½®è§£æå·¥å…· | M8 | â¸ å¾…æ–°å¢ |
| `common/logging.py` | ~100 | æ—¥å¿—è®°å½•å™¨ | M3 | â¸ å¾…æ–°å¢ |
| `common/utils.py` | ~100 | å¸¸ç”¨å·¥å…·å‡½æ•° | - | â¸ å¾…æ–°å¢ |

**å·¥å…·æ¨¡å—å°è®¡: 9 æ–‡ä»¶, ~1150 è¡Œ**

#### 11.2.5 Phase 6 æ–‡ä»¶ç»Ÿè®¡æ€»è¡¨

| æ¨¡å— | æ–‡ä»¶æ•° | é¢„è®¡è¡Œæ•° |
|------|--------|----------|
| DL æ·±åº¦å­¦ä¹  | 21 | ~5150 |
| RL å¼ºåŒ–å­¦ä¹  | 15 | ~4110 |
| CV äº¤å‰éªŒè¯ | 10 | ~1740 |
| å·¥å…·æ¨¡å— | 9 | ~1150 |
| **æ€»è®¡** | **55** | **~12150** |

### 11.3 Bç±»æ¨¡å‹æˆç†Ÿåº¦è¦æ±‚

| ç»´åº¦ | æƒé‡ | åŠæ ¼çº¿ | è‰¯å¥½çº¿ | ä¼˜ç§€çº¿ |
|------|------|--------|--------|--------|
| æ”¶ç›Šç¨³å®šæ€§ | 25% | å¤æ™®â‰¥1.0 | å¤æ™®â‰¥1.5 | å¤æ™®â‰¥2.0 |
| é£é™©æ§åˆ¶ | 25% | å›æ’¤â‰¤20% | å›æ’¤â‰¤15% | å›æ’¤â‰¤10% |
| å¸‚åœºé€‚åº”æ€§ | 20% | è¦†ç›–3çŠ¶æ€ | è¦†ç›–5çŠ¶æ€ | è¦†ç›–7çŠ¶æ€ |
| è®­ç»ƒå……åˆ†åº¦ | 20% | â‰¥90å¤© | â‰¥180å¤© | â‰¥365å¤© |
| ä¸€è‡´æ€§ | 10% | ç›¸å…³â‰¥0.6 | ç›¸å…³â‰¥0.7 | ç›¸å…³â‰¥0.8 |

### 11.4 æ ¸å¿ƒä»£ç è®¾è®¡

#### 11.4.1 DLæ¨¡å‹åŸºç±»

```python
class DLModelBase:
    """æ·±åº¦å­¦ä¹ æ¨¡å‹åŸºç±» (å†›è§„ M3, M7, M18)"""

    BYPASS_FORBIDDEN = True  # ç¦æ­¢ç»•è¿‡é—¨ç¦

    def __init__(self, seed: int = 42, device: str = "cpu"):
        self.seed = seed
        self.device = device
        self._set_deterministic(seed)  # M7: å›æ”¾ä¸€è‡´æ€§
        self._audit_writer = None

    def _set_deterministic(self, seed: int) -> None:
        """è®¾ç½®ç¡®å®šæ€§éšæœºç§å­ (å†›è§„ M7)"""
        import random
        import numpy as np
        import torch

        random.seed(seed)
        np.random.seed(seed)
        torch.manual_seed(seed)
        if torch.cuda.is_available():
            torch.cuda.manual_seed_all(seed)
            torch.backends.cudnn.deterministic = True
            torch.backends.cudnn.benchmark = False

    def predict(self, inputs: Any) -> tuple[Any, dict]:
        """é¢„æµ‹æ–¹æ³• (å¿…é¡»è¿”å›å®¡è®¡ä¿¡æ¯, å†›è§„ M3)"""
        raise NotImplementedError

    def can_go_live(self) -> tuple[bool, str]:
        """æ£€æŸ¥æ˜¯å¦å¯ä»¥ä¸Šçº¿ (å†›è§„ M18)"""
        from src.strategy.experimental import MaturityEvaluator
        evaluator = MaturityEvaluator()
        result = evaluator.evaluate(self)
        if result.total_score < 0.8:
            return False, f"æˆç†Ÿåº¦ {result.total_score:.1%} < 80%"
        if any(s < 0.6 for s in result.dimension_scores.values()):
            return False, "å­˜åœ¨ç»´åº¦å¾—åˆ† < 60%"
        return True, "é€šè¿‡é—¨ç¦"
```

#### 11.4.2 RLä»£ç†åŸºç±»

```python
class RLAgentBase:
    """å¼ºåŒ–å­¦ä¹ ä»£ç†åŸºç±» (å†›è§„ M3, M7, M18)"""

    BYPASS_FORBIDDEN = True  # ç¦æ­¢ç»•è¿‡é—¨ç¦

    def __init__(
        self,
        state_dim: int,
        action_dim: int,
        seed: int = 42,
    ):
        self.state_dim = state_dim
        self.action_dim = action_dim
        self.seed = seed
        self._set_deterministic(seed)  # M7: å›æ”¾ä¸€è‡´æ€§

    def select_action(self, state: np.ndarray) -> tuple[int, dict]:
        """é€‰æ‹©åŠ¨ä½œ (å¿…é¡»è¿”å›å®¡è®¡ä¿¡æ¯, å†›è§„ M3)"""
        raise NotImplementedError

    def update(self, batch: dict) -> dict:
        """æ›´æ–°æ¨¡å‹ (è¿”å›è®­ç»ƒæŒ‡æ ‡)"""
        raise NotImplementedError

    def compute_reward(
        self,
        pnl: float,
        position: float,
        risk_metrics: dict,
    ) -> float:
        """è®¡ç®—å¥–åŠ± (å†›è§„ M18, M19)"""
        # å¤æ™®æ¯”ç‡è°ƒæ•´å¥–åŠ±
        sharpe_reward = pnl / (risk_metrics.get("volatility", 1.0) + 1e-8)
        # é£é™©æƒ©ç½š
        drawdown_penalty = -abs(risk_metrics.get("drawdown", 0)) * 0.5
        # æŒä»“æˆæœ¬
        position_cost = -abs(position) * 0.001
        return sharpe_reward + drawdown_penalty + position_cost
```

#### 11.4.3 äº¤å‰éªŒè¯æ—¶åºåˆ’åˆ†å™¨

```python
class TimeSeriesCVSplitter:
    """æ—¶åºäº¤å‰éªŒè¯åˆ’åˆ†å™¨ (å†›è§„ M7)"""

    def __init__(
        self,
        n_splits: int = 5,
        train_size: int | None = None,
        test_size: int | None = None,
        gap: int = 0,  # è®­ç»ƒé›†å’Œæµ‹è¯•é›†ä¹‹é—´çš„é—´éš”
    ):
        self.n_splits = n_splits
        self.train_size = train_size
        self.test_size = test_size
        self.gap = gap

    def split(
        self,
        X: np.ndarray,
        y: np.ndarray | None = None,
    ) -> Generator[tuple[np.ndarray, np.ndarray], None, None]:
        """ç”Ÿæˆæ—¶åºäº¤å‰éªŒè¯åˆ’åˆ†"""
        n_samples = len(X)
        indices = np.arange(n_samples)

        test_size = self.test_size or n_samples // (self.n_splits + 1)
        train_size = self.train_size or test_size * 2

        for i in range(self.n_splits):
            test_start = n_samples - (self.n_splits - i) * test_size
            test_end = test_start + test_size
            train_end = test_start - self.gap
            train_start = max(0, train_end - train_size)

            yield indices[train_start:train_end], indices[test_start:test_end]
```

### 11.5 åœºæ™¯è¦†ç›– (Phase 6)

#### 11.5.1 æ·±åº¦å­¦ä¹ åœºæ™¯ (DL)

| åºå· | Rule ID | åœºæ™¯æè¿° | å†›è§„ | æµ‹è¯•æ–‡ä»¶ | çŠ¶æ€ |
|------|---------|----------|------|----------|------|
| K01 | `DL.BASE.DETERMINISTIC` | DLæ¨¡å‹ç¡®å®šæ€§éªŒè¯ | M7 | test_dl_base.py | â¸ |
| K02 | `DL.BASE.AUDIT_LOG` | DLæ¨¡å‹å®¡è®¡æ—¥å¿— | M3 | test_dl_base.py | â¸ |
| K03 | `DL.BASE.MATURITY_GATE` | DLæ¨¡å‹æˆç†Ÿåº¦é—¨ç¦ | M18 | test_dl_base.py | â¸ |
| K04 | `DL.LSTM.PREDICT` | LSTMé¢„æµ‹è¾“å‡ºæ­£ç¡® | M18 | test_lstm.py | â¸ |
| K05 | `DL.LSTM.SEQUENCE_LENGTH` | LSTMåºåˆ—é•¿åº¦éªŒè¯ | M7 | test_lstm.py | â¸ |
| K06 | `DL.LSTM.HIDDEN_STATE` | LSTMéšè—çŠ¶æ€æ­£ç¡® | M7 | test_lstm.py | â¸ |
| K07 | `DL.TRANSFORMER.ATTENTION` | Transformeræ³¨æ„åŠ›è®¡ç®— | M18 | test_transformer.py | â¸ |
| K08 | `DL.TRANSFORMER.POSITION_ENCODING` | Transformerä½ç½®ç¼–ç  | M7 | test_transformer.py | â¸ |
| K09 | `DL.TRANSFORMER.MASK` | Transformeræ©ç æ­£ç¡® | M7 | test_transformer.py | â¸ |
| K10 | `DL.CNN.CONV_OUTPUT` | CNNå·ç§¯è¾“å‡ºæ­£ç¡® | M18 | test_cnn.py | â¸ |
| K11 | `DL.DATA.SEQUENCE_VALID` | åºåˆ—æ•°æ®éªŒè¯ | M7 | test_data.py | â¸ |
| K12 | `DL.DATA.BATCH_LOAD` | æ‰¹æ¬¡æ•°æ®åŠ è½½æ­£ç¡® | M7 | test_data.py | â¸ |
| K13 | `DL.FACTOR.MINE` | å› å­æŒ–æ˜æ­£ç¡® | M18 | test_factor.py | â¸ |
| K14 | `DL.FACTOR.IC_CALCULATE` | ICè®¡ç®—æ­£ç¡® | M19 | test_factor.py | â¸ |
| K15 | `DL.FACTOR.IR_CALCULATE` | IRè®¡ç®—æ­£ç¡® | M19 | test_factor.py | â¸ |
| K16 | `DL.FACTOR.FEATURE_SELECT` | ç‰¹å¾é€‰æ‹©æ­£ç¡® | M18 | test_factor.py | â¸ |
| K17 | `DL.PREDICTOR.LSTM_OUTPUT` | LSTMé¢„æµ‹å™¨è¾“å‡º | M18 | test_predictor.py | â¸ |
| K18 | `DL.PREDICTOR.TRANSFORMER_OUTPUT` | Transformeré¢„æµ‹å™¨è¾“å‡º | M18 | test_predictor.py | â¸ |
| K19 | `DL.LOSS.MSE` | MSEæŸå¤±è®¡ç®—æ­£ç¡® | - | test_loss.py | â¸ |
| K20 | `DL.LOSS.SHARPE` | å¤æ™®æŸå¤±è®¡ç®—æ­£ç¡® | M18 | test_loss.py | â¸ |
| K21 | `DL.METRICS.ACCURACY` | å‡†ç¡®ç‡è®¡ç®—æ­£ç¡® | M19 | test_metrics.py | â¸ |
| K22 | `DL.METRICS.SHARPE` | å¤æ™®æ¯”ç‡è®¡ç®—æ­£ç¡® | M19 | test_metrics.py | â¸ |
| K23 | `DL.TRAINER.EPOCH` | è®­ç»ƒè½®æ¬¡æ‰§è¡Œæ­£ç¡® | M18 | test_trainer.py | â¸ |
| K24 | `DL.TRAINER.AUDIT_LOG` | è®­ç»ƒå®¡è®¡æ—¥å¿— | M3 | test_trainer.py | â¸ |
| K25 | `DL.EARLY_STOP.TRIGGER` | æ—©åœè§¦å‘æ­£ç¡® | M18 | test_early_stopping.py | â¸ |
| K26 | `DL.CHECKPOINT.SAVE` | æ£€æŸ¥ç‚¹ä¿å­˜æ­£ç¡® | M3,M11 | test_checkpoint.py | â¸ |
| K27 | `DL.CHECKPOINT.LOAD` | æ£€æŸ¥ç‚¹åŠ è½½æ­£ç¡® | M11 | test_checkpoint.py | â¸ |

**DLåœºæ™¯å°è®¡: 27 åœºæ™¯**

#### 11.5.2 å¼ºåŒ–å­¦ä¹ åœºæ™¯ (RL)

| åºå· | Rule ID | åœºæ™¯æè¿° | å†›è§„ | æµ‹è¯•æ–‡ä»¶ | çŠ¶æ€ |
|------|---------|----------|------|----------|------|
| K28 | `RL.BASE.DETERMINISTIC` | RLä»£ç†ç¡®å®šæ€§éªŒè¯ | M7 | test_rl_base.py | â¸ |
| K29 | `RL.BASE.AUDIT_LOG` | RLä»£ç†å®¡è®¡æ—¥å¿— | M3 | test_rl_base.py | â¸ |
| K30 | `RL.BASE.MATURITY_GATE` | RLä»£ç†æˆç†Ÿåº¦é—¨ç¦ | M18 | test_rl_base.py | â¸ |
| K31 | `RL.ENV.STATE_SPACE` | ç¯å¢ƒçŠ¶æ€ç©ºé—´æ­£ç¡® | M7 | test_environment.py | â¸ |
| K32 | `RL.ENV.ACTION_SPACE` | ç¯å¢ƒåŠ¨ä½œç©ºé—´æ­£ç¡® | M7 | test_environment.py | â¸ |
| K33 | `RL.ENV.REWARD_CALC` | ç¯å¢ƒå¥–åŠ±è®¡ç®—æ­£ç¡® | M18 | test_environment.py | â¸ |
| K34 | `RL.ENV.STEP` | ç¯å¢ƒæ­¥è¿›æ­£ç¡® | M7 | test_environment.py | â¸ |
| K35 | `RL.MEMORY.STORE` | ç»éªŒå­˜å‚¨æ­£ç¡® | M7 | test_memory.py | â¸ |
| K36 | `RL.MEMORY.SAMPLE` | ç»éªŒé‡‡æ ·æ­£ç¡® | M7 | test_memory.py | â¸ |
| K37 | `RL.PPO.ACTION` | PPOåŠ¨ä½œé€‰æ‹©æ­£ç¡® | M18 | test_ppo.py | â¸ |
| K38 | `RL.PPO.REWARD` | PPOå¥–åŠ±è®¡ç®—æ­£ç¡® | M18 | test_ppo.py | â¸ |
| K39 | `RL.PPO.CLIP_RATIO` | PPOè£å‰ªæ¯”ç‡æ­£ç¡® | M18 | test_ppo.py | â¸ |
| K40 | `RL.PPO.UPDATE` | PPOæ›´æ–°æ­£ç¡® | M18 | test_ppo.py | â¸ |
| K41 | `RL.DQN.QVALUE` | DQN Qå€¼è®¡ç®—æ­£ç¡® | M18 | test_dqn.py | â¸ |
| K42 | `RL.DQN.EPSILON_DECAY` | DQN Îµè¡°å‡æ­£ç¡® | M18 | test_dqn.py | â¸ |
| K43 | `RL.DQN.TARGET_UPDATE` | DQNç›®æ ‡ç½‘ç»œæ›´æ–° | M7 | test_dqn.py | â¸ |
| K44 | `RL.DQN.REPLAY` | DQNç»éªŒå›æ”¾æ­£ç¡® | M7 | test_dqn.py | â¸ |
| K45 | `RL.DUELING.ADVANTAGE` | Dueling DQNä¼˜åŠ¿å‡½æ•° | M18 | test_dueling_dqn.py | â¸ |
| K46 | `RL.AC.ACTOR_OUTPUT` | Actorç½‘ç»œè¾“å‡ºæ­£ç¡® | M18 | test_actor_critic.py | â¸ |
| K47 | `RL.AC.CRITIC_OUTPUT` | Criticç½‘ç»œè¾“å‡ºæ­£ç¡® | M18 | test_actor_critic.py | â¸ |
| K48 | `RL.REWARD.SHARPE_BASED` | å¤æ™®å¥–åŠ±å‡½æ•°æ­£ç¡® | M18 | test_reward.py | â¸ |
| K49 | `RL.REWARD.RISK_ADJUSTED` | é£é™©è°ƒæ•´å¥–åŠ±æ­£ç¡® | M18,M19 | test_reward.py | â¸ |
| K50 | `RL.REWARD.DRAWDOWN_PENALTY` | å›æ’¤æƒ©ç½šæ­£ç¡® | M6 | test_reward.py | â¸ |
| K51 | `RL.EXPLORATION.EPSILON` | Îµ-greedyæ¢ç´¢æ­£ç¡® | M7 | test_exploration.py | â¸ |
| K52 | `RL.EXPLORATION.UCB` | UCBæ¢ç´¢æ­£ç¡® | M7 | test_exploration.py | â¸ |

**RLåœºæ™¯å°è®¡: 25 åœºæ™¯**

#### 11.5.3 äº¤å‰éªŒè¯åœºæ™¯ (CV)

| åºå· | Rule ID | åœºæ™¯æè¿° | å†›è§„ | æµ‹è¯•æ–‡ä»¶ | çŠ¶æ€ |
|------|---------|----------|------|----------|------|
| K53 | `CV.SPLIT.TIMESERIES` | æ—¶åºåˆ’åˆ†æ­£ç¡® | M7 | test_cv_splitter.py | â¸ |
| K54 | `CV.SPLIT.NO_LEAKAGE` | æ— æ•°æ®æ³„éœ² | M7 | test_cv_splitter.py | â¸ |
| K55 | `CV.SPLIT.GAP` | é—´éš”è®¾ç½®æ­£ç¡® | M7 | test_cv_splitter.py | â¸ |
| K56 | `CV.RUN.FOLD_EXECUTE` | æŠ˜å æ‰§è¡Œæ­£ç¡® | M7 | test_cv_runner.py | â¸ |
| K57 | `CV.RUN.DETERMINISTIC` | è¿è¡Œç¡®å®šæ€§ | M7 | test_cv_runner.py | â¸ |
| K58 | `CV.EVAL.METRICS` | è¯„ä¼°æŒ‡æ ‡æ­£ç¡® | M19 | test_cv_evaluator.py | â¸ |
| K59 | `CV.EVAL.AGGREGATE` | èšåˆç»“æœæ­£ç¡® | M19 | test_cv_evaluator.py | â¸ |
| K60 | `CV.REPORT.GENERATE` | æŠ¥å‘Šç”Ÿæˆæ­£ç¡® | M3 | test_cv_reporter.py | â¸ |
| K61 | `CV.LOG.RECORD` | æ—¥å¿—è®°å½•æ­£ç¡® | M3 | test_cv_logger.py | â¸ |
| K62 | `CV.DATA.HANDLE` | æ•°æ®å¤„ç†æ­£ç¡® | M7 | test_cv_data.py | â¸ |

**CVåœºæ™¯å°è®¡: 10 åœºæ™¯**

#### 11.5.4 Phase 6 åœºæ™¯ç»Ÿè®¡

| ç±»åˆ« | åœºæ™¯æ•° | çŠ¶æ€ |
|------|--------|------|
| DL æ·±åº¦å­¦ä¹  | 27 | â¸ å¾…å®ç° |
| RL å¼ºåŒ–å­¦ä¹  | 25 | â¸ å¾…å®ç° |
| CV äº¤å‰éªŒè¯ | 10 | â¸ å¾…å®ç° |
| **æ€»è®¡** | **62** | â¸ |

### 11.6 æµ‹è¯•æ–‡ä»¶æ¸…å•

| æµ‹è¯•æ–‡ä»¶ | æµ‹è¯•ç›®æ ‡ | é¢„è®¡ç”¨ä¾‹æ•° |
|----------|----------|------------|
| `tests/strategy/dl/test_dl_base.py` | DLåŸºç±» | ~15 |
| `tests/strategy/dl/test_lstm.py` | LSTMæ¨¡å‹ | ~20 |
| `tests/strategy/dl/test_transformer.py` | Transformeræ¨¡å‹ | ~25 |
| `tests/strategy/dl/test_cnn.py` | CNNæ¨¡å‹ | ~15 |
| `tests/strategy/dl/test_data.py` | æ•°æ®å¤„ç† | ~20 |
| `tests/strategy/dl/test_factor.py` | å› å­æ¨¡å— | ~25 |
| `tests/strategy/dl/test_predictor.py` | é¢„æµ‹å™¨ | ~20 |
| `tests/strategy/dl/test_loss.py` | æŸå¤±å‡½æ•° | ~10 |
| `tests/strategy/dl/test_metrics.py` | è¯„ä¼°æŒ‡æ ‡ | ~15 |
| `tests/strategy/dl/test_trainer.py` | è®­ç»ƒå™¨ | ~20 |
| `tests/strategy/dl/test_early_stopping.py` | æ—©åœæœºåˆ¶ | ~10 |
| `tests/strategy/dl/test_checkpoint.py` | æ£€æŸ¥ç‚¹ | ~15 |
| `tests/strategy/rl/test_rl_base.py` | RLåŸºç±» | ~15 |
| `tests/strategy/rl/test_environment.py` | äº¤æ˜“ç¯å¢ƒ | ~25 |
| `tests/strategy/rl/test_memory.py` | ç»éªŒå›æ”¾ | ~15 |
| `tests/strategy/rl/test_ppo.py` | PPOä»£ç† | ~25 |
| `tests/strategy/rl/test_dqn.py` | DQNä»£ç† | ~25 |
| `tests/strategy/rl/test_dueling_dqn.py` | Dueling DQN | ~15 |
| `tests/strategy/rl/test_actor_critic.py` | Actor-Critic | ~20 |
| `tests/strategy/rl/test_reward.py` | å¥–åŠ±å‡½æ•° | ~20 |
| `tests/strategy/rl/test_exploration.py` | æ¢ç´¢ç­–ç•¥ | ~15 |
| `tests/strategy/cv/test_cv_splitter.py` | CVåˆ’åˆ†å™¨ | ~20 |
| `tests/strategy/cv/test_cv_runner.py` | CVè¿è¡Œå™¨ | ~15 |
| `tests/strategy/cv/test_cv_evaluator.py` | CVè¯„ä¼°å™¨ | ~15 |
| `tests/strategy/cv/test_cv_reporter.py` | CVæŠ¥å‘Šå™¨ | ~10 |
| `tests/strategy/cv/test_cv_logger.py` | CVæ—¥å¿— | ~10 |
| `tests/strategy/cv/test_cv_data.py` | CVæ•°æ® | ~10 |

**æµ‹è¯•æ–‡ä»¶æ€»è®¡: 27 æ–‡ä»¶, ~455 ç”¨ä¾‹**

### 11.7 å·¥æ—¶ä¼°ç®—

| å­æ¨¡å— | å¼€å‘å·¥æ—¶ | æµ‹è¯•å·¥æ—¶ | æ–‡æ¡£å·¥æ—¶ | åˆè®¡ |
|--------|----------|----------|----------|------|
| DLæ¨¡å‹ (models/) | 24h | 12h | 4h | 40h |
| DLæ•°æ® (data/) | 12h | 6h | 2h | 20h |
| DLå› å­ (factor/) | 16h | 8h | 3h | 27h |
| DLé¢„æµ‹å™¨ (predictor/) | 16h | 8h | 3h | 27h |
| DLè®­ç»ƒ (trainer/etc) | 16h | 8h | 3h | 27h |
| RLåŸºç¡€ (base/env/memory) | 20h | 10h | 4h | 34h |
| RLä»£ç† (ppo/dqn/ac) | 32h | 16h | 6h | 54h |
| RLå¥–åŠ± (reward/explore) | 12h | 6h | 2h | 20h |
| CVæ¨¡å— | 20h | 10h | 4h | 34h |
| å·¥å…·æ¨¡å— | 12h | 6h | 2h | 20h |
| **æ€»è®¡** | **180h** | **90h** | **33h** | **303h**

---

## Â§12 Phase 7: ä¸­å›½æœŸè´§å¸‚åœºç‰¹åŒ–

### 12.1 æ–‡ä»¶æ¸…å•

| æ–‡ä»¶ | è¡Œæ•° | åŠŸèƒ½ | çŠ¶æ€ |
|------|------|------|------|
| `src/market/exchange_config.py` | ~628 | å…­å¤§äº¤æ˜“æ‰€é…ç½® | âœ… |
| `src/market/trading_calendar.py` | ~250 | å¤œç›˜äº¤æ˜“æ—¥å† | â¸ å¾…æ–°å¢ |
| `src/cost/china_fee_calculator.py` | ~653 | ä¸­å›½æœŸè´§æ‰‹ç»­è´¹ | âœ… |
| `src/execution/protection/limit_price.py` | ~200 | æ¶¨è·Œåœä¿æŠ¤ | â¸ å¾…æ–°å¢ |
| `src/execution/protection/margin_monitor.py` | ~250 | ä¿è¯é‡‘ç›‘æ§ | â¸ å¾…æ–°å¢ |
| `src/guardian/triggers_china.py` | ~300 | ä¸­å›½æœŸè´§è§¦å‘å™¨ | â¸ å¾…æ–°å¢ |
| `src/risk/stress_test_china.py` | ~350 | ä¸­å›½æœŸè´§å‹åŠ›æµ‹è¯• | â¸ å¾…æ–°å¢ |
| `src/strategy/calendar_arb/delivery_aware.py` | ~250 | äº¤å‰²æ„ŸçŸ¥å¥—åˆ© | â¸ å¾…æ–°å¢ |
| `src/compliance/china_futures_rules.py` | ~200 | åˆè§„è§„åˆ™ | â¸ å¾…æ–°å¢ |
| `src/compliance/programmatic_trading.py` | ~300 | ç¨‹åºåŒ–äº¤æ˜“åˆè§„ | â¸ å¾…æ–°å¢ |
|---------|------|------|------|

### 12.2 å…­å¤§äº¤æ˜“æ‰€é…ç½®

```python
class Exchange(Enum):
    """ä¸­å›½å…­å¤§æœŸè´§äº¤æ˜“æ‰€"""

    SHFE = "ä¸Šæµ·æœŸè´§äº¤æ˜“æ‰€"
    DCE = "å¤§è¿å•†å“äº¤æ˜“æ‰€"
    CZCE = "éƒ‘å·å•†å“äº¤æ˜“æ‰€"
    CFFEX = "ä¸­å›½é‡‘èæœŸè´§äº¤æ˜“æ‰€"
    GFEX = "å¹¿å·æœŸè´§äº¤æ˜“æ‰€"
    INE = "ä¸Šæµ·å›½é™…èƒ½æºäº¤æ˜“ä¸­å¿ƒ"


EXCHANGE_CONFIG = {
    Exchange.SHFE: {
        "trading_hours": [
            ("09:00", "10:15"),
            ("10:30", "11:30"),
            ("13:30", "15:00"),
        ],
        "night_session": ("21:00", "02:30"),  # éƒ¨åˆ†å“ç§
        "settlement_time": "15:15",
        "products": ["cu", "al", "zn", "pb", "ni", "sn", "au", "ag", "rb", "hc", "ss", "bu", "ru", "sp", "nr", "ao"],
    },
    Exchange.DCE: {
        "trading_hours": [
            ("09:00", "10:15"),
            ("10:30", "11:30"),
            ("13:30", "15:00"),
        ],
        "night_session": ("21:00", "23:00"),
        "settlement_time": "15:15",
        "products": ["c", "cs", "a", "b", "m", "y", "p", "fb", "bb", "jd", "l", "v", "pp", "j", "jm", "i", "eg", "eb", "pg", "rr", "lh"],
    },
    # ... å…¶ä»–äº¤æ˜“æ‰€
}
```

### 12.3 åœºæ™¯è¦†ç›–

| Rule ID | åœºæ™¯æè¿° | å†›è§„ |
|---------|----------|------|
| `CHINA.EXCHANGE.CONFIG_LOAD` | äº¤æ˜“æ‰€é…ç½®åŠ è½½ | M20 |
| `CHINA.EXCHANGE.PRODUCT_MAP` | å“ç§æ˜ å°„æ­£ç¡® | M20 |
| `CHINA.CALENDAR.NIGHT_SESSION` | å¤œç›˜æ—¶æ®µæ­£ç¡® | M15 |
| `CHINA.CALENDAR.TRADING_DAY` | äº¤æ˜“æ—¥è®¡ç®—æ­£ç¡® | M15 |
| `CHINA.CALENDAR.HOLIDAY` | èŠ‚å‡æ—¥å¤„ç†æ­£ç¡® | M15 |
| `CHINA.FEE.BY_VOLUME_CALC` | æŒ‰æ‰‹æ”¶è´¹è®¡ç®— | M5 |
| `CHINA.FEE.BY_VALUE_CALC` | æŒ‰é‡‘é¢æ”¶è´¹è®¡ç®— | M5 |
| `CHINA.FEE.CLOSE_TODAY_CALC` | å¹³ä»Šæ‰‹ç»­è´¹è®¡ç®— | M14 |
| `CHINA.LIMIT.PRICE_CHECK` | æ¶¨è·Œåœä»·æ ¼æ£€æŸ¥ | M13 |
| `CHINA.LIMIT.ORDER_REJECT` | è¶…é™è®¢å•æ‹’ç» | M13 |
| `CHINA.MARGIN.RATIO_CHECK` | ä¿è¯é‡‘ç‡æ£€æŸ¥ | M16 |
| `CHINA.MARGIN.USAGE_MONITOR` | ä¿è¯é‡‘ä½¿ç”¨ç›‘æ§ | M16 |
| `CHINA.MARGIN.WARNING_LEVEL` | ä¿è¯é‡‘é¢„è­¦ç­‰çº§ | M16 |
| `CHINA.TRIGGER.LIMIT_PRICE` | æ¶¨è·Œåœè§¦å‘å™¨ | M6, M13 |
| `CHINA.TRIGGER.MARGIN_CALL` | ä¿è¯é‡‘è¿½ç¼´è§¦å‘ | M6, M16 |
| `CHINA.TRIGGER.DELIVERY` | äº¤å‰²æœˆæ¥è¿‘è§¦å‘ | M6, M15 |
| `CHINA.STRESS.2015_CRASH` | 2015è‚¡ç¾åœºæ™¯ | M6 |
| `CHINA.STRESS.2020_OIL` | 2020åŸæ²¹è´Ÿä»·åœºæ™¯ | M6 |
| `CHINA.STRESS.2022_LITHIUM` | 2022ç¢³é…¸é”‚åœºæ™¯ | M6 |
| `CHINA.ARB.DELIVERY_AWARE` | äº¤å‰²æ„ŸçŸ¥å¥—åˆ© | M15 |
| `CHINA.ARB.POSITION_TRANSFER` | ç§»ä»“æ¢æœˆé€»è¾‘ | M15 |
| `CHINA.COMPLIANCE.RULE_CHECK` | åˆè§„è§„åˆ™æ£€æŸ¥ | M17 |
| `CHINA.COMPLIANCE.REPORT_FREQUENCY` | æŠ¥æ’¤å•é¢‘ç‡æ£€æŸ¥ | M17 |
| `CHINA.PROGRAMMATIC.ORDER_LIMIT` | ç¨‹åºåŒ–ä¸‹å•é™é¢ | M17 | |
| `CHINA.PROGRAMMATIC.POSITION_LIMIT` | ç¨‹åºåŒ–æŒä»“
|é™é¢ | M17 |
|---------|----------|------|

---

## Â§13 Phase 8: æ™ºèƒ½ç­–ç•¥å‡çº§

### 13.1 æ–‡ä»¶æ¸…å•

| æ–‡ä»¶ | è¡Œæ•° | åŠŸèƒ½ | çŠ¶æ€ |
|------|------|------|------|
| `src/execution/algo/twap.py` | ~200 | TWAPç®—æ³• | â¸ å¾…æ–°å¢ |
| `src/execution/algo/vwap.py` | ~250 | VWAPç®—æ³• | â¸ å¾…æ–°å¢ |
| `src/execution/algo/iceberg.py` | ~200 | å†°å±±å•ç®—æ³• | â¸ å¾…æ–°å¢ |
| `src/execution/algo/adaptive.py` | ~300 | è‡ªé€‚åº”æ‰§è¡Œ | â¸ å¾…æ–°å¢ |
| `src/execution/impact_model.py` | ~200 | å¸‚åœºå†²å‡»æ¨¡å‹ | â¸ å¾…æ–°å¢ |
| `src/compliance/throttle.py` | ~250 | åˆè§„èŠ‚æµå™¨ | â¸ å¾…æ–°å¢ |
| `src/strategy/experimental/maturity_evaluator.py` | ~810 | æˆç†Ÿåº¦è¯„ä¼° | âœ… |
| `src/strategy/experimental/training_gate.py` | ~375 | è®­ç»ƒé—¨ç¦ | âœ… |
| `src/strategy/experimental/training_monitor.py` | ~615 | è®­ç»ƒç›‘æ§ | âœ… |
| `src/strategy/experimental/__init__.py` | ~65 | æ¨¡å—å¯¼å‡º | âœ… |
|---------|------|------|------|

### 13.2 æ‰§è¡Œç®—æ³•è®¾è®¡

#### TWAPç®—æ³•

```python
class TWAPAlgo:
    """æ—¶é—´åŠ æƒå¹³å‡ä»·æ ¼ç®—æ³•"""

    def __init__(
        self,
        total_volume: int,
        duration_minutes: int,
        interval_seconds: int = 60,
    ):
        self.total_volume = total_volume
        self.duration_minutes = duration_minutes
        self.interval_seconds = interval_seconds
        self.slice_count = duration_minutes * 60 // interval_seconds
        self.slice_volume = total_volume // self.slice_count

    def get_next_slice(self) -> OrderSlice:
        """è·å–ä¸‹ä¸€ä¸ªåˆ‡ç‰‡è®¢å•"""
        # ...
```

#### VWAPç®—æ³•

```python
class VWAPAlgo:
    """æˆäº¤é‡åŠ æƒå¹³å‡ä»·æ ¼ç®—æ³•"""

    def __init__(
        self,
        total_volume: int,
        volume_profile: list[float],  # å†å²æˆäº¤é‡åˆ†å¸ƒ
        start_time: str,
        end_time: str,
    ):
        self.total_volume = total_volume
        self.volume_profile = volume_profile
        self.start_time = start_time
        self.end_time = end_time
        self.current_index = 0
        self.slice_volumes = [
            int(total_volume * vp) for vp in volume_profile
        ]

    def get_next_slice(self, current_time: str) -> OrderSlice:
        """æ ¹æ®æˆäº¤é‡åˆ†å¸ƒè·å–ä¸‹ä¸€ä¸ªåˆ‡ç‰‡è®¢å•"""
        # ...
```

### 13.3 åˆè§„èŠ‚æµå™¨

```python
class ComplianceThrottle:
    """åˆè§„èŠ‚æµå™¨ (2025å¹´æ–°è§„)"""

    # ç›‘ç®¡é˜ˆå€¼
    REPORT_CANCEL_LIMIT_5S = 50    # 5ç§’å†…æŠ¥æ’¤å•ä¸Šé™
    HIGH_FREQ_LIMIT_PER_SEC = 300  # é«˜é¢‘äº¤æ˜“é˜ˆå€¼ (ç¬”/ç§’)
    HIGH_FREQ_LIMIT_DAILY = 20000  # é«˜é¢‘äº¤æ˜“é˜ˆå€¼ (ç¬”/æ—¥)
    HIGH_FREQ_LIMIT_PER_MIN = 18000  # é«˜é¢‘äº¤æ˜“é˜ˆå€¼ (ç¬”/åˆ†)

    def __init__(self):
        self._order_history: deque = deque(maxlen=10000)
        self._5s_window: deque = deque()
        self._1min_window: deque = deque()
        self._daily_count: int = 0

    def can_submit(self) -> tuple[bool, str]:
        """æ£€æŸ¥æ˜¯å¦å¯ä»¥æäº¤è®¢å•"""
        # æ£€æŸ¥5ç§’çª—å£
        now = time.time()
        while self._5s_window and now - self._5s_window[0] > 5:
            self._5s_window.popleft()

        # æ£€æŸ¥1åˆ†é’Ÿçª—å£
        while self._1min_window and now - self._1min_window[0] > 60:
            self._1min_window.popleft()
        if len(self._5s_window) >= self.REPORT_CANCEL_LIMIT_5S:
            return False, "5ç§’æŠ¥æ’¤å•é¢‘ç‡è¶…é™"
        if len(self._1min_window) >= self.HIGH_FREQ_LIMIT_PER_MIN:
            return False, "1åˆ†é’Ÿé«˜é¢‘äº¤æ˜“é¢‘ç‡è¶…é™"

        # æ£€æŸ¥æ—¥å†…æ€»é‡
        # è¿™é‡Œå‡è®¾æœ‰ä¸€ä¸ªæ–¹æ³•æˆ–æœºåˆ¶æ¥æ›´æ–°_daily_count
        # ä¾‹å¦‚ï¼Œæ¯æ¬¡æäº¤è®¢å•æ—¶è°ƒç”¨ self._daily_count += 1
        self._5s_window.append(now)        self._1min_window.append(now)
        self._daily_count += 1

        if self._daily_count >= self.HIGH_FREQ_LIMIT_DAILY:
            return False, "æ—¥å†…æŠ¥æ’¤å•æ€»é‡è¶…é™"

        return True, ""
```

### 13.4 åœºæ™¯è¦†ç›–

| Rule ID | åœºæ™¯æè¿° | å†›è§„ |
|---------|----------|------|
| `ALGO.TWAP.SLICE_CALC` | TWAPåˆ‡ç‰‡è®¡ç®— | M5 |
| `ALGO.TWAP.TIME_DISTRIBUTE` | TWAPæ—¶é—´åˆ†å¸ƒ | M5 |
| `ALGO.VWAP.VOLUME_PROFILE` | VWAPæˆäº¤é‡åˆ†å¸ƒ | M5 |
| `ALGO.VWAP.PARTICIPATION` | VWAPå‚ä¸ç‡æ§åˆ¶ | M5 |
| `ALGO.ICEBERG.DISPLAY_SIZE` | å†°å±±å•æ˜¾ç¤ºé‡ | M5 |
| `ALGO.ICEBERG.REFRESH` | å†°å±±å•åˆ·æ–°é€»è¾‘ | M5 |
| `ALGO.ADAPTIVE.MARKET_STATE` | è‡ªé€‚åº”å¸‚åœºçŠ¶æ€ | M5 |
| `ALGO.ADAPTIVE.STRATEGY_SWITCH` | è‡ªé€‚åº”ç­–ç•¥åˆ‡æ¢ | M4 |
| `ALGO.IMPACT.ALMGREN_CHRISS` | Almgren-Chrissæ¨¡å‹ | M5 |
| `ALGO.IMPACT.TEMPORARY` | ä¸´æ—¶å†²å‡»è®¡ç®— | M5 |
| `ALGO.IMPACT.PERMANENT` | æ°¸ä¹…å†²å‡»è®¡ç®— | M5 |
| `THROTTLE.5S_LIMIT` | 5ç§’é™åˆ¶æ£€æŸ¥ | M17 |
| `THROTTLE.DAILY_LIMIT` | æ—¥å†…é™åˆ¶æ£€æŸ¥ | M17 |
| `THROTTLE.HIGH_FREQ_DETECT` | é«˜é¢‘æ£€æµ‹ | M17 |
| `THROTTLE.WARNING_LEVEL` | é¢„è­¦ç­‰çº§ | M17 |
| `EXP.MATURITY.80_THRESHOLD` | 80%æˆç†Ÿåº¦é—¨æ§› | M18 |
| `EXP.MATURITY.60_DIMENSION` | 60%ç»´åº¦é—¨æ§› | M18 |
| `EXP.MATURITY.90_DAYS` | 90å¤©æœ€ä½è®­ç»ƒ | M18 |
| `EXP.GATE.NO_BYPASS` | ç¦æ­¢ç»•è¿‡é—¨ç¦ | M18 |
| `EXP.GATE.MANUAL_APPROVAL` | éœ€äººå·¥å®¡æ‰¹ | M12, M18 |
| `EXP.MONITOR.PROGRESS` | è¿›åº¦ç›‘æ§æ­£ç¡® | M18 |
| `EXP.MONITOR.ALERT` | å‘Šè­¦ç”Ÿæˆæ­£ç¡® | M9 |
|---------|----------|------|

---

## Â§14 Phase 9: åˆè§„ä¸ç›‘æ§

### 14.1 æ–‡ä»¶æ¸…å•

| æ–‡ä»¶ | è¡Œæ•° | åŠŸèƒ½ | çŠ¶æ€ |
|------|------|------|------|
| `src/compliance/china_futures_rules.py` | ~200 | ä¸­å›½æœŸè´§åˆè§„è§„åˆ™ | â¸ å¾…æ–°å¢ |
| `src/compliance/programmatic_trading.py` | ~300 | ç¨‹åºåŒ–äº¤æ˜“åˆè§„ | â¸ å¾…æ–°å¢ |
| `src/compliance/throttle.py` | ~250 | åˆè§„èŠ‚æµå™¨ | â¸ å¾…æ–°å¢ |
| `src/compliance/algo_registration.py` | ~200 | ç®—æ³•å¤‡æ¡ˆ | â¸ å¾…æ–°å¢ |
| `src/monitoring/health.py` | ~220 | å¥åº·æ£€æŸ¥ | âœ… |
| `src/monitoring/metrics.py` | ~328 | PrometheusæŒ‡æ ‡ | âœ… |
| `src/monitoring/alerts.py` | ~250 | å‘Šè­¦ç®¡ç† | âœ… |
|---------|------|------|------|

### 14.2 2025å¹´ç¨‹åºåŒ–äº¤æ˜“æ–°è§„

```
ã€ŠæœŸè´§å¸‚åœºç¨‹åºåŒ–äº¤æ˜“ç®¡ç†è§„å®šï¼ˆè¯•è¡Œï¼‰ã€‹(2025å¹´10æœˆ9æ—¥å®æ–½)

æ ¸å¿ƒè¦æ±‚ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 1. å¤‡æ¡ˆè¦æ±‚ï¼šå®¢æˆ·éœ€å‘æœŸè´§å…¬å¸æŠ¥å‘Šï¼Œç»äº¤æ˜“æ‰€ç¡®è®¤åæ–¹å¯ä»äº‹ç¨‹åºåŒ–äº¤æ˜“ â”‚
â”‚ 2. æŠ€æœ¯ç³»ç»Ÿï¼šå¼‚å¸¸ç›‘æµ‹ã€é˜ˆå€¼ç®¡ç†ã€é”™è¯¯é˜²èŒƒã€åº”æ€¥å¤„ç½®                  â”‚
â”‚ 3. ç®—æ³•å¤‡æ¡ˆï¼šç­–ç•¥ç±»å‹+å†å²å›æµ‹+é£é™©å‚æ•°ä¸‰ä½ä¸€ä½“                      â”‚
â”‚ 4. å‹åŠ›æµ‹è¯•ï¼šæ¯æœˆæç«¯è¡Œæƒ…æ¨¡æ‹Ÿ (åŸæ²¹è·³ç©º10%ç­‰)                        â”‚
â”‚ 5. äººå·¥å¤æ ¸ï¼šå¤§é¢è®¢å•â‰¤30ç§’äºŒæ¬¡ç¡®è®¤                                   â”‚
â”‚ 6. æŠ¥æ’¤å•é¢‘ç‡ï¼š5ç§’50ç¬”é¢„è­¦é˜ˆå€¼                                       â”‚
â”‚ 7. é«˜é¢‘äº¤æ˜“å®šä¹‰ï¼šå•è´¦æˆ·æ¯ç§’â‰¥300ç¬” æˆ– å•æ—¥â‰¥20000ç¬”                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 14.3 åœºæ™¯è¦†ç›–

| Rule ID | åœºæ™¯æè¿° | å†›è§„ |
|---------|----------|------|
| `COMPLIANCE.REGISTRATION` | ç¨‹åºåŒ–äº¤æ˜“å¤‡æ¡ˆ | M17 |
| `COMPLIANCE.ALGO_RECORD` | ç®—æ³•å¤‡æ¡ˆè®°å½• | M17 |
| `COMPLIANCE.REPORT_CANCEL` | æŠ¥æ’¤å•é¢‘ç‡ç›‘æ§ | M17 |
| `COMPLIANCE.HIGH_FREQ_DETECT` | é«˜é¢‘äº¤æ˜“æ£€æµ‹ | M17 |
| `COMPLIANCE.LARGE_ORDER` | å¤§é¢è®¢å•å¤æ ¸ | M12, M17 |
| `COMPLIANCE.STRESS_TEST` | å‹åŠ›æµ‹è¯•æ‰§è¡Œ | M6, M17 |
| `COMPLIANCE.EMERGENCY_STOP` | ç´§æ€¥åœæ­¢æœºåˆ¶ | M6, M17 |
| `MONITOR.HEALTH.CHECK` | å¥åº·æ£€æŸ¥æ‰§è¡Œ | M9 |
| `MONITOR.HEALTH.COMPONENT` | ç»„ä»¶çŠ¶æ€ç›‘æ§ | M9 |
| `MONITOR.HEALTH.DEGRADED` | é™çº§çŠ¶æ€æ£€æµ‹ | M4, M9 |
| `MONITOR.METRICS.COUNTER` | è®¡æ•°å™¨æŒ‡æ ‡ | M9 |
| `MONITOR.METRICS.GAUGE` | ä»ªè¡¨ç›˜æŒ‡æ ‡ | M9 |
| `MONITOR.METRICS.HISTOGRAM` | ç›´æ–¹å›¾æŒ‡æ ‡ | M9 |
| `MONITOR.METRICS.PROMETHEUS` | Prometheuså¯¼å‡º | M9 |
| `MONITOR.ALERT.THRESHOLD` | é˜ˆå€¼å‘Šè­¦ | M9 |
| `MONITOR.ALERT.CHANNEL` | å‘Šè­¦æ¸ é“ | M9 |
|---------|----------|------|

---

## Â§15 Phase 10: ç»„åˆä¸é£æ§å¢å¼º

### 15.1 æ–‡ä»¶æ¸…å•

| æ–‡ä»¶ | è¡Œæ•° | åŠŸèƒ½ | çŠ¶æ€ |
|------|------|------|------|
| `src/portfolio/manager.py` | ~318 | ç»„åˆç®¡ç†å™¨ | âœ… |
| `src/portfolio/analytics.py` | ~268 | ç»„åˆåˆ†æ | âœ… |
| `src/portfolio/aggregator.py` | ~216 | æŒä»“èšåˆ | âœ… |
| `src/portfolio/__init__.py` | ~30 | æ¨¡å—å¯¼å‡º | âœ… |
| `src/risk/var_calculator.py` | ~362 | VaRè®¡ç®—å™¨ | âœ… |
| `src/risk/var_enhanced.py` | ~400 | å¢å¼ºVaR | â¸ å¾…æ–°å¢ |
| `src/risk/attribution.py` | ~300 | é£é™©å½’å›  | â¸ å¾…æ–°å¢ |
|---------|------|------|------|

### 15.2 VaRå¢å¼ºæ–¹æ³•

```python
class EnhancedVaRCalculator(VaRCalculator):
    """å¢å¼ºVaRè®¡ç®—å™¨ (ä¸­å›½æœŸè´§å¸‚åœºç‰¹åŒ–)"""

    def evt_var(
        self,
        returns: list[float],
        confidence: float = 0.99,
        threshold_pct: float = 0.95,
    ) -> VaRResult:
        """æå€¼ç†è®ºVaR (POT + GPD)"""
        # ...

    def semiparametric_var(
        self,
        returns: list[float],
        confidence: float = 0.99,
    ) -> VaRResult:
        """åŠå‚æ•°VaR (æ ¸å¯†åº¦ + GPD)"""
        # ...

    def limit_adjusted_var(
        self,
        returns: list[float],
        limit_pct: float,
        confidence: float = 0.99,
    ) -> VaRResult:
        """æ¶¨è·Œåœè°ƒæ•´VaR"""
        # ...

    def liquidity_adjusted_var(
        self,
        returns: list[float],
        position_value: float,
        adv: float,  # å¹³å‡æ—¥æˆäº¤é‡
        confidence: float = 0.99,
    ) -> VaRResult:
        """æµåŠ¨æ€§è°ƒæ•´VaR"""
        # ...
```

### 15.3 åœºæ™¯è¦†ç›–

| Rule ID | åœºæ™¯æè¿° | å†›è§„ |
|---------|----------|------|
| `PORTFOLIO.POSITION.UPDATE` | æŒä»“æ›´æ–°æ­£ç¡® | M1 |
| `PORTFOLIO.POSITION.LIMIT` | æŒä»“é™é¢æ£€æŸ¥ | M6 |
| `PORTFOLIO.POSITION.NET` | å‡€æŒä»“è®¡ç®— | M1 |
| `PORTFOLIO.RISK.EXPOSURE` | é£é™©æ•å£è®¡ç®— | M6 |
| `PORTFOLIO.RISK.CONCENTRATION` | é›†ä¸­åº¦è®¡ç®— | M6 |
| `PORTFOLIO.PNL.ATTRIBUTION` | ç›ˆäºå½’å›  | M19 |
| `PORTFOLIO.SHARPE.CALCULATE` | å¤æ™®æ¯”ç‡è®¡ç®— | M19 |
| `PORTFOLIO.DRAWDOWN.MAX` | æœ€å¤§å›æ’¤è®¡ç®— | M6 |
| `PORTFOLIO.SNAPSHOT.TIMESERIES` | æ—¶åºå¿«ç…§ | M3 |
| `VAR.HISTORICAL.PERCENTILE` | å†å²VaRè®¡ç®— | M6 |
| `VAR.PARAMETRIC.NORMAL` | å‚æ•°VaRè®¡ç®— | M6 |
| `VAR.MONTECARLO.SIMULATION` | è’™ç‰¹å¡æ´›VaR | M6 |
| `VAR.ES.CALCULATE` | ES/CVaRè®¡ç®— | M6 |
| `VAR.EVT.GPD` | EVT-GPDæ–¹æ³• | M6 |
| `VAR.SEMIPARAMETRIC.KERNEL` | åŠå‚æ•°æ–¹æ³• | M6 |
| `VAR.LIMIT_ADJUSTED` | æ¶¨è·Œåœè°ƒæ•´ | M6, M13 |
| `VAR.LIQUIDITY_ADJUSTED` | æµåŠ¨æ€§è°ƒæ•´ | M6 |
| `RISK.ATTRIBUTION.FACTOR` | å› å­å½’å›  | M19 |
| `RISK.ATTRIBUTION.STRATEGY` | ç­–ç•¥å½’å›  | M19 |
| `RISK.ATTRIBUTION.POSITION` | æŒä»“å½’å›  | M19 |
| `RISK.BREACH.DETECT` | é£é™©çªç ´æ£€æµ‹ | M6 |
| `RISK.BREACH.ACTION` | é£é™©çªç ´åŠ¨ä½œ | M6 |
| `RISK.STRESS.SCENARIO` | å‹åŠ›æµ‹è¯•åœºæ™¯ | M6 |
| `RISK.STRESS.RESULT` | å‹åŠ›æµ‹è¯•ç»“æœ | M6 |
| `RISK.KILLSWITCH.TRIGGER` | ç†”æ–­è§¦å‘ | M6 |
|---------|----------|------|

---

## Â§16 å…­å¤§äº¤æ˜“æ‰€é…ç½®

### 16.1 äº¤æ˜“æ‰€åŸºæœ¬ä¿¡æ¯

| äº¤æ˜“æ‰€ | ä»£ç  | æˆç«‹æ—¶é—´ | ä¸»è¦å“ç§ | äº¤æ˜“æ—¶æ®µ |
|--------|------|----------|----------|----------|
| ä¸Šæµ·æœŸè´§äº¤æ˜“æ‰€ | SHFE | 1999 | é‡‘å±ã€èƒ½åŒ– | æ—¥ç›˜+å¤œç›˜ |
| å¤§è¿å•†å“äº¤æ˜“æ‰€ | DCE | 1993 | å†œäº§å“ã€åŒ–å·¥ | æ—¥ç›˜+å¤œç›˜ |
| éƒ‘å·å•†å“äº¤æ˜“æ‰€ | CZCE | 1990 | å†œäº§å“ã€åŒ–å·¥ | æ—¥ç›˜+å¤œç›˜ |
| ä¸­å›½é‡‘èæœŸè´§äº¤æ˜“æ‰€ | CFFEX | 2006 | è‚¡æŒ‡ã€å›½å€º | ä»…æ—¥ç›˜ |
| å¹¿å·æœŸè´§äº¤æ˜“æ‰€ | GFEX | 2021 | ç¢³é…¸é”‚ã€å·¥ä¸šç¡… | æ—¥ç›˜+å¤œç›˜ |
| ä¸Šæµ·å›½é™…èƒ½æºäº¤æ˜“ä¸­å¿ƒ | INE | 2013 | åŸæ²¹ã€ä½ç¡«ç‡ƒæ–™æ²¹ | æ—¥ç›˜+å¤œç›˜ |
|--------|------|----------|----------|----------|

### 16.2 å“ç§åˆ†ç±»

```python
PRODUCT_CATEGORIES = {
    "é‡‘å±": {
        "SHFE": ["cu", "al", "zn", "pb", "ni", "sn", "ao"],
        "GFEX": ["si"],
    },
    "è´µé‡‘å±": {
        "SHFE": ["au", "ag"],
    },
    "é»‘è‰²ç³»": {
        "SHFE": ["rb", "hc", "ss"],
        "DCE": ["i", "j", "jm"],
    },
    "èƒ½æºåŒ–å·¥": {
        "SHFE": ["bu", "ru", "sp", "nr"],
        "DCE": ["l", "v", "pp", "eg", "eb", "pg"],
        "CZCE": ["MA", "TA", "SA", "UR", "PF"],
        "INE": ["sc", "lu", "bc"],
    },
    "å†œäº§å“": {
        "DCE": ["c", "cs", "a", "b", "m", "y", "p", "jd", "lh", "rr"],
        "CZCE": ["WH", "RI", "PM", "CF", "SR", "OI", "RM", "RS", "AP", "CJ", "PK"],
    },
    "é‡‘è": {
        "CFFEX": ["IF", "IH", "IC", "IM", "T", "TF", "TS"],
    },
    "æ–°èƒ½æº": {
        "GFEX": ["lc"],  # ç¢³é…¸é”‚
    },
    "å›½å€º": {
        "CFFEX": ["T", "TF", "TS"],
    },
}
```

---

## Â§17 äº¤æ˜“æ—¶æ®µä¸å¤œç›˜è§„åˆ™

### 17.1 æ—¥ç›˜äº¤æ˜“æ—¶æ®µ

| æ—¶æ®µ | æ—¶é—´ | è¯´æ˜ |
|------|------|------|
| æ—©ç›˜ç¬¬ä¸€èŠ‚ | 09:00 - 10:15 | 75åˆ†é’Ÿ |
| æ—©ç›˜ä¼‘æ¯ | 10:15 - 10:30 | 15åˆ†é’Ÿ |
| æ—©ç›˜ç¬¬äºŒèŠ‚ | 10:30 - 11:30 | 60åˆ†é’Ÿ |
| åˆä¼‘ | 11:30 - 13:30 | 120åˆ†é’Ÿ |
| åˆç›˜ | 13:30 - 15:00 | 90åˆ†é’Ÿ |
|------|------|------|

### 17.2 å¤œç›˜äº¤æ˜“æ—¶æ®µ

| ç»“æŸæ—¶é—´ | å“ç§ | äº¤æ˜“æ‰€ |
|----------|------|--------|
| 23:00 | å†œäº§å“ã€è½¯å•†å“ | DCE, CZCE |
| 01:00 | é»‘è‰²ç³»ã€èƒ½åŒ– | SHFE, DCE, CZCE |
| 02:30 | è´µé‡‘å±ã€æœ‰è‰²é‡‘å± | SHFE |
| æ— å¤œç›˜ | è‚¡æŒ‡ã€å›½å€º | CFFEX |
| 02:30 | ç¢³é…¸é”‚ã€å·¥ä¸šç¡… | GFEX |
| 02:30 | åŸæ²¹ã€ä½ç¡«ç‡ƒæ–™æ²¹ | INE |
|----------|------|--------|

### 17.3 å¤œç›˜äº¤æ˜“æ—¥å½’å±

```
å¤œç›˜äº¤æ˜“æ—¥å½’å±è§„åˆ™ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ å‘¨ä¸€å¤œç›˜ 21:00 â†’ å‘¨äºŒ 02:30 å½’å±äº å‘¨äºŒäº¤æ˜“æ—¥                        â”‚
â”‚ å‘¨äº”å¤œç›˜ æ—  (å‘¨äº”æ²¡æœ‰å¤œç›˜)                                           â”‚
â”‚ èŠ‚å‡æ—¥å‰ä¸€å¤© æ— å¤œç›˜                                                  â”‚
â”‚ èŠ‚å‡æ—¥åç¬¬ä¸€å¤© ä»æ—¥ç›˜å¼€å§‹                                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Â§18 æ¶¨è·Œåœæ¿è§„åˆ™

### 18.1 æ¶¨è·Œåœå¹…åº¦

| å“ç§ç±»å‹ | æ—¥å¸¸å¹…åº¦ | è¿ç»­æ¶¨è·Œåœå | äº¤å‰²æœˆ |
|----------|----------|--------------|--------|
| è‚¡æŒ‡æœŸè´§ | Â±10% | Â±15% | Â±20% |
| å›½å€ºæœŸè´§ | Â±2% | Â±3% | - |
| å•†å“æœŸè´§ | 3%-8% | +2% | +3% |
| è´µé‡‘å± | 6%-8% | +4% | - |
| èƒ½åŒ– | 5%-9% | +3% | +4% |
| å†œäº§å“ | 4%-7% | +3% | +4% |
| é»‘è‰²ç³» | 5%-8% | +3% | +4% |
| æœ‰è‰²é‡‘å± | 6%-10% | +4% | - |
| æ–°èƒ½æº | 8%-13% | +5% | - |
|----------|----------|--------------|--------|

### 18.2 2025å¹´æ˜¥èŠ‚æœŸé—´è°ƒæ•´ (ç¤ºä¾‹)

| å“ç§ | æ¶¨è·Œåœå¹…åº¦ | æŠ•æœºä¿è¯é‡‘ç‡ |
|------|------------|--------------|
| é“œ/é“/é”Œ/é“… | 10% | 12% |
| é•/é”¡/æ°§åŒ–é“ | 13% | 15% |
| é‡‘/é“¶ | 13% | 15% |
| èºçº¹é’¢/çƒ­å· | 8% | 10% |
| å¤©ç„¶æ©¡èƒ¶/çº¸æµ† | 9% | 11% |
| åŸæ²¹/ä½ç¡«ç‡ƒæ–™æ²¹ | 12% | 14% |
| è±†ç²•/ç‰ç±³/æ£‰èŠ± | 7% | 9
| |---------|------------|--------------|

### 18.3 æ¶¨è·Œåœä»·æ ¼æ£€æŸ¥

```python
def check_limit_price(
    order_price: float,
    instrument: InstrumentInfo,
    last_settle: float,
) -> tuple[bool, str]:
    """æ£€æŸ¥è®¢å•ä»·æ ¼æ˜¯å¦åœ¨æ¶¨è·ŒåœèŒƒå›´å†…"""

    limit_up = last_settle * (1 + instrument.price_limit_pct)
    limit_down = last_settle * (1 - instrument.price_limit_pct)

    if order_price > limit_up:
        return False, f"è®¢å•ä»·æ ¼ {order_price} è¶…è¿‡æ¶¨åœä»· {limit_up}"

    if order_price < limit_down:
        return False, f"è®¢å•ä»·æ ¼ {order_price} ä½äºè·Œåœä»· {limit_down}"

    return True, ""
```

---

## Â§19 ä¿è¯é‡‘åˆ¶åº¦

### 19.1 ä¿è¯é‡‘ç±»å‹

| ç±»å‹ | è¯´æ˜ |
|------|------|
| äº¤æ˜“ä¿è¯é‡‘ | å¼€ä»“æ—¶ç¼´çº³ï¼Œç»´æŒæŒä»“ |
| ç»“ç®—ä¿è¯é‡‘ | ç»“ç®—æ—¶è°ƒæ•´ |
| è¿½åŠ ä¿è¯é‡‘ | æƒç›Šä¸è¶³æ—¶è¿½ç¼´ |
| æŠ•æœºä¿è¯é‡‘ | æŠ•æœºäº¤æ˜“çš„ä¿è¯é‡‘è¦æ±‚ |
| å¥—ä¿ä¿è¯é‡‘ | å¥—æœŸä¿å€¼äº¤æ˜“çš„ä¿è¯é‡‘è¦æ±‚ |
|------|------|

### 19.2 ä¿è¯é‡‘æ°´å¹³

```python
class MarginLevel(Enum):
    """ä¿è¯é‡‘ä½¿ç”¨ç‡ç­‰çº§"""

    SAFE = "å®‰å…¨"       # < 50%
    NORMAL = "æ­£å¸¸"     # 50% - 70%
    WARNING = "é¢„è­¦"    # 70% - 85%
    DANGER = "å±é™©"     # 85% - 100%
    CRITICAL = "ä¸´ç•Œ"   # >= 100% (è§¦å‘å¼ºå¹³)
```

### 19.3 ä¿è¯é‡‘ç›‘æ§

```python
class MarginMonitor:
    """ä¿è¯é‡‘ç›‘æ§å™¨ (å†›è§„ M16)"""

    def __init__(self, config: MarginConfig):
        self.config = config
        self._usage_ratio: float = 0.0
        self._level: MarginLevel = MarginLevel.SAFE

    def update(
        self,
        equity: float,
        margin_used: float,
    ) -> MarginLevel:
        """æ›´æ–°ä¿è¯é‡‘ä½¿ç”¨ç‡"""
        self._usage_ratio = margin_used / equity if equity > 0 else 1.0
        self._level = self._calculate_level()
        return self._level

    def _calculate_level(self) -> MarginLevel:
        """è®¡ç®—ä¿è¯é‡‘ç­‰çº§"""
        if self._usage_ratio < 0.5:
            return MarginLevel.SAFE
        elif self._usage_ratio < 0.7:
            return MarginLevel.NORMAL
        elif self._usage_ratio < 0.85:
            return MarginLevel.WARNING
        elif self._usage_ratio < 1.0:
            return MarginLevel.DANGER
        else:
            return MarginLevel.CRITICAL
```

---

## Â§20 æ‰‹ç»­è´¹ç»“æ„

### 20.1 æ‰‹ç»­è´¹ç±»å‹

| ç±»å‹ | è®¡ç®—æ–¹å¼ | ç¤ºä¾‹ |
|------|----------|------|
| æŒ‰é‡‘é¢ | æˆäº¤é‡‘é¢ Ã— è´¹ç‡ | é“œ: 0.5â€± |
| æŒ‰æ‰‹ | æˆäº¤æ‰‹æ•° Ã— å›ºå®šè´¹ç”¨ | èºçº¹é’¢: 1å…ƒ/æ‰‹ |
| æ··åˆ | ä¸¤è€…å–é«˜ | éƒ¨åˆ†å“ç§ |
|------|----------|------|

### 20.2 å¹³ä»Šæ‰‹ç»­è´¹

| äº¤æ˜“æ‰€ | å¹³ä»Šæ”¿ç­– | å€æ•° |
|--------|----------|------|
| SHFE | éƒ¨åˆ†å“ç§å…æ”¶ | 0-3å€ |
| DCE | æ­£å¸¸æ”¶å– | 1å€ |
| CZCE | åŠ å€æ”¶å– | 1-3å€ |
| CFFEX | å¤§å¹…åŠ å€ | 15å€ |
| GFEX | åŠ å€æ”¶å– | 3-6å€ |
| INE | éƒ¨åˆ†å…æ”¶ | 0-1å€ |
|--------|----------|------|

### 20.3 æ‰‹ç»­è´¹è®¡ç®—å™¨

```python
class ChinaFeeCalculator:
    """ä¸­å›½æœŸè´§æ‰‹ç»­è´¹è®¡ç®—å™¨"""

    def calculate(
        self,
        instrument: InstrumentInfo,
        price: float,
        volume: int,
        direction: str,  # "OPEN" | "CLOSE" | "CLOSE_TODAY"
    ) -> float:
        """è®¡ç®—æ‰‹ç»­è´¹"""

        if instrument.fee_type == "ratio":
            # æŒ‰é‡‘é¢
            value = price * instrument.multiplier * volume
            if direction == "OPEN":
                return value * instrument.fee_open_ratio
            elif direction == "CLOSE":
                return value * instrument.fee_close_ratio
            else:  # CLOSE_TODAY
                return value * instrument.fee_close_today_ratio

        elif instrument.fee_type == "fixed":
            # æŒ‰æ‰‹
            if direction == "OPEN":
                return instrument.fee_open_fixed * volume
            elif direction == "CLOSE":
                return instrument.fee_close_fixed * volume
            else:
                return instrument.fee_close_today_fixed * volume

        else:
            # æ··åˆ: å–ä¸¤è€…è¾ƒé«˜å€¼

            fee_by_value = self.calculate(
                instrument, price, volume, direction
            )
            fee_by_fixed = self.calculate(
                instrument, price, volume, direction
            )
            return max(fee_by_value, fee_by_fixed)


```

---

## Â§21 ç¨‹åºåŒ–äº¤æ˜“åˆè§„

### 21.1 2025å¹´æ–°è§„è¦ç‚¹

| è¦æ±‚ | æè¿° | ç³»ç»Ÿå®ç° |
|------|------|----------|
| å¤‡æ¡ˆ | å‘æœŸè´§å…¬å¸æŠ¥å‘Š | ç®—æ³•å¤‡æ¡ˆæ¨¡å— |
| é˜ˆå€¼ç®¡ç† | æŠ¥æ’¤å•é¢‘ç‡ç›‘æ§ | åˆè§„èŠ‚æµå™¨ |
| å‹åŠ›æµ‹è¯• | æ¯æœˆæç«¯è¡Œæƒ…æ¨¡æ‹Ÿ | å‹åŠ›æµ‹è¯•æ¨¡å— |
| äººå·¥å¤æ ¸ | å¤§é¢è®¢å•ç¡®è®¤ | åŒé‡ç¡®è®¤æœºåˆ¶ |
| åº”æ€¥å¤„ç½® | ç†”æ–­æœºåˆ¶ | é£æ§ç†”æ–­ |
| é”™è¯¯é˜²èŒƒ | é˜²æ­¢ä¸‹å•é”™è¯¯ | ä¸‹å•æ ¡éªŒ |
|------|------|----------|

### 21.2 é«˜é¢‘äº¤æ˜“åˆ¤å®š

```
é«˜é¢‘äº¤æ˜“åˆ¤å®šæ ‡å‡† (2025å¹´7æœˆ7æ—¥å®æ–½):
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ¡ä»¶1: å•è´¦æˆ·æ¯ç§’æŠ¥æ’¤å• â‰¥ 300 ç¬”                                     â”‚
â”‚ æ¡ä»¶2: å•è´¦æˆ·å•æ—¥æŠ¥æ’¤å• â‰¥ 20000 ç¬”                                   â”‚
â”‚ æ»¡è¶³ä»»ä¸€æ¡ä»¶å³åˆ¤å®šä¸ºé«˜é¢‘äº¤æ˜“                                         â”‚
â”‚ é«˜é¢‘äº¤æ˜“è€…éœ€ç¼´çº³æ›´é«˜æ‰‹ç»­è´¹                                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 21.3 æŠ¥æ’¤å•é¢‘ç‡é¢„è­¦

```python
THROTTLE_LEVELS = {
    ThrottleLevel.NORMAL: {
        "5s_limit": 30,
        "daily_limit": 15000,
        "action": "æ­£å¸¸äº¤æ˜“",
    },
    ThrottleLevel.WARNING: {
        "5s_limit": 40,
        "daily_limit": 18000,
        "action": "å‘é€é¢„è­¦ï¼Œé™ä½é¢‘ç‡",
    },
    ThrottleLevel.DANGER: {
        "5s_limit": 45,
        "daily_limit": 19000,
        "action": "é™åˆ¶æ–°è®¢å•ï¼Œå®¡æŸ¥äº¤æ˜“è¡Œä¸º",
    },
    ThrottleLevel.CRITICAL: {
        "5s_limit": 48,
        "daily_limit": 19500,
        "action": "æš‚åœæ–°å¼€ä»“",
    },
    ThrottleLevel.EXCEEDED: {
        "5s_limit": 50,
        "daily_limit": 20000,
        "action": "åœæ­¢æ‰€æœ‰æŠ¥æ’¤å•",
    },
}
```

---

## Â§22 VaRé£æ§å¢å¼º

### 22.1 å½“å‰VaRæ–¹æ³•

| æ–¹æ³• | ä¼˜ç‚¹ | ç¼ºç‚¹ | é€‚ç”¨åœºæ™¯ |
|------|------|------|----------|
| å†å²æ¨¡æ‹Ÿæ³• | ç®€å•ç›´è§‚ | ä¾èµ–å†å² | ä¸€èˆ¬å¸‚åœº |
| å‚æ•°æ³• | è®¡ç®—å¿«é€Ÿ | å‡è®¾æ­£æ€ | å¿«é€Ÿä¼°è®¡ |
| è’™ç‰¹å¡æ´›æ³• | çµæ´»å‡†ç¡® | è®¡ç®—æ…¢ | å¤æ‚ç»„åˆ |
|------|------|------|----------|

### 22.2 å¢å¼ºVaRæ–¹æ³• (å¾…æ–°å¢)

| æ–¹æ³• | æè¿° | é€‚ç”¨åœºæ™¯ |
|------|------|----------|
| EVT (æå€¼ç†è®º) | POT + GPDåˆ†å¸ƒ | æç«¯é£é™© |
| åŠå‚æ•°æ³• | æ ¸å¯†åº¦ + GPD | åšå°¾åˆ†å¸ƒ |
| æ¶¨è·Œåœè°ƒæ•´ | æˆªæ–­æ•ˆåº”ä¿®æ­£ | ä¸­å›½æœŸè´§ |
| æµåŠ¨æ€§è°ƒæ•´ | å¹³ä»“æˆæœ¬å»ºæ¨¡ | å¤§é¢å¤´å¯¸ |
|------|------|----------|

### 22.3 EVT-GPDå®ç°

```python
def evt_var(
    self,
    returns: list[float],
    confidence: float = 0.99,
    threshold_pct: float = 0.95,
) -> VaRResult:
    """æå€¼ç†è®ºVaR (POT + GPDæ–¹æ³•)"""

    # 1. ç¡®å®šé˜ˆå€¼ (ç¬¬95ç™¾åˆ†ä½)
    sorted_returns = sorted(returns)
    threshold_idx = int(len(sorted_returns) * threshold_pct)
    threshold = sorted_returns[threshold_idx]

    # 2. æå–è¶…é˜ˆå€¼æ ·æœ¬
    exceedances = [r - threshold for r in returns if r < threshold]

    if len(exceedances) < 30:
        # æ ·æœ¬ä¸è¶³ï¼Œå›é€€åˆ°å†å²æ³•
        return self.historical_var(returns, confidence)

    # 3. ä¼°è®¡GPDå‚æ•° (çŸ©ä¼°è®¡)
    xi, beta = self._estimate_gpd_params(exceedances)

    # 4. è®¡ç®—VaR
    n = len(returns)
    nu = len(exceedances)
    p = 1 - confidence

    if xi != 0:
        var = threshold + (beta / xi) * (((n / nu) * p) ** (-xi) - 1)
    else:
        var = threshold - beta * math.log((n / nu) * p)

    return VaRResult(
        var=abs(var),
        confidence=confidence,
        method="EVT-GPD",
        expected_shortfall=self._evt_es(var, xi, beta),
        sample_size=len(returns),
        metadata={"xi": xi, "beta": beta, "threshold": threshold},
    )
```

---

## Â§23 å‹åŠ›æµ‹è¯•åœºæ™¯

### 23.1 ä¸­å›½æœŸè´§å¸‚åœºå†å²æç«¯åœºæ™¯

| åœºæ™¯ | æ—¥æœŸ | å“ç§ | æ³¢åŠ¨ | æŒç»­æ—¶é—´ |
|------|------|------|------|----------|
| 2015å¹´è‚¡ç¾ | 2015-06 | IF | -10%/æ—¥ | 5å¤© |
| 2016å¹´é»‘è‰²ç³»æš´æ¶¨ | 2016-04 | RB | +6%/æ—¥ | 3å¤© |
| 2020å¹´åŸæ²¹è´Ÿä»· | 2020-04 | SC | -15% | 1å¤© |
| 2021å¹´åŠ¨åŠ›ç…¤è°ƒæ§ | 2021-10 | ZC | -10%/æ—¥ | 3å¤© |
| 2022å¹´ç¢³é…¸é”‚æš´è·Œ | 2022-11 | LC | -15%/æ—¥ | 5å¤© |
| 2024å¹´ç¢³é…¸é”‚ç»§ç»­ä¸‹è·Œ | 2024-03 | LC | -8%/æ—¥ | 10å¤© |
|------|------|------|------|----------|

### 23.2 å‹åŠ›æµ‹è¯•é…ç½®

```python
@dataclass
class StressScenario:
    """å‹åŠ›æµ‹è¯•åœºæ™¯"""

    name: str                 # åœºæ™¯åç§°
    description: str          # åœºæ™¯æè¿°
    price_shock: float        # ä»·æ ¼å†²å‡»å¹…åº¦
    duration_days: int        # æŒç»­å¤©æ•°
    affected_products: list   # å—å½±å“å“ç§
    probability: float        # å†å²æ¦‚ç‡


STRESS_SCENARIOS = [
    StressScenario(
        name="CRASH_2015",
        description="2015å¹´è‚¡ç¾åœºæ™¯",
        price_shock=-0.10,
        duration_days=5,
        affected_products=["IF", "IH", "IC"],
        probability=0.01,
    ),
    StressScenario(
        name="BLACK_IRON_RISE_2016",
        description="2016å¹´é»‘è‰²ç³»æš´æ¶¨åœºæ™¯",
        price_shock=0.06,
        duration_days=3,
        affected_products=["RB", "HC", "I"],
        probability=0.02,
    ),
    StressScenario(
        name="OIL_NEGATIVE_2020",
        description="2020å¹´åŸæ²¹è´Ÿä»·åœºæ™¯",
        price_shock=-0.15,
        duration_days=1,
        affected_products=["SC", "FU", "LU"],
        probability=0.001,
    ),
    # ... æ›´å¤šåœºæ™¯
]
```

---

## Â§24 å®éªŒæ€§ç­–ç•¥é—¨ç¦

### 24.1 æˆç†Ÿåº¦è¯„ä¼°ç³»ç»Ÿ

```
å®éªŒæ€§ç­–ç•¥è®­ç»ƒæˆç†Ÿåº¦è¯„ä¼°ç³»ç»Ÿ

æ ¸å¿ƒé—¨æ§›:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 1. æ€»æˆç†Ÿåº¦ â‰¥ 80%                                                    â”‚
â”‚ 2. ä»»æ„ç»´åº¦ â‰¥ 60%                                                    â”‚
â”‚ 3. è®­ç»ƒæ—¶é—´ â‰¥ 90å¤©                                                   â”‚
â”‚ 4. äººå·¥å®¡æ‰¹é€šè¿‡                                                      â”‚
â”‚ 5. BYPASS_FORBIDDEN = True (ç¦æ­¢ç»•è¿‡)                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 24.2 äº”ç»´åº¦è¯„ä¼°

| ç»´åº¦ | æƒé‡ | è¯„ä¼°æŒ‡æ ‡ |
|------|------|----------|
| æ”¶ç›Šç¨³å®šæ€§ | 25% | å¤æ™®æ¯”ç‡ã€æ”¶ç›ŠCVã€æœˆåº¦èƒœç‡ |
| é£é™©æ§åˆ¶ | 25% | æœ€å¤§å›æ’¤ã€å¡ç›æ¯”ç‡ã€èƒœç‡ã€ç›ˆäºæ¯” |
| å¸‚åœºé€‚åº”æ€§ | 20% | çŠ¶æ€è¦†ç›–ã€ä¸€è‡´æ€§ã€å­˜æ´»ç‡ |
| è®­ç»ƒå……åˆ†åº¦ | 20% | è®­ç»ƒå¤©æ•°ã€è®­ç»ƒæ¬¡æ•°ã€æ ·æœ¬å¤šæ ·æ€§ |
| ä¸€è‡´æ€§ | 10% | ä¿¡å·ç›¸å…³ã€æ»šåŠ¨ä¸€è‡´æ€§ |
|------|------|----------|

### 24.3 æˆç†Ÿåº¦ç­‰çº§

```python
class MaturityLevel(Enum):
    """æˆç†Ÿåº¦ç­‰çº§"""

    EMBRYONIC = "èƒšèƒæœŸ"    # 0-20%
    DEVELOPING = "å‘è‚²æœŸ"   # 20-40%
    GROWING = "æˆé•¿æœŸ"      # 40-60%
    MATURING = "æˆç†ŸæœŸ"     # 60-80%
    MATURE = "å®Œå…¨æˆç†Ÿ"     # 80-100%

def assess_maturity(scores: dict) -> float:
    """è®¡ç®—æ€»ä½“æˆç†Ÿåº¦å¾—åˆ†"""

    weights = {
        "æ”¶ç›Šç¨³å®šæ€§": 0.25,
        "é£é™©æ§åˆ¶": 0.25,
        "å¸‚åœºé€‚åº”æ€§": 0.20,
        "è®­ç»ƒå……åˆ†åº¦": 0.20,
        "ä¸€è‡´æ€§": 0.10,
    }

    total_score = sum(scores[dim] * weights[dim] for dim in weights)
    return total_score   
```

---

## Â§25 å®¡è®¡æ—¥å¿—è§„èŒƒ

### 25.1 æ—¥å¿—æ–‡ä»¶å‘½å

```
å‘½åæ ¼å¼: audit_{run_id}_{date}.jsonl
è¯´æ˜:
- run_id: å¹´æœˆæ—¥+å››ä½åºå· (å¦‚202512160001)
- date: å¹´æœˆæ—¥ (å¦‚20251216)

ç¤ºä¾‹:
audit_202512160001_20251216.jsonl
```

### 25.2 æ—¥å¿—ä¿ç•™ç­–ç•¥

| ç±»å‹ | ä¿ç•™æ—¶é—´ | å‹ç¼© |
|------|----------|------|
| åŸå§‹æ—¥å¿— | 30å¤© | æ—  |
| å‹ç¼©æ—¥å¿— | 365å¤© | GZIP |
| å½’æ¡£æ—¥å¿— | æ°¸ä¹… | Parquet |
| metaæ•°æ® | æ°¸ä¹… | æ—  |
|------|----------|------|

### 25.3 å¿…è®°å½•äº‹ä»¶

| äº‹ä»¶ç±»å‹ | è§¦å‘æ—¶æœº | å¿…å¡«å­—æ®µ |
|----------|----------|----------|
| `SIGNAL_GENERATED` | ä¿¡å·ç”Ÿæˆ | symbol, direction, signal_source |
| `ORDER_SUBMITTED` | è®¢å•æäº¤ | symbol, price, volume, order_id |
| `ORDER_FILLED` | è®¢å•æˆäº¤ | order_id, fill_price, fill_volume |
| `ORDER_REJECTED` | è®¢å•æ‹’ç» | order_id, reason |
| `RISK_TRIGGERED` | é£æ§è§¦å‘ | rule_id, threshold, actual |
| `POSITION_CHANGED` | æŒä»“å˜åŒ– | symbol, direction, volume |
| `MARGIN_WARNING` | ä¿è¯é‡‘é¢„è­¦ | usage_ratio, level |
| `LIMIT_PRICE_HIT` | æ¶¨è·Œåœè§¦å‘ | symbol, limit_type |
| `STRATEGY_FALLBACK` | ç­–ç•¥é™çº§ | from_strategy, to_strategy |
| `SYSTEM_ALERT` | ç³»ç»Ÿå‘Šè­¦ | alert_type, severity |
|----------|----------|----------|

---

## Â§26 é…ç½®ç®¡ç†ï¼ˆåæœŸè‡ªè¡Œè¡¥å……ï¼‰

### 26.1 é…ç½®æ–‡ä»¶ç»“æ„

```yaml
# config/trading.yml

environment: production  # dev | test | production

exchange:
  shfe:
    enabled: true
    trading_hours: [[09:00, 10:15], [10:30, 11:30], [13:30, 15:00]]
    night_session: [21:00, 02:30]
    dce:
    enabled: true
    trading_hours: [[09:00, 10:15], [10:30,11:30], [13:30, 15:00]]
    night_session: [21:00, 01:00]
  czce:
    enabled: true
    trading_hours: [[09:00, 10:15], [10:30,11:30], [13:30, 15:00]]
    night_session: [21:00, 01:00]
  cffex:
      enabled: true
      trading_hours: [[09:00, 10:15], [10:30,11:30], [13:30, 15:00]]
      night_session: [21:00, 01:00]
   gfex:
      enabled: true
      trading_hours: [[09:00, 10:15], [10:30,11:30], [13:30, 15:00]]
      night_session: [21:00, 02:30]
    ine:
      enabled: true
      trading_hours: [[09:00, 10:15], [10:30,11:30], [13:30, 15:00]]
      night_session: [21:00, 02:30]
risk:
  max_drawdown_pct: 0.05
  max_position_value: 10000000
  margin_warning_level: 0.7
  margin_danger_level: 0.85
    throttle_levels:
        normal:
        5s_limit: 30
        daily_limit: 15000
        warning:
        5s_limit: 40
        daily_limit: 18000
        danger:
        5s_limit: 45
        daily_limit: 19000
        critical:
        5s_limit: 48
        daily_limit: 19500
        exceeded:
        5s_limit: 50
        daily_limit: 20000
        
strategy:
  calendar_arb:
    enabled: true
    max_position: 100
    entry_z: 2.5
    exit_z: 0.5
    stop_z: 5.0

compliance:
  report_cancel_limit_5s: 50
  high_freq_limit_daily: 20000
  large_order_threshold: 100


logging:  
  level: INFO
  audit_log_path: ./logs/audit/
```

### 26.2 ç¯å¢ƒéš”ç¦»ï¼ˆåæœŸè‡ªè¡Œè¡¥å……ï¼‰

| ç¯å¢ƒ | é…ç½®æ–‡ä»¶ | CTPå‰ç½® | æ•°æ®åº“ |
|------|----------|---------|--------|
| dev | config.dev.yml | simnow | dev_db |
| test | config.test.yml | simnow | test_db |
| prod | config.prod.yml | ç”Ÿäº§å‰ç½® | prod_db |
|------|----------|---------|--------|

---

## Â§27 FMEAæ•…éšœæ¨¡å¼åˆ†æ

### 27.1 æ•…éšœæ¨¡å¼è¡¨ï¼ˆåæœŸè‡ªè¡Œè¡¥å……ï¼‰

| æ•…éšœæ¨¡å¼ | ä¸¥é‡åº¦ | å‘ç”Ÿæ¦‚ç‡ | æ£€æµ‹éš¾åº¦ | RPN | ç¼“è§£æªæ–½ |
|----------|--------|----------|----------|-----|----------|
| CTPæ–­è¿ | 9 | 3 | 2 | 54 | è‡ªåŠ¨é‡è¿ + é™çº§ |
| è¡Œæƒ…å»¶è¿Ÿ | 7 | 4 | 3 | 84 | è¶…æ—¶æ£€æµ‹ + é™çº§ |
| ç­–ç•¥å¼‚å¸¸ | 8 | 3 | 4 | 96 | é™çº§é“¾ + ç†”æ–­ |
| è®¢å•æ‹’ç» | 6 | 5 | 2 | 60 | é‡è¯• + å‘Šè­¦ |
| ä¿è¯é‡‘ä¸è¶³ | 9 | 2 | 2 | 36 | å®æ—¶ç›‘æ§ + é¢„è­¦ |
| æ¶¨è·Œåœå°æ¿ | 7 | 6 | 1 | 42 | ä»·æ ¼æ£€æŸ¥ + æ’¤å• |
| é«˜é¢‘æŠ¥æ’¤å• | 8 | 4 | 3 | 96 | èŠ‚æµå™¨ + å‘Šè­¦ |
| ç³»ç»Ÿèµ„æºè€—å°½ | 9 | 2 | 4 | 72 |
| ç›‘æ§ + æ‰©å®¹ |
| æ•°æ®åº“è¿æ¥å¤±è´¥ | 8 | 3 | 3 | 72 | é‡è¯• + å¤‡ç”¨è¿æ¥ |
| æ—¥å¿—å†™å…¥å¤±è´¥ | 6 | 4 | 4 | 96 |
| æœ¬åœ°ç¼“å­˜ + å‘Šè­¦ | 




|----------|--------|----------|----------|-----|----------|

### 27.2 RPNè®¡ç®—ï¼ˆåæœŸè‡ªè¡Œè¡¥å……ï¼‰

```
RPN = ä¸¥é‡åº¦ Ã— å‘ç”Ÿæ¦‚ç‡ Ã— æ£€æµ‹éš¾åº¦

RPNç­‰çº§:
- < 50: ä½é£é™©ï¼Œç›‘æ§å³å¯
- 50-100: ä¸­é£é™©ï¼Œéœ€è¦ç¼“è§£æªæ–½
- > 100: é«˜é£é™©ï¼Œå¿…é¡»ä¼˜å…ˆå¤„ç†ï¼ˆå¦‚ç­–ç•¥å¼‚å¸¸ã€é«˜é¢‘æŠ¥æ’¤å•ã€æ—¥å¿—å†™å…¥å¤±è´¥ï¼‰
```

---

## Â§28 å›æ»šç­–ç•¥

### 28.1 å›æ»šè§¦å‘æ¡ä»¶ï¼ˆåæœŸè‡ªè¡Œè¡¥å……ï¼‰

| è§¦å‘æ¡ä»¶ | å›æ»šèŒƒå›´ | è‡ªåŠ¨/æ‰‹åŠ¨ |
|----------|----------|-----------|
| CIé—¨ç¦å¤±è´¥ | å•æ¬¡æäº¤ | è‡ªåŠ¨ |
| æµ‹è¯•è¦†ç›–ä¸‹é™ | å•æ¬¡æäº¤ | è‡ªåŠ¨ |
| ç”Ÿäº§å¼‚å¸¸ | ç‰ˆæœ¬å›æ»š | æ‰‹åŠ¨ |
| èµ„é‡‘å¼‚å¸¸ | ç³»ç»Ÿæš‚åœ | æ‰‹åŠ¨ |
| ç­–ç•¥å¼‚å¸¸ | ç­–ç•¥é™çº§ | è‡ªåŠ¨ |
| é£æ§è§¦å‘ | ç³»ç»Ÿç†”æ–­ | è‡ªåŠ¨ |
| 

|----------|----------|-----------|

### 28.2 å›æ»šæµç¨‹ï¼ˆåæœŸè‡ªè¡Œè¡¥å……ï¼‰

```
1. æ£€æµ‹åˆ°å¼‚å¸¸
2. è§¦å‘ç†”æ–­ (å¦‚éœ€)
3. è®°å½•å½“å‰çŠ¶æ€
4. æ‰§è¡Œå›æ»š
5. éªŒè¯å›æ»šæˆåŠŸ
6. æ¢å¤æœåŠ¡
7. å‘é€å‘Šè­¦
8. äº‹ååˆ†æ
9. ä¼˜åŒ–æµç¨‹
10. æ›´æ–°æ–‡æ¡£
11. AIè¾…åŠ©è¯Šæ–­
12. æŒç»­æ”¹è¿›
13. å®šæœŸæ¼”ç»ƒ
14. å¤šç¯å¢ƒæµ‹è¯•
15. å›æ»šå®¡æ‰¹
16. ç‰ˆæœ¬æ§åˆ¶
17. ç°åº¦å‘å¸ƒ
18. å›æ»šæ—¥å¿—
19. å›æ»šé€šçŸ¥
20. å›æ»šç›‘æ§
21. å›æ»šæŠ¥å‘Š
22. å›æ»šåŸ¹è®­
23. å›æ»šæ¼”ç»ƒ
24. å›æ»šå·¥å…·
25. å›æ»šç­–ç•¥è¯„å®¡
26. å›æ»šé£é™©è¯„ä¼°
27. å›æ»šæœ€ä½³å®è·µ
28. å›æ»šè‡ªåŠ¨åŒ–
29. å›æ»šæ–‡æ¡£åŒ–

30. å›æ»šæŒç»­æ”¹è¿›
```

---

## Â§29 æµ‹è¯•è§„èŒƒï¼ˆåæœŸè‡ªè¡Œè¡¥å……ï¼‰

### 29.1 æµ‹è¯•ç›®å½•ç»“æ„

```
tests/
â”œâ”€â”€ unit/                  # å•å…ƒæµ‹è¯•
â”‚   â”œâ”€â”€ test_trading.py

|   â”œâ”€â”€ test_risk.py
â”‚   â””â”€â”€ ...
â”œâ”€â”€ integration/           # é›†æˆæµ‹è¯•
â”‚   â”œâ”€â”€ test_market_data.py
|   â”œâ”€â”€ test_order_execution.py

â”‚   â””â”€â”€ ...
```

### 29.2 æµ‹è¯•è¦†ç›–è¦æ±‚

| æ¨¡å— | æœ€ä½è¦†ç›–ç‡ | å½“å‰è¦†ç›–ç‡ |
|------|------------|------------|
| src/trading/ | 100% | 100% |
| src/risk/ | 100% | 95% |
| src/strategy/ | 90% | 88% |
| src/market/ | 90% | 92% |
| src/execution/ | 90% | 87% |
| src/compliance/ | 85% | 86% |
| src/audit/ | 90% | 89% |
| src/cost/ | 90% | 90% |
| src/guardian/ | 90% | 84% |
| src/replay/ | 90% | 87% |
| src/portfolio/ | 85% | 88% |
| src/monitoring/ | 85% | 86% |
| src/experimental/ | 80% | 82% |
| src/advanced_risk/ | 80% | 81% |
| src/fee_calculator/ | 85% | 88% |

| æ€»ä½“ | 90% | 88.22% |

### 29.3 åœºæ™¯æµ‹è¯•å‘½å

```python
# æµ‹è¯•å‡½æ•°å‘½åè§„èŒƒ
def test_{module}_{feature}_{scenario}():
    """
    RULE_ID: {MODULE}.{FEATURE}.{SCENARIO}
    å†›è§„: M{X}
    æè¿°: ...
    å‰ç½®æ¡ä»¶: ...
    æ“ä½œæ­¥éª¤: ...

    é¢„æœŸç»“æœ: ...
    """
    pass
```

---

## Â§30 CI/CDé›†æˆï¼ˆåæœŸè‡ªè¡Œè¡¥å……ï¼‰

### 30.1 GitHub Actionså·¥ä½œæµï¼ˆåæœŸè‡ªè¡Œè¡¥å……ï¼‰

```yaml
# .github/workflows/ci.yml

name: CI Pipeline

on:
  push:
    branches: [main, feat/*]
  pull_request:
    branches: [main]





jobs:
  lint:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - name: Ruff Check
        run: ruff check .
      - name: Ruff Format
        run: ruff format --check .

  type-check:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - name: Mypy
        run: mypy .

  test:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - name: Pytest
        run: pytest tests/ -q --cov=src --cov-fail-under=85

  policy-check:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - name: Validate Policy
        run: python scripts/validate_policy.py --all
```

### 30.2 é—¨ç¦æ£€æŸ¥é¡ºåºï¼ˆåæœŸè‡ªè¡Œè¡¥å……ï¼‰

```
1. Ruff Check (ä»£ç é£æ ¼)
2. Ruff Format (ä»£ç æ ¼å¼)
3. Mypy (ç±»å‹æ£€æŸ¥)
4. Pytest (å•å…ƒæµ‹è¯•)
5. Coverage (è¦†ç›–ç‡)
6. Policy (ç­–ç•¥éªŒè¯)
```

### 30.3 æœ¬åœ°æ‰§è¡Œå‘½ä»¤ï¼ˆåæœŸè‡ªè¡Œè¡¥å……ï¼‰

```powershell
# Windows PowerShell
.venv/Scripts/python.exe -m ruff check .
.venv/Scripts/python.exe -m ruff format --check .
.venv/Scripts/python.exe -m mypy .
.venv/Scripts/python.exe -m pytest tests/ -q
.venv/Scripts/python.exe scripts/validate_policy.py --all
```

---

## Â§31 åœºæ™¯çŸ©é˜µæ€»è¡¨ï¼ˆåæœŸè‡ªè¡Œè¡¥å……ï¼‰

### 31.1 åœºæ™¯ç»Ÿè®¡

| Phase | åœºæ™¯æ•° | çŠ¶æ€ |
|-------|--------|------|
| Phase 0 åŸºç¡€è®¾æ–½ | 15 | âœ… |
| Phase 1 è¡Œæƒ…å±‚ | 12 | âœ… |
| Phase 2 å®¡è®¡å±‚ | 18 | âœ… |
| Phase 3 ç­–ç•¥é™çº§ | 12 | âœ… |
| Phase 4 å›æ”¾éªŒè¯ | 2 | âœ… |
| Phase 5 æˆæœ¬å±‚ | 8 | âœ… |
| Phase 6 Bç±»æ¨¡å‹ (DL) | 27 | â¸ |
| Phase 6 Bç±»æ¨¡å‹ (RL) | 25 | â¸ |
| Phase 6 Bç±»æ¨¡å‹ (CV) | 10 | â¸ |
| Phase 7 ä¸­å›½æœŸè´§ç‰¹åŒ– | 23 | â¸ |
| Phase 8 æ™ºèƒ½ç­–ç•¥ | 22 | éƒ¨åˆ†âœ… |
| Phase 9 åˆè§„ç›‘æ§ | 16 | éƒ¨åˆ†âœ… |
| Phase 10 ç»„åˆé£æ§ | 25 | éƒ¨åˆ†âœ… |
| **æ€»è®¡** | **215** | - |

### 31.1.1 Phase 6 åœºæ™¯æ˜ç»†ï¼ˆåæœŸè‡ªè¡Œè¡¥å……ï¼‰

| ç±»åˆ« | åœºæ™¯èŒƒå›´ | åœºæ™¯æ•° | å†›è§„è¦†ç›– |
|------|----------|--------|----------|
| DL æ·±åº¦å­¦ä¹  | K01-K27 | 27 | M3,M7,M11,M18,M19 |
| RL å¼ºåŒ–å­¦ä¹  | K28-K52 | 25 | M3,M6,M7,M18,M19 |
| CV äº¤å‰éªŒè¯ | K53-K62 | 10 | M3,M7,M19 |
| **å°è®¡** | - | **62** | - |

### 31.2 å†›è§„è¦†ç›–ç»Ÿè®¡ï¼ˆåæœŸè‡ªè¡Œè¡¥å……ï¼‰

| å†›è§„ | åœºæ™¯æ•° | è¦†ç›–ç‡ |
|------|--------|--------|
| M1 å•ä¸€ä¿¡å·æº | 8 | 100% |
| M3 å®Œæ•´å®¡è®¡ | 18 | 100% |
| M4 é™çº§å…œåº• | 6 | 100% |
| M5 æˆæœ¬å…ˆè¡Œ | 14 | âœ… 100% |
| M6 ç†”æ–­ä¿æŠ¤ | 22 | 90% |
| M7 å›æ”¾ä¸€è‡´ | 6 | 100% |
| M9 é”™è¯¯ä¸ŠæŠ¥ | 12 | 85% |
| M13 æ¶¨è·Œåœæ„ŸçŸ¥ | 6 | å¾…å®ç° |
| M14 å¹³ä»Šå¹³æ˜¨åˆ†ç¦» | 3 | âœ… 100% |
| M15 å¤œç›˜è·¨æ—¥å¤„ç† | 5 | å¾…å®ç° |
| M16 ä¿è¯é‡‘ç›‘æ§ | 5 | å¾…å®ç° |
| M17 ç¨‹åºåŒ–åˆè§„ | 8 | å¾…å®ç° |
| M18 å®éªŒæ€§é—¨ç¦ | 7 | âœ… |

---

## Â§32 æ–‡ä»¶æ¸…å•

### 32.1 å·²å®Œæˆæ–‡ä»¶ (71ä¸ª)ï¼ˆåæœŸè‡ªè¡Œè¡¥å……ï¼‰

| ç›®å½• | æ–‡ä»¶æ•° | è¡Œæ•°ä¼°è®¡ |
|------|--------|----------|

### 32.2 å¾…æ–°å¢æ–‡ä»¶ - ï¼ˆåæœŸè‡ªè¡Œè¡¥å……ï¼‰

#### 32.2.1 æ·±åº¦å­¦ä¹ æ¨¡å— (DL) ï¼ˆåæœŸè‡ªè¡Œè¡¥å……ï¼‰

| æ–‡ä»¶è·¯å¾„ | åŠŸèƒ½ | é¢„è®¡è¡Œæ•° |
|----------|------|----------|
| `src/strategy/dl/__init__.py` | æ¨¡å—å¯¼å‡º | ~50 |
| `src/strategy/dl/models/__init__.py` | æ¨¡å‹å¯¼å‡º | ~30 |
| `src/strategy/dl/models/base.py` | DLæ¨¡å‹åŸºç±» | ~200 |
| `src/strategy/dl/models/lstm.py` | LSTMæ¨¡å‹ | ~350 |
| `src/strategy/dl/models/transformer.py` | Transformeræ¨¡å‹ | ~450 |
| `src/strategy/dl/models/cnn.py` | CNNæ¨¡å‹ | ~300 |
| `src/strategy/dl/data/__init__.py` | æ•°æ®å¯¼å‡º | ~20 |
| `src/strategy/dl/data/sequence_handler.py` | åºåˆ—å¤„ç† | ~200 |
| `src/strategy/dl/data/dataset.py` | æ•°æ®é›†å®šä¹‰ | ~250 |
| `src/strategy/dl/data/dataloader.py` | æ•°æ®åŠ è½½å™¨ | ~150 |
| `src/strategy/dl/factor/__init__.py` | å› å­å¯¼å‡º | ~20 |
| `src/strategy/dl/factor/factor_miner.py` | å› å­æŒ–æ˜ | ~400 |
| `src/strategy/dl/factor/ic_calculator.py` | ICè®¡ç®— | ~200 |
| `src/strategy/dl/factor/feature_selector.py` | ç‰¹å¾é€‰æ‹© | ~250 |
| `src/strategy/dl/predictor/__init__.py` | é¢„æµ‹å™¨å¯¼å‡º | ~20 |
| `src/strategy/dl/predictor/lstm_predictor.py` | LSTMé¢„æµ‹å™¨ | ~300 |
| `src/strategy/dl/predictor/transformer_predictor.py` | Transformeré¢„æµ‹å™¨ | ~350 |
| `src/strategy/dl/predictor/cnn_predictor.py` | CNNé¢„æµ‹å™¨ | ~280 |
| `src/strategy/dl/loss/loss_functions.py` | æŸå¤±å‡½æ•° | ~200 |
| `src/strategy/dl/metrics/metrics.py` | è¯„ä¼°æŒ‡æ ‡ | ~250 |
| `src/strategy/dl/trainer/trainer.py` | è®­ç»ƒå™¨ | ~400 |



#### 32.2.2 å¼ºåŒ–å­¦ä¹ æ¨¡å— (RL) ï¼ˆåæœŸè‡ªè¡Œè¡¥å……ï¼‰

| æ–‡ä»¶è·¯å¾„ | åŠŸèƒ½ | é¢„è®¡è¡Œæ•° |
|----------|------|----------|
| `src/strategy/rl/__init__.py` | æ¨¡å—å¯¼å‡º | ~60 |
| `src/strategy/rl/config.py` | RLé…ç½® | ~100 |
| `src/strategy/rl/base.py` | RLåŸºç±» | ~250 |
| `src/strategy/rl/environment.py` | äº¤æ˜“ç¯å¢ƒ | ~400 |
| `src/strategy/rl/memory.py` | ç»éªŒå›æ”¾ | ~200 |
| `src/strategy/rl/actor_critic.py` | ACç½‘ç»œ | ~300 |
| `src/strategy/rl/ppo_model.py` | PPOæ¨¡å‹ | ~350 |
| `src/strategy/rl/dqn_model.py` | DQNæ¨¡å‹ | ~300 |
| `src/strategy/rl/dueling_dqn.py` | Dueling DQN | ~250 |
| `src/strategy/rl/target_network.py` | ç›®æ ‡ç½‘ç»œ | ~150 |
| `src/strategy/rl/exploration.py` | æ¢ç´¢ç­–ç•¥ | ~200 |
| `src/strategy/rl/reward_function.py` | å¥–åŠ±å‡½æ•° | ~300 |
| `src/strategy/rl/ppo_agent.py` | PPOä»£ç† | ~450 |
| `src/strategy/rl/actor_critic_agent.py` | ACä»£ç† | ~400 |
| `src/strategy/rl/dqn_agent.py` | DQNä»£ç† | ~400 |



#### 32.2.3 äº¤å‰éªŒè¯æ¨¡å— (CV)ï¼ˆåæœŸè‡ªè¡Œè¡¥å……ï¼‰

| æ–‡ä»¶è·¯å¾„ | åŠŸèƒ½ | é¢„è®¡è¡Œæ•° |
|----------|------|----------|
| `src/strategy/cv/__init__.py` | æ¨¡å—å¯¼å‡º | ~40 |
| `src/strategy/cv/cv_config.py` | CVé…ç½® | ~100 |
| `src/strategy/cv/cv_splitter.py` | æ—¶åºåˆ’åˆ†å™¨ | ~250 |
| `src/strategy/cv/cv_runner.py` | CVè¿è¡Œå™¨ | ~300 |
| `src/strategy/cv/cv_evaluator.py` | CVè¯„ä¼°å™¨ | ~250 |
| `src/strategy/cv/cv_reporter.py` | CVæŠ¥å‘Šå™¨ | ~200 |
| `src/strategy/cv/cv_plotter.py` | CVå¯è§†åŒ– | ~180 |
| `src/strategy/cv/cv_logger.py` | CVæ—¥å¿— | ~120 |
| `src/strategy/cv/cv_data_handler.py` | CVæ•°æ®å¤„ç† | ~200 |
| `src/strategy/cv/cv_utils.py` | CVå·¥å…· | ~100 |


#### 32.2.4 å·¥å…·æ¨¡å— ï¼ˆåæœŸè‡ªè¡Œè¡¥å……ï¼‰

| æ–‡ä»¶è·¯å¾„ | åŠŸèƒ½ | é¢„è®¡è¡Œæ•° |
|----------|------|----------|
| `src/strategy/utils/__init__.py` | å·¥å…·å¯¼å‡º | ~30 |
| `src/strategy/utils/logger.py` | ç»Ÿä¸€æ—¥å¿— | ~150 |
| `src/strategy/utils/visualizer.py` | å¯è§†åŒ– | ~250 |
| `src/strategy/utils/experiment_tracker.py` | å®éªŒè·Ÿè¸ª | ~200 |
| `src/strategy/utils/utils.py` | é€šç”¨å·¥å…· | ~150 |
| `src/strategy/common/__init__.py` | å…¬å…±å¯¼å‡º | ~20 |
| `src/strategy/common/config.py` | é…ç½®è§£æ | ~150 |
| `src/strategy/common/logging.py` | æ—¥å¿—è®°å½• | ~100 |
| `src/strategy/common/utils.py` | å…¬å…±å·¥å…· | ~100 |



### 32.3 å¾…æ–°å¢æ–‡ä»¶ ï¼ˆåæœŸè‡ªè¡Œè¡¥å……ï¼‰

| æ–‡ä»¶è·¯å¾„ | åŠŸèƒ½ | é¢„è®¡è¡Œæ•° |
|----------|------|----------|
| `src/market/trading_calendar.py` | å¤œç›˜äº¤æ˜“æ—¥å† | ~250 |
| `src/execution/protection/limit_price.py` | æ¶¨è·Œåœä¿æŠ¤ | ~200 |
| `src/execution/protection/margin_monitor.py` | ä¿è¯é‡‘ç›‘æ§ | ~250 |
| `src/execution/algo/twap.py` | TWAPç®—æ³• | ~200 |
| `src/execution/algo/vwap.py` | VWAPç®—æ³• | ~250 |
| `src/execution/algo/iceberg.py` | å†°å±±å•ç®—æ³• | ~200 |
| `src/execution/algo/adaptive.py` | è‡ªé€‚åº”æ‰§è¡Œ | ~300 |
| `src/execution/impact_model.py` | å¸‚åœºå†²å‡»æ¨¡å‹ | ~200 |
| `src/guardian/triggers_china.py` | ä¸­å›½æœŸè´§è§¦å‘å™¨ | ~300 |
| `src/risk/var_enhanced.py` | å¢å¼ºVaR | ~400 |
| `src/risk/stress_test_china.py` | ä¸­å›½æœŸè´§å‹åŠ›æµ‹è¯• | ~350 |
| `src/risk/attribution.py` | é£é™©å½’å›  | ~300 |
| `src/strategy/calendar_arb/delivery_aware.py` | äº¤å‰²æ„ŸçŸ¥å¥—åˆ© | ~250 |
| `src/compliance/china_futures_rules.py` | åˆè§„è§„åˆ™ | ~200 |
| `src/compliance/programmatic_trading.py` | ç¨‹åºåŒ–äº¤æ˜“åˆè§„ | ~300 |
| `src/compliance/throttle.py` | åˆè§„èŠ‚æµå™¨ | ~250 |
| `src/compliance/algo_registration.py` | ç®—æ³•å¤‡æ¡ˆ | ~200 |
| æµ‹è¯•æ–‡ä»¶ (Phase 6) | DL/RL/CVæµ‹è¯• | ~5000 |
| æµ‹è¯•æ–‡ä»¶ (å…¶ä»–Phase) | å…¶ä»–æµ‹è¯• | ~3000 |

### 32.4 æ–‡ä»¶ç»Ÿè®¡æ€»è¡¨ï¼ˆåæœŸè‡ªè¡Œè¡¥å……ï¼‰

| ç±»åˆ« | æ–‡ä»¶æ•° | è¡Œæ•° |
|------|--------|------|
| å·²å®Œæˆæºç  | 


---

## Â§33 å·¥æ—¶ä¼°ç®—

### 33.1 Phaseå·¥æ—¶ï¼ˆåæœŸè‡ªè¡Œè¡¥å……ï¼‰

| Phase | é¢„è®¡å·¥æ—¶ | è¯´æ˜ |
|-------|----------|------|
| Phase 5 æˆæœ¬å±‚ | 16h | ä¸­å›½æœŸè´§æ‰‹ç»­è´¹ |
| Phase 6 Bç±»æ¨¡å‹ | 80h | DL+RLæ¨¡å‹ |
| Phase 7 ä¸­å›½æœŸè´§ç‰¹åŒ– | 90h | å…¨é¢ç‰¹åŒ– |
| Phase 8 æ™ºèƒ½ç­–ç•¥ | 40h | æ‰§è¡Œç®—æ³• |
| Phase 9 åˆè§„ç›‘æ§ | 30h | åˆè§„æ¨¡å— |
| Phase 10 ç»„åˆé£æ§ | 40h | VaRå¢å¼º |

### 33.2 æŒ‰æ¨¡å—å·¥æ—¶ï¼ˆåæœŸè‡ªè¡Œè¡¥å……ï¼‰

| æ¨¡å— | æ–°æ–‡ä»¶ | æµ‹è¯• | æ–‡æ¡£ | åˆè®¡ |
|------|--------|------|------|------|
| äº¤æ˜“æ‰€é…ç½® | 8h | 4h | 2h | 14h |
| æ‰‹ç»­è´¹è®¡ç®— | 8h | 4h | 2h | 14h |
| æ¶¨è·Œåœä¿æŠ¤ | 6h | 3h | 1h | 10h |
| ä¿è¯é‡‘ç›‘æ§ | 8h | 4h | 2h | 14h |
| æ‰§è¡Œç®—æ³• | 20h | 10h | 4h | 34h |
| åˆè§„èŠ‚æµ | 8h | 4h | 2h | 14h |
| VaRå¢å¼º | 16h | 8h | 4h | 28h |
| å‹åŠ›æµ‹è¯• | 12h | 6h | 2h | 20h |
| DLæ¨¡å‹ | 40h | 20h | 8h | 68h |
| RLæ¨¡å‹ | 40h | 20h | 8h | 68h |

---

## Â§34 éªŒæ”¶æ ‡å‡†

### 34.1 åŠŸèƒ½éªŒæ”¶ï¼ˆåæœŸè‡ªè¡Œè¡¥å……ï¼‰

- [ ] æ‰€æœ‰åœºæ™¯æµ‹è¯•é€šè¿‡ï¼Œå¹¶è¾¾åˆ°95%çš„æµ‹è¯•è¦†ç›–ç‡ã€‚
- [ ] å†›è§„M1-M33å…¨éƒ¨æœ‰æµ‹è¯•è¦†ç›–
- [ ] å…­å¤§äº¤æ˜“æ‰€é…ç½®æ­£ç¡®
- [ ] å¤œç›˜äº¤æ˜“æ—¥å†æ­£ç¡®
- [ ] æ¶¨è·Œåœä»·æ ¼æ£€æŸ¥ç”Ÿæ•ˆ
- [ ] ä¿è¯é‡‘ç›‘æ§é¢„è­¦æ­£å¸¸
- [ ] ç¨‹åºåŒ–åˆè§„æ£€æŸ¥é€šè¿‡
- [ ] VaRè®¡ç®—ç»“æœå‡†ç¡®
- [ ] æ‰§è¡Œç®—æ³•æŒ‰é¢„æœŸå·¥ä½œ
- [ ] DLæ¨¡å‹è®­ç»ƒå®Œæˆ
- [ ] RLæ¨¡å‹è®­ç»ƒå®Œæˆ
- [ ] æ‰€æœ‰æ–°æ–‡ä»¶æœ‰å®Œæ•´æ–‡æ¡£
- [ ] æ‰€æœ‰æ–°æ–‡ä»¶æœ‰å•å…ƒæµ‹è¯•
- [ ] æ‰€æœ‰æ–°åŠŸèƒ½é€šè¿‡é›†æˆæµ‹è¯•
- [ ] æ‰€æœ‰æ–°åŠŸèƒ½é€šè¿‡å‹åŠ›æµ‹è¯•
- [ ] æ‰€æœ‰æ–°åŠŸèƒ½é€šè¿‡å®‰å…¨æ‰«æ
- [ ] æ‰€æœ‰æ–°åŠŸèƒ½é€šè¿‡è¿ç»´æ”¯æŒ
- [ ] ç­–ç•¥é™çº§é“¾å®Œæ•´
- [ ] å®¡è®¡æ—¥å¿—å®Œæ•´
- [ ] å½’å› åˆ†ææ­£ç¡®
- [ ] é£é™©æ§åˆ¶ç”Ÿæ•ˆ
- [ ] å¤§é¢æ™ºèƒ½æ‹†å•å¤„ç†æ­£ç¡®
- [ ] é«˜é¢‘æŠ¥æ’¤å•èŠ‚æµç”Ÿæ•ˆ
- [ ] æ—¥å†å¥—åˆ©ç­–ç•¥æ­£ç¡®
- [ ] 

### 34.2 æ€§èƒ½éªŒæ”¶

| æŒ‡æ ‡ | è¦æ±‚ | æµ‹è¯•æ–¹æ³• |
|------|------|----------|
| è®¢å•å»¶è¿Ÿ | < 10ms | å‹æµ‹ |
| ä¿¡å·ç”Ÿæˆ | < 1ms | å‹æµ‹ |
| VaRè®¡ç®— | < 100ms | å•æµ‹ |
| è¡Œæƒ…å¤„ç† | 10000 tick/s | å‹æµ‹ |
| å¹¶å‘è®¢å• | 1000 orders/s | å‹æµ‹ |
| ç³»ç»Ÿç¨³å®šæ€§ | 99.9% uptime | ç›‘æ§ |
| èµ„æºä½¿ç”¨ | < 70% CPU/RAM | ç›‘æ§ |
| æ‰©å±•æ€§ | æ”¯æŒæ–°å“ç§ | é›†æˆæµ‹è¯• |
| å…¼å®¹æ€§ | æ”¯æŒå¤šå¹³å° | é›†æˆæµ‹è¯• |
| å®‰å…¨æ€§ | æ— æ¼æ´ | å®‰å…¨æ‰«æ |
| å“åº”æ—¶é—´ | < 200ms | å‹æµ‹ |
| ååé‡ | é«˜å¹¶å‘å¤„ç† | å‹æµ‹ |
| å¯ç»´æŠ¤æ€§ | æ˜“äºå‡çº§ | ä»£ç è¯„å®¡ |
| å¯ç›‘æ§æ€§ | å®æ—¶æŒ‡æ ‡ | ç›‘æ§ |
| å¯æŠ¥è­¦æ€§ | å¼‚å¸¸å‘Šè­¦ | ç›‘æ§ |
| å¯è¿½æº¯æ€§ | æ“ä½œæ—¥å¿— | å®¡è®¡ |
| å¯å¤ç°æ€§ | ç»“æœä¸€è‡´ | å›æ”¾æµ‹è¯• |
| å¯è§£é‡Šæ€§ | å†³ç­–é€æ˜ | ä»£ç è¯„å®¡ |
| å¯é…ç½®æ€§ | çµæ´»å‚æ•° | é›†æˆæµ‹è¯• |
| å¯é‡ç”¨æ€§ | æ¨¡å—åŒ–è®¾è®¡ | ä»£ç è¯„å®¡ |
| å¯æ‰©å±•æ€§ | æ”¯æŒæ’ä»¶ | é›†æˆæµ‹è¯• |
| å¹´åŒ–æ”¶ç›Šç‡ | â‰¥ 35% | å›æµ‹ |
| æœ€å¤§å›æ’¤ | â‰¤ 10% | å›æµ‹ |
| å¤æ™®æ¯”ç‡ | â‰¥ 2.0 | å›æµ‹ |
| ç›ˆäºæ¯” | â‰¥ 1.5 | å›æµ‹ |
| èƒœç‡ | â‰¥ 70% | å›æµ‹ |
| ç­–ç•¥ç¨³å®šæ€§ | æ³¢åŠ¨ç‡ â‰¤ 3% | å›æµ‹ |
| å›æµ‹é€šè¿‡ç‡ | 100% | å›æµ‹ |
| æ€§èƒ½æŒ‡æ ‡ | å…¨éƒ¨è¾¾æ ‡ | å‹æµ‹ |
| å®‰å…¨æ‰«æ | æ— é«˜å±æ¼æ´ | å®‰å…¨æ‰«æ |

### 34.3 è´¨é‡éªŒæ”¶

| æŒ‡æ ‡ | è¦æ±‚ |
|------|------|
| æµ‹è¯•è¦†ç›–ç‡ | â‰¥ 95% |
| Ruffæ£€æŸ¥ | 0 errors |
| Mypyæ£€æŸ¥ | 0 errors |
| æ–‡æ¡£å®Œæ•´æ€§ | 100% |
| ç½®ä¿¡åº¦ | â‰¥ 95% |
| è¿ç»´æ”¯æŒ | 24x7å°æ—¶å“åº” |
| è®°å½•å®Œæ•´æ€§ | å®¡è®¡æ—¥å¿—æ— é—æ¼ |
| å‘Šè­¦å‡†ç¡®æ€§ | â‰¤ 1%è¯¯æŠ¥ |
| å›æ»šæˆåŠŸç‡ | 100% |
| çŸ©é˜µå®Œæ•´æ€§ | 100% |
| å†›è§„è¦†ç›–ç‡ | 100% |
| å¹´åŒ–æ”¶ç›Šç‡ | â‰¥ 35% |
| æœ€å¤§å›æ’¤ | â‰¤ 10% |
| å¤æ™®æ¯”ç‡ | â‰¥ 2.0 |
| ç›ˆäºæ¯” | â‰¥ 1.5 |
| èƒœç‡ | â‰¥ 70% |
| ç­–ç•¥ç¨³å®šæ€§ | æ³¢åŠ¨ç‡ â‰¤ 3% |
| å›æµ‹é€šè¿‡ç‡ | 100% |
| æ€§èƒ½æŒ‡æ ‡ | å…¨éƒ¨è¾¾æ ‡ |
| å®‰å…¨æ‰«æ | æ— é«˜å±æ¼æ´ |
| ä»£ç å¤æ‚åº¦ | Cyclomatic â‰¤ 5 |
| é‡å¤ä»£ç ç‡ | â‰¤ 3% |
| ä»£ç è´¨é‡ | 0 critical issues |
| å¥—åˆ©æ•ˆæœ | æ­£æ”¶ç›Š |
| VaRå‡†ç¡®æ€§ | â‰¤ 5%è¯¯å·® |
| å¾®è§‚ç»“æ„é«˜é¢‘å¥—åˆ© | æ”¶ç›Šç¨³å®š |
| ä¸­è§‚ç»“æ„é«˜é¢‘å¥—åˆ© | æ”¶ç›Šç¨³å®š |
| ç³»ç»Ÿç¨³å®šæ€§ | æ— å´©æºƒ |
| æ•…éšœæ¢å¤æ—¶é—´ | â‰¤ 1åˆ†é’Ÿ |
| ç”¨æˆ·ä½“éªŒ | æ˜“ç”¨å‹å¥½ |
| æŠ€æœ¯å€ºåŠ¡ | æ— é—ç•™é—®é¢˜ |
| æ”¿ç­–çº¢åˆ©è‡ªåŠ¨æ•æ‰‹ | å¿«é€Ÿå“åº”æ”¿ç­– |
| æç«¯è¡Œæƒ…ææ…Œæ”¶å‰² | æœ‰æ•ˆæ•æ‰æœºä¼š |
| å¤œç›˜è·³ç©ºé—ªç”µæˆ˜ | å¿«é€Ÿååº” |
| è‡ªåŠ¨åŒ–å®Œæ•´æ€§ | é™¤å¿…è¦æƒ…å†µï¼Œå…¨æµç¨‹è‡ªåŠ¨åŒ– |
| ç³»ç»Ÿå¼¹æ€§ | æ— å•ç‚¹æ•…éšœ |
| å®‰å…¨æ€§ | æ— æ¼æ´ |
| å¯æ‰©å±•æ€§ | æ”¯æŒæ–°å“ç§æ¥å…¥ |
| å¯ç»´æŠ¤æ€§ | æ˜“äºå‡çº§å’Œç»´æŠ¤ |
| å¯ç§»æ¤æ€§ | æ”¯æŒå¤šå¹³å°éƒ¨ç½² |
| å¯è¿½æº¯æ€§ | æ“ä½œå¯è¿½è¸ª |
| å¯å¤ç°æ€§ | ç»“æœå¯å¤ç° |
| å¯è§£é‡Šæ€§ | å†³ç­–å¯è§£é‡Š |
| å¯è®¿é—®æ€§ | ç”¨æˆ·å‹å¥½ç•Œé¢ |
| å¯å…¼å®¹æ€§ | å…¼å®¹ç°æœ‰ç³»ç»Ÿ |
| å¯é‡ç”¨æ€§ | | æ¨¡å—åŒ–è®¾è®¡ |
| å¯é…ç½®æ€§ | çµæ´»é…ç½®å‚æ•° |
| å¯ç›‘æ§æ€§ | å®æ—¶ç›‘æ§æŒ‡æ ‡ |
| å¯æŠ¥è­¦æ€§ | å¼‚å¸¸åŠæ—¶å‘Šè­¦ |
| æ¨¡å‹å‡†ç¡®æ€§ | é«˜é¢„æµ‹å‡†ç¡®ç‡ |
| æ¨¡å‹ç¨³å®šæ€§ | ç¨³å®šè¾“å‡º |
| æ¨¡å‹é²æ£’æ€§ | æŠ—å™ªèƒ½åŠ›å¼º |
| ç³»ç»Ÿååé‡ | é«˜å¹¶å‘å¤„ç† |
| ç³»ç»Ÿå“åº”æ—¶é—´ | å¿«é€Ÿå“åº” |
| ä¼˜åŒ–æ•ˆæœ | æŒç»­ä¼˜åŒ– |
| é¢„æµ‹èƒ½åŠ› | å‡†ç¡®ç‡â‰¥ 90% |
| é£é™©æ§åˆ¶èƒ½åŠ› | é£é™©é™ä½å°äºé¢„æœŸç™¾åˆ†ä¹‹äº” |
| å…¨éƒ¨åŠŸèƒ½å®Œæˆ | 100% |
| å…¨éƒ¨å†›è§„è¦†ç›– | 100% |
| å…¨éƒ¨åœºæ™¯æµ‹è¯•é€šè¿‡ | 100% |
| å…¨éƒ¨æ€§èƒ½æŒ‡æ ‡è¾¾æ ‡ | 100% |
| å…¨éƒ¨è´¨é‡æŒ‡æ ‡è¾¾æ ‡ | 100% |
| å…¨éƒ¨éªŒæ”¶æ ‡å‡†è¾¾æˆ | 100% |
| å…¨éƒ¨ç­–ç•¥æœ‰æ•ˆ | 100% |
| å…¨éƒ¨åŠŸèƒ½å¯ç”¨ | 100% |


---

## Â§35 é™„å½•

### 35.1 æœ¯è¯­è¡¨

| æœ¯è¯­ | è‹±æ–‡ | è§£é‡Š |
|------|------|------|
| æ¶¨åœæ¿ | Limit Up | ä»·æ ¼ä¸Šæ¶¨åˆ°æœ€é«˜é™åˆ¶ |
| è·Œåœæ¿ | Limit Down | ä»·æ ¼ä¸‹è·Œåˆ°æœ€ä½é™åˆ¶ |
| å¹³ä»Šä»“ | Close Today | å½“æ—¥å¼€ä»“å½“æ—¥å¹³ä»“ |
| å¹³æ˜¨ä»“ | Close Yesterday | å¹³æ‰å‰ä¸€æ—¥æŒä»“ |
| å¤œç›˜ | Night Session | 21:00åçš„äº¤æ˜“æ—¶æ®µ |
| ä¿è¯é‡‘ | Margin | å¼€ä»“æ‰€éœ€èµ„é‡‘æ¯”ä¾‹ |
| å¼ºå¹³ | Forced Liquidation | ä¿è¯é‡‘ä¸è¶³æ—¶å¼ºåˆ¶å¹³ä»“ |
| VaR | Value at Risk | åœ¨é™©ä»·å€¼ |
| ES/CVaR | Expected Shortfall | æœŸæœ›æŸå¤±/æ¡ä»¶VaR |
| EVT | Extreme Value Theory | æå€¼ç†è®º |
| GPD | Generalized Pareto Distribution | å¹¿ä¹‰å¸•ç´¯æ‰˜åˆ†å¸ƒ |
| MCMC | Markov Chain Monte Carlo | é©¬å°”å¯å¤«é“¾è’™ç‰¹å¡æ´› |
| DL | Deep Learning | æ·±åº¦å­¦ä¹  |
| RL | Reinforcement Learning | å¼ºåŒ–å­¦ä¹  |
| CV | Cross Validation | äº¤å‰éªŒè¯
| CTP | China Trading Platform | ä¸­å›½æœŸè´§äº¤æ˜“å¹³å°API |
| API | Application Programming Interface | åº”ç”¨ç¨‹åºç¼–ç¨‹æ¥å£ |
| RPN | Risk Priority Number | é£é™©ä¼˜å…ˆçº§æ•° |
| FMEA | Failure Mode and Effects Analysis | æ•…éšœæ¨¡å¼åŠå½±å“åˆ†æ |
| CI/CD | Continuous Integration/Continuous Deployment | æŒç»­é›†æˆ/æŒç»­éƒ¨ç½² |
| Ruff | Ruff | Pythonä»£ç é™æ€åˆ†æå·¥å…· |
| Mypy | Mypy | Pythoné™æ€ç±»å‹æ£€æŸ¥å·¥å…· |
| PPO | Proximal Policy Optimization | è¿‘ç«¯ç­–ç•¥ä¼˜åŒ– |
| DQN | Deep Q-Network | æ·±åº¦Qç½‘ç»œ |
| AC | Actor-Critic | è¡ŒåŠ¨è€…-è¯„è®ºå®¶ |
| TWAP | Time-Weighted Average Price | æ—¶é—´åŠ æƒå¹³å‡ä»·æ ¼ |
| VWAP | Volume-Weighted Average Price | æˆäº¤é‡åŠ æƒå¹³å‡ä»·æ ¼ |
| ICEBERG | Iceberg Order | å†°å±±å• |
| SimNow | SimNow | æ¨¡æ‹Ÿäº¤æ˜“å¹³å° |
| CNY | Chinese Yuan | äººæ°‘å¸ |
| USD | US Dollar | ç¾å…ƒ |
| EUR | Euro | æ¬§å…ƒ |
|------|------|------|

### 35.2 å‚è€ƒèµ„æ–™ï¼ˆåæœŸè‡ªè¡Œè¡¥å……ï¼‰

1. ã€ŠæœŸè´§å¸‚åœºç¨‹åºåŒ–äº¤æ˜“ç®¡ç†è§„å®šï¼ˆè¯•è¡Œï¼‰ã€‹- ä¸­å›½è¯ç›‘ä¼š (2025)
2. ã€Šç¨‹åºåŒ–äº¤æ˜“ç®¡ç†å®æ–½ç»†åˆ™ã€‹- æ²ªæ·±åŒ—äº¤æ˜“æ‰€ (2025)
3. å„äº¤æ˜“æ‰€äº¤æ˜“è§„åˆ™åŠé£æ§åˆ¶åº¦
4. CTP APIæŠ€æœ¯æ–‡æ¡£
5. é£é™©ç®¡ç†ç†è®ºä¸å®è·µ
6. ã€ŠPythonç¼–ç¨‹ï¼šä»å…¥é—¨åˆ°å®è·µã€‹- Eric Matthes
7. ã€Šæ·±åº¦å­¦ä¹ ã€‹- Ian Goodfellow, Yoshua Bengio, Aaron
8. ã€Šå¼ºåŒ–å­¦ä¹ ï¼šåŸç†ä¸å®è·µã€‹- Richard S. Sutton, Andrew G. Barto
9. GitHub Actionså®˜æ–¹æ–‡æ¡£
10. Ruffå®˜æ–¹æ–‡æ¡£
11. Mypyå®˜æ–¹æ–‡æ¡£
12. ã€Šè½¯ä»¶æµ‹è¯•çš„è‰ºæœ¯ã€‹- Glenford J. Myers
13. ã€ŠæŒç»­é›†æˆï¼šè½¯ä»¶è´¨é‡æ”¹è¿›å’Œé£é™©é™ä½ä¹‹é“ã€‹- Paul
14. ã€Šé«˜æ€§èƒ½Pythonç¼–ç¨‹ã€‹- Micha Gorelick, Ian Ozsvald
15. ã€Šè®¾è®¡æ•°æ®å¯†é›†å‹åº”ç”¨ã€‹- Martin Kleppmann
16. ã€Šå¾®æœåŠ¡è®¾è®¡ã€‹- Sam Newman
17. ã€Šç³»ç»Ÿæ¶æ„ï¼šå¤æ‚ç³»ç»Ÿçš„è®¾è®¡ä¸æ¼”è¿›ã€‹- Neal Ford,
18. ã€Šä»£ç å¤§å…¨ã€‹- Steve McConnell
19. ã€Šé‡æ„ï¼šæ”¹å–„æ—¢æœ‰ä»£ç çš„è®¾è®¡ã€‹- Martin Fowler
20. ã€ŠClean Codeã€‹- Robert C. Martin
21. ã€ŠThe Pragmatic Programmerã€‹- Andrew Hunt, David Thomas

### 35.3 æ–‡æ¡£ç‰ˆæœ¬å†å²ï¼ˆåæœŸè‡ªè¡Œè¡¥å……ï¼‰

| ç‰ˆæœ¬ | æ—¥æœŸ | ä½œè€… | å˜æ›´è¯´æ˜ |
|------|------|------|----------|
| v1.0 | 2025-12-14 | CLAUDEä¸Šæ ¡ | åˆå§‹ç‰ˆæœ¬ |
| v2.0 | 2025-12-15 | CLAUDEä¸Šæ ¡ | æ·»åŠ Phase 3-4 |
| v3.0 | 2025-12-16 | CLAUDEä¸Šæ ¡ | æ·»åŠ ä¸­å›½æœŸè´§ç‰¹åŒ– |
| v4.0 | 2025-12-16 | CLAUDEä¸Šæ ¡ | å†›è§„çº§æœ€é«˜æŒ‡ç¤ºæ–‡ä»¶ |
| v4.1 | 2025-12-17 | CLAUDEä¸Šæ ¡ | Phase 5æˆæœ¬å±‚éªŒæ”¶å®Œæˆï¼Œæ›´æ–°çŠ¶æ€ |
| **v4.2** | **2025-12-17** | **CLAUDEä¸Šæ ¡** | **Phase 6 Bç±»æ¨¡å‹å®Œæ•´è§„åˆ’ï¼šDL(21æ–‡ä»¶/27åœºæ™¯)ã€RL(15æ–‡ä»¶/25åœºæ™¯)ã€CV(10æ–‡ä»¶/10åœºæ™¯)ï¼Œæ€»è®¡55æ–‡ä»¶ã€62åœºæ™¯ã€~12150è¡Œä»£ç ** |

---

**æ–‡æ¡£ç»“æŸ**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                                     â”‚
â”‚                    V4PRO å†›è§„çº§ä¸­å›½æœŸè´§äº¤æ˜“ç³»ç»Ÿ                      â”‚
â”‚                                                                     â”‚
â”‚                                             â”‚
â”‚                                                                     â”‚
â”‚                                                               â”‚
â”‚                                                                     â”‚
â”‚                                               â”‚
â”‚                                                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```
