@echo off
chcp 65001 >nul 2>&1
echo ==================== Claude启动器 ====================
echo.

:: 正确的Claude路径
set CLAUDE_PATH=%USERPROFILE%\.trae-cn\extensions\anthropic.claude-code-2.0.61-win32-x64\resources\native-binary\claude.exe

:: 检查文件是否存在
if exist "%CLAUDE_PATH%" (
    echo [OK] 找到Claude: %CLAUDE_PATH%
    echo.
    echo 使用方法：
    echo 1. 在VS Code/TREA中：选中代码 ^+ 按Ctrl+I
    echo 2. 命令行模式：启动Claude.bat "你的问题"
    echo 3. 交互模式：启动Claude.bat (不加参数)
    echo.

    :: 如果有参数，直接运行
    if not "%~1"=="" (
        echo [Claude] 正在处理: %*
        echo.
        "%CLAUDE_PATH%" -p "%*"
    ) else (
        :: 没有参数，启动交互模式
        echo [Claude] 启动交互模式...
        echo.
        "%CLAUDE_PATH%"
    )
) else (
    echo [错误] 找不到Claude！
    echo.
    echo 请检查：
    echo 1. Claude Code扩展是否已安装
    echo 2. VS Code/TREA是否正确安装
    echo.
    echo 当前查找路径：
    echo %CLAUDE_PATH%
    echo.
    echo 已安装的扩展：
    code --list-extensions
)

echo.
pause