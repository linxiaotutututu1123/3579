@echo off
chcp 65001 >nul 2>&1
cls
echo ============================================
echo        TREA Claude 交互式助手
echo ============================================
echo.
echo 我会一步步指导你在TREA中使用Claude
echo.
pause

echo.
echo [步骤1] 确认TREA已打开
echo ---------------
echo.
echo 请检查：
echo 1. 是否看到了VS Code/TREA编辑器窗口？
echo 2. 窗口标题是否显示"TREA"或"Visual Studio Code"？
echo.
set /p trea_open=输入 Y 如果已打开，N 如果未打开:

if /i "%trea_open%"=="N" (
    echo.
    echo 正在打开TREA...
    start code .
    echo.
    echo 等待TREA完全加载...
    timeout /t 5
    echo.
    set /p ready=输入 Y 当TREA已完全加载:
)

echo.
echo [步骤2] 打开钻石评估文件
echo --------------------
echo.
echo 在TREA中：
echo 1. 按 Ctrl+O 打开文件
echo 2. 导航到：Desktop\火山方舟大模型体验中心-火山引擎_files\
echo 3. 选择：QL钻石光学能量化系统_终极修复版-完美运行版.py
echo.
echo 我现在帮你打开...
start code "C:\Users\1\Desktop\火山方舟大模型体验中心-火山引擎_files\QL钻石光学能量化系统_终极修复版-完美运行版.py"
echo.
pause

echo.
echo [步骤3] 使用Claude分析代码
echo ----------------------
echo.
echo 现在文件应该在TREA中打开了，请按照以下步骤操作：
echo.
echo 1. 滚动到第27行（精度设置代码）
echo 2. 用鼠标选中第27-30行代码
echo 3. 按 Ctrl+I
echo 4. 在弹出框中输入：200位精度是否必要？
echo 5. 按回车发送
echo.
echo 我已经为你准备好了提示问题，请按回车继续...
pause

echo.
echo [步骤4] 尝试其他分析
echo ---------------
echo.
echo 更多示例：
echo.
echo 1. 选中 calculate_optical_performance 函数（大约59-115行）
echo    按 Ctrl+I，输入：如何优化这个函数？
echo.
echo 2. 选中整个文件（Ctrl+A）
echo    按 Ctrl+I，输入：检查代码质量
echo.
echo 3. 选中第388-391行（异常处理）
echo    按 Ctrl+I，输入：这里的异常处理有什么问题？
echo.
echo 如果Ctrl+I不工作，尝试：
echo - Ctrl+Shift+P，输入"Claude"
echo - 或右键选中的代码，找"Ask Claude"选项
echo.
pause

echo.
echo [步骤5] 需要帮助时
echo -------------
echo.
echo 如果遇到问题：
echo 1. 查看我创建的指南：TREA中Claude使用指南.md
echo 2. 或使用命令行版本（已验证可用）
echo.
echo 命令行使用示例：
echo echo "你的问题" | .trae-cn/extensions/anthropic.claude-code-2.0.61-win32-x64/resources/native-binary/claude.exe -p
echo.
echo ============================================
echo.
echo 现在开始尝试吧！如果需要更多帮助，随时问我。
echo.
pause